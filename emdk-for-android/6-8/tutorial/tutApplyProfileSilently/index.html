
<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Online Documentation for Zebra Technologies developer tools and utiltiescomp including EMDK for Android, EMDK for Xamarin, StageNow, Enterprise Browser.">
    <meta name="author" content="Zebra Technologies">
    <meta name="google-site-verification" content="i4B78BrWnNy8ShJwe5feRW3jO3HE6gfYlYqYbxfl8yY">
    <meta name="msvalidate.01" content="6B651B00161BCE79B8950AC09D5C4C75">
    <meta title="Apply Mx Profile Silently in a Non-Blocking way">
    <title>Apply Mx Profile Silently in a Non-Blocking way - Zebra Technologies Techdocs</title>
    <!-- core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    <link href="/css/animate.min.css" rel="stylesheet">
    <link href="/css/owl.carousel.css" rel="stylesheet">
    <link href="/css/owl.transitions.css" rel="stylesheet">
    <link href="/css/prettyPhoto.css" rel="stylesheet">
    <link href="/css/main.css" rel="stylesheet">
    <link href="/css/responsive.css" rel="stylesheet">
    <link href="/css/prettify.css" rel="stylesheet">
    <link href="/css/bootstrap-treenav.min.css" rel="stylesheet">
    <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
    <script src="js/respond.min.js"></script>
    <![endif]--> 

    <script src="//load.sumome.com/" data-sumo-site-id="699cb66cf4dc59352efb45705526d15cbe314e1cd43f7761b94d96f3cf7338e8" async="async"></script>
    <link rel="shortcut icon" href="/favicon.ico">
<script src="/js/jquery.js"></script></head><!--/head-->


<body id="home" class="homepage" data-spy="scroll" data-offset="100" data-target="#toc">

    <header id="header">
        <nav id="main-menu" class="navbar navbar-default navbar-fixed-top" role="banner">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/"><img src="/images/logo.png" alt="logo" style="max-height:66px;float: inherit;
    padding-right: 3px;"></a> 
                    
                   
                </div>
                <div class="collapse navbar-collapse navbar-left">
                    <ul class="nav navbar-nav">
                        <li class="navbar-text pull-left"><strong>TECHDOCS</strong></li>
                        <li class="dropdown">
                          <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown"> EMDK For Android 6.8
                          <span class="caret"></span></button>
                          <ul class="dropdown-menu">
                                <li><a onclick="changeVersion('5-0','4-2','/emdk-for-android/4-2/guide/about')">EMDK For Android 4.2</a></li>
                                <li><a onclick="changeVersion('5-0','4-0','/emdk-for-android/4-0/guide/about')">EMDK For Android 4.0</a></li>
                          </ul>
                        </li>                    
                    </ul>
                </div>
                <div class="collapse navbar-collapse navbar-right">
                    <ul class="nav navbar-nav">
                        


                        <li>
                            <a href="/emdk-for-android/6-8/guide/about">
                                    About
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/6-8/guide/gettingstarted">
                                    Getting Started
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/6-8/tutorial/">
                                    Tutorials
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/6-8/samples">
                                    Samples
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/6-8/guide/programming-guides">
                                    Guides
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/6-8/guide/profile-manager-guides">
                                    Profile Manager
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/6-8/api">
                                    APIs
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/6-8/search">
                                    <i class="fa fa-search"></i>
                            </a>
                        </li>
                        
                        <!-- <li ><a href="/products">SDKs</a></li>
                        <li ><a href="/samples">Samples</a></li>
                        <li ><a href="/guides">Guides</a></li>
                        <li ><a href="/tutorials">Tutorials</a></li>
                        <li ><a href="/apis">APIs</a></li> -->
                        <!-- <li><a href="#"><input type="text" class="st-default-search-input"></a></li> -->
                    </ul>
                </div>
            </div><!--/.container-->
        </nav><!--/nav-->
    </header><!--/header-->
<div class="container-fluid">
    <section id="blog">
        <div class="">
            <section class="content-with-sidebar">
            <div class="row">
                <div class="col-sm-3 hidden-sm hidden-xs" id="sidebar">
                    
                    
                    <nav id="toc" data-toggle="toc" data-spy="affix" style="height: 75%; max-width: 225px; overflow-y: auto; ">
                        
                        <ul class="nav">
                            <li><strong>Apply Mx Profile Silently in a Non-Blocking way</strong></li>
                        </ul>
                    </nav>
                    <div class="modal fade" id="modal-smartdocs" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true" data-backdrop="true">
                    	<div class="modal-dialog">
                    		<div class="modal-content">
                    			<div class="modal-header">
                    				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
                    			</div>
                    			<div class="modal-body">
                    				<form>
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">MX Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="4.0">4.0</option>
                    					  <option value="4.1">4.1</option>
                    					  <option value="4.2">4.2</option>
                    					  <option value="4.3">4.3</option>
                    					  <option value="5.0">5.0</option>
                    					</select>
                    				  </div>						
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">OSX Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="1.0">1.0</option>
                    					  <option value="1.2">1.2</option>
                    					  <option value="1.3.4-56">1.3.4-56</option>
                    					  <option value="3.4">3.4</option>
                    					  <option value="3.5">3.5</option>
                    					  <option value="3.6">3.6</option>
                    					  <option value="4.1">4.1</option>
                    					  <option value="4.2">4.2</option>
                    					  <option value="4.3">4.3</option>
                    					  <option value="4.4">4.4</option>
                    					</select>
                    				  </div>						
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">Android Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="23">6.0 Marshmallow</option>
                    					  <option value="22">5.1 Lollipop</option>
                    					  <option value="21">5.0 Lollipop</option>
                    					  <option value="19">4.4 Kitkat</option>
                    					  <option value="18">4.3 Jellybean</option>
                    					  <option value="17">4.2.x Jellybean</option>
                    					  <option value="16">4.1.x Jellybean</option>
                    					  <option value="15">4.0.3-4.0.4 Ice Cream Sandwich</option>
                    					  <option value="14">4.0-4.0.2 Ice Cream Sandwich</option>
                    					  <option value="10">2.3.3-2.3.4 Gingerbread</option>
                    					</select>
                    				  </div>
                    				  <div class="form-group">
                    				  	<button class="primary" id="btn_SaveSmartDocOptions">Save Changes</button><button class="primary" id="btn_ClearSmartDocOptions">Clear Changes</button>
                    				  </div>
                    				</form>
                    			</div>
                    	</div>
                      </div>
                    </div>
                    
                    <script type="text/javascript">
                        $(document).ready(function() {
                        	$( "#btn_SaveSmartDocOptions" ).click(function() {
                      			console.log('Saving Options');
                      			$("#modal-smartdocs").modal({show: false});
                    		});
                        	$( "#btn_SaveSmartDocOptions" ).click(function() {
                      			console.log('Clearing Options');
                      			$("#modal-smartdocs").modal({show: false});
                    		});
                        });
                    </script><link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.3.0/dist/bootstrap-toc.min.css">
                    <script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.3.0/dist/bootstrap-toc.min.js"></script>
                    <script type="text/javascript">
                        $(document).ready(function() {
                    
                        });
                    
                    
                    </script>
                </div>                
                <div class="col-sm-9 ">
                    <div class="row">
                        <div class="col-sm-12">
                            <section id="cta" class="wow fadeIn">
                                <div class="">
                                    <h1 id="apply-mx-profile-silently-in-a-non-blocking-way" class="anchor"><a class="heading-anchor" href="#apply-mx-profile-silently-in-a-non-blocking-way"><span></span></a>Apply Mx Profile Silently in a Non-Blocking way</h1>
                                    <p>
                                            EMDK For Android
                                            6.8
                                    </p>
                                </div>
                            </section>                    
                        </div>
                    </div>
                    <div id="mainContent" class="row">
                        <div class="col-sm-12">
                            <div class="blog-post blog-large wow fadeInLeft" data-wow-duration="300ms" data-wow-delay="0ms">
                            <!-- Start of guide -->
                                <div class="service-box wow fadeInRight">
                                    <div class="">

                                        <p></p><h2 id="overview" class="anchor"><a class="heading-anchor" href="#overview"><span></span></a>Overview</h2>

<p>This guide will walk you through creating an EMDK For Android application that will use Mx features introduced in EMDK for Android API to perform device configurations. Mx represents a suite of Enterprise Features on top of standard, commercially available Android Open Source Project. In this tutorial we would discuss on how to apply Mx configurations to the device silently without displaying any User Interface in a non blocking way.</p>

<p><strong>Problem:</strong></p>

<p>The Mx features are used to perform device configurations through EMDK profiles as well as programmatically. When we are configuring any Mx feature through EMDK Profile wizard we may not require User Interface. Moreover, the operation of applying EMDK profile configuration to device takes place on the UI main thread. Depending on the Mx feature and complexity, it takes few seconds to apply configurations to the Symbol device. So the application's UI thread is blocked for these few seconds and user cannot interact with application's UI within that time period. Even if the user tries to interact with application's UI, the application does not respond showing "Application Not Responding" (ANR) message asking user to wait.</p>

<p><strong>Reason:</strong></p>

<p>Applying EMDK configurations is a heavy process to be performed on the main thread. The main thread has to manage UI components primarily. Hence if two heavy functionalities happen on a single main thread, it will delay response to the user actions, which may irritate user and hence stop your process, displaying "ANR".</p>

<p><strong>Solution:</strong>
In Android, it is recommended to run only UI components on the main thread. Any other operation should always be run on a different background thread without blocking the UI main thread and completing the operation smoothly without any interruptions such as ANR. </p>

<p>You can run the Mx configuration on background thread in a Non-Blocking way using any one of the following methods: </p>

<p><strong>1. Using Android Handler:</strong></p>

<ul>
<li>A <a href="http://developer.android.com/reference/android/os/Handler.html">Handler</a> allows you to send and process <a href="http://developer.android.com/reference/android/os/Message.html">Message</a> and Runnable objects associated with a thread's <a href="http://developer.android.com/reference/android/os/MessageQueue.html">MessageQueue</a>. Each Handler instance is associated with a single thread and that thread's message queue.</li>

<li>There are two main uses for a Handler: (1) to schedule messages and runnables to be executed as some point in the future; and (2) to enqueue an action to be performed on a different thread than your own.</li>

<li>If you are doing multiple repeated tasks, for example downloading multiple images which are to be displayed in ImageViews (like downloading thumbnails) upon download, use a task queue with Handler.</li>

<li>When a process is created for your application, its main thread is dedicated to running a message queue that takes care of managing the top-level application objects (activities, broadcast receivers, etc) and any windows they create.</li>

<li>You can create your own threads, and communicate back with the main application thread through a Handler.</li>
</ul>

<p><strong>2. Using Android AsyncTask:</strong></p>

<ul>
<li><a href="http://developer.android.com/reference/android/os/AsyncTask.html">AsyncTask</a> enables proper and easy use of the UI thread. This class allows to perform background operations and publish results on the UI thread without having to manipulate threads and/or handlers.</li>

<li>AsyncTask is designed to be a helper class around <a href="http://developer.android.com/reference/java/lang/Thread.html">Thread</a> and <a href="http://developer.android.com/reference/android/os/Handler.html">Handler</a> and does not constitute a generic threading framework.</li>

<li>AsyncTasks should ideally be used for short operations (a few seconds at the most.) If you need to keep threads running for long periods of time, it is highly recommended you use the various APIs provided by the <code>java.util.concurrent</code> pacakge such as <a href="http://developer.android.com/reference/java/util/concurrent/Executor.html">Executor</a>, <a href="http://developer.android.com/reference/java/util/concurrent/ThreadPoolExecutor.html">ThreadPoolExecutor</a> and <a href="http://developer.android.com/reference/java/util/concurrent/FutureTask.html">FutureTask</a>.</li>
</ul>

<p>Since configuration of any Mx feature requires only a few seconds, we can go with any of the two solutions. In this tutorial, we will configure Mx Profile using both Handler and AsyncTask by creating dedicated Activity for each.   </p>

<p>So far we know how to configure Profile in a Non-Blocking way. Sometimes we don't need User Interface while configuring an Mx profile. Hence, We used the word "Silently" to indicate that there won't be any User Interface in this tutorial. Although, we need UI thread to trigger Mx configuration on the background thread. So we will launch the application and quickly close it after triggering Mx configuration on the background thread.</p>

<p>Even if you have User Interface in your application, you can interact with it as UI will not be blocked, because the profile will be applied on a background thread.</p>

<blockquote>
  <p>Note: We are closing the application immediately because we are not notifying user with any UI as well as the configuration is an independent process that we are just triggering from our application and does not require UI. </p>
</blockquote>

<p>So let us create a tutorial and Configure the Mx App Manager Profile to install an application silently in a Non-Blocking way.      </p>

<h3 id="prerequisites" class="anchor"><a class="heading-anchor" href="#prerequisites"><span></span></a>Prerequisites</h3>

<ul>
<li>Download APK file for the application to install from <a href="https://github.com/Zebra/examples-emdk/archive/AllInstalledApps.zip">here</a></li>

<li>Once downloaded, copy the APK file to SD Card of the device. </li>
</ul>

<p>For more information about setting up the EMDK please see the <a href="/emdk-for-android/6-8/guide/setup/">EMDK Setup Guide</a>.</p>

<h2 id="creatingtheproject" class="anchor"><a class="heading-anchor" href="#creatingtheproject"><span></span></a>Creating The Project</h2>

<blockquote>
  <p>Note: Provide "ApplyProfileSilentlyTutorial" as the project name for this tutorial and "HandlerActivity" as the activity name while creating the project.</p>
</blockquote>

<p>Start by creating a new Android Studio <a href="/emdk-for-android/6-8/tutorial/tutCreateProjectAndroidStudio">project</a>.</p>

<h2 id="addingtheappmanagerprofilefeature" class="anchor"><a class="heading-anchor" href="#addingtheappmanagerprofilefeature"><span></span></a>Adding The App Manager Profile Feature</h2>

<ol>
<li><p>Click <a href="/emdk-for-android/6-8/tutorial/tutAddProfileManagerFeature">here</a> to see how to add a specific feature to the Profile Manager.</p></li>

<li><p>Provide "AppManagerProfile" as the Profile Name for this tutorial.</p>

<blockquote>
  <p>Note: You can provide any Profile Name but make sure to access it with the similar name in the Android code.  </p>
</blockquote></li>

<li><p>Now, you can see all these MX features on the left hand side of the Profile Editor window. We want to install the downloaded APK file that is residing in the device's SD Card using App Manager. So select the "App Manager" feature from the list and click "Right Arrow".</p>

<p><img src="../../images/ApplyProfileSilentlyTutorialImages/app_manager_feature.jpg" alt="img"></p>

<p>Provide some Name in the "Name" field to modify this feature programmatically (Ex. MyAppManager).</p>

<blockquote>
  <p>Note: You can also keep the "Name" field empty.</p>
</blockquote>

<p>Since we want to install an application, keep the Action in drop-down as "Install". 
Provide the path and name of the Android application APK file within the device file system (Ex. /storage/sdcard1/AllInstalledApps.apk).  </p>

<p><img src="../../images/ApplyProfileSilentlyTutorialImages/app_manager_details.jpg" alt="img">   </p></li>

<li><p>Click Apply to apply the settings we provided    </p>

<p><img src="../../images/ApplyProfileSilentlyTutorialImages/app_manager_profile_created.jpg" alt="img"></p></li>

<li><p>Click Finish and your App Manager profile for installing an application is created.</p>

<p><img src="../../images/ApplyProfileSilentlyTutorialImages/app_profile_created.jpg" alt="img"> </p></li>

<li><p>Click "Close".</p>

<blockquote>
  <p>Note: <br>
  Now the "EMDKConfig.xml" is created under "\assets" folder. This file will contain a definition of all of your profiles that you create. </p>
</blockquote></li>

<li><p>You can inspect the "EMDKConfig.xml" created under "\assets" folder to see it is reflecting the changes made to the parameters via EMDK Profile Manager GUI earlier.  However, it is advised that this file not be manually updated and only be controlled via the Profile Manager.</p>

<p><img src="../../images/ApplyProfileSilentlyTutorialImages/emdk_config_file_entries.jpg" alt="img">    </p></li>
</ol>

<h2 id="enablingandroidpermissions" class="anchor"><a class="heading-anchor" href="#enablingandroidpermissions"><span></span></a>Enabling Android Permissions</h2>

<ol>
<li><p>Modify the Application's Manifest.xml to use the EMDK library and to set permission for the EMDK.</p>

<p><img src="../../images/ApplyProfileSilentlyTutorialImages/manifest_file.jpg" alt="img"></p>

<p>You must first enable permissions for 'com.symbol.emdk.permission.EMDK':  </p>

<pre class="prettyprint"><code>
&lt;uses-permission android:name="com.symbol.emdk.permission.EMDK"/&gt; 
</code></pre>

<p>Then you must enable the library:  </p>

<pre class="prettyprint"><code>
&lt;uses-library android:name="com.symbol.emdk"/&gt;
</code></pre>

<p>When done, your manifest.xml should look like:</p>

<p><img src="../../images/ApplyProfileSilentlyTutorialImages/manifest_permissions_added.jpg" alt="img"> </p></li>
</ol>

<h2 id="addingsomecode" class="anchor"><a class="heading-anchor" href="#addingsomecode"><span></span></a>Adding Some Code</h2>

<h3 id="usinghandler" class="anchor"><a class="heading-anchor" href="#usinghandler"><span></span></a>Using Handler:</h3>

<ol>
<li><p>Now we will start to add some code in the "HandlerActivity" that we created to apply the App Manager profile to the device on a background thread in a Non-Blocking way using Handler. We will see how to apply this profile silently without UI later in this tutorial.  </p>

<p>First you must add references to the libraries:  </p>

<pre class="prettyprint"><code>
import com.symbol.emdk.*;  
import com.symbol.emdk.EMDKManager.EMDKListener;     
</code></pre>

<p>Then you must extend the activity to implement EMDKListener. </p>

<pre class="prettyprint"><code>
public class MainActivity extends Activity implements EMDKListener {  

<pre><code>.. .. .. .. .. .. ...  

@Override  
public void onClosed() {  
       // TODO Auto-generated method stub  
}  

@Override  
public void onOpened(EMDKManager emdkManager) {  
       // TODO Auto-generated method stub  
}  
</code></pre>

}      
</code></pre>

<p>We will now create some global variables to hold the profile name as well as instance objects of EMDKManager and ProfileManager. These variables would be used throughout the code. </p>

<blockquote>
  <p>Note:
  Verify the Profile name in the code with the one created in the Profile Manager. They both should be identical.    </p>
</blockquote>

<pre class="prettyprint"><code>
// Assign the profile name used in EMDKConfig.xml
private String profileName = "AppManagerProfile";

// Declare a variable to store ProfileManager object
private ProfileManager profileManager = null;

// Declare a variable to store EMDKManager object
private EMDKManager emdkManager = null;
</code></pre>

<p>Since we don't want any UI in this application, remove the line <code>setContentView(R.layout.activity_handler);</code> from the <code>onCreate</code> method. <br>
In the onCreate method, we call getEMDKManager so that the EMDK can be initialized and checked to see if it is ready. </p>

<pre class="prettyprint"><code>
//The EMDKManager object will be created and returned in the callback.  
EMDKResults results = EMDKManager.getEMDKManager(getApplicationContext(), this);  

//Check the return status of getEMDKManager  
if (results.statusCode == EMDKResults.STATUS_CODE.SUCCESS) {

<pre><code>// EMDKManager object creation success
</code></pre>

} else {

<pre><code>// EMDKManager object creation failed
</code></pre>

}
</code></pre>

<p>So far your code should look like:</p>

<p><img src="../../images/ApplyProfileSilentlyTutorialImages/on_create_added.jpg" alt="img"> </p></li>

<li><p>Now we need to use the <code>onOpened</code> method to get a reference to the EMDKManager. The EMDKListener interface will trigger this event when the EMDK is ready to be used. The EMDKListener interface must be implemented in order to get a reference to the EMDKManager APIs. This event will pass the EMDKManager instance and we assign it to the global variable <code>emdkManager</code> that we created in the previous steps. We then use that instance object to get an instance of <code>profileManager</code> and assign it to the global variable <code>profileManager</code>. This is how we will interface with the APIs in the rest of the code:</p>

<blockquote>
  <p>Note: 
  Rename the argument of <code>onOpened</code> method from <code>arg0</code> to <code>emdkManager</code>  </p>
</blockquote>

<pre class="prettyprint"><code>
// This callback will be issued when the EMDK is ready to use.
this.emdkManager = emdkManager;

// Get the ProfileManager object to process the profiles
profileManager = (ProfileManager) emdkManager
        .getInstance(EMDKManager.FEATURE_TYPE.PROFILE);
</code></pre>

<p>Create a Runnable instance in <code>onOpened</code> method, which will perform App Manager's install configuration on background thread. </p>

<pre class="prettyprint"><code>
final Message msg = mHandler.obtainMessage();

// Create Runnable instance to Apply Mx Profile on background thread
Thread background = new Thread(new Runnable() {

<pre><code>@Override
public void run() {
    msg.obj = applyProfile(profileName);
    if (msg.obj != null)
        // Send the result in message from background to UI
        // thread for processing.
        mHandler.sendMessage(msg);

}
</code></pre>

});
// Start the background Thread
background.start(); 
</code></pre>

<p>Ignore the errors for the time being. You can see, the background thread calls <code>applyProfile</code> method that applies the Mx App Manager profile configuration to the device on background thread we created. The parameter <code>msg.obj</code> contains result of the background thread operation that we need to pass on UI thread. Hence we will create a Handler in next step and pass the result parameter in Handler in a Message using <code>msg.obj</code>.</p>

<p>Since we don't want any UI for this application, we will call the <code>finish()</code> method after sending message to Handler. This will immediately close the application as soon as <code>applyProfile</code> method is triggered on the background thread through Runnable.</p>

<pre class="prettyprint"><code>
// Closes the Activity which in turn closes the Application as the
// application has only one Activity.
finish();
</code></pre>

<p>Your complete onOpened method should now look like this:</p>

<p><img src="../../images/ApplyProfileSilentlyTutorialImages/on_opened_method.jpg" alt="img"></p></li>

<li><p>Create a Handler and retrieve the Result parameter from the Message by type casting <code>msg.obj</code> to <code>String</code> in <code>handleMessage</code> method of Handler.</p>

<pre class="prettyprint"><code>
// Handler that receives messages from background thread to populate on UI
// thread.
private Handler mHandler = new Handler() {
  public void handleMessage(Message msg) {
    // Retrieve the result string from message using ((String) msg.obj)
    // and Populate it on UI.
    // Since we don't have UI in this tutorial, we will not use this
    // result string
  };
};
</code></pre>

<p>As you can see the <code>handleMessage</code> contains the Message parameter we passed from background thread. The <code>handleMessage</code> method can retrieve the <code>String</code> result parameter from Message by typecasting <code>msg.obj</code> to <code>String</code> using <code>((String) msg.obj)</code>. Now the user can display this result parameter on the main thread.</p>

<p>The Handler created looks like::</p>

<p><img src="../../images/ApplyProfileSilentlyTutorialImages/handler_created.jpg" alt="img">  </p>

<blockquote>
  <p>Note: We will not be using this result parameter as we don't have UI in this tutorial. But it could be helpful to display result for the applications that have UI.</p>
</blockquote></li>

<li><p>Now that we have a reference to ProfleManager, we use it to install and activate the profile we built earlier. This is done using the <code>processProfile</code> method. We will now create a method that will use <code>processProfile</code> to apply the App Manager profile that we created using EMDK Wizard (Ex. "applyProfile").</p>

<pre class="prettyprint"><code>
private String applyProfile(String profileName) {
try {
    // Call process profile to modify the profile of specified profile
    // name
    EMDKResults results = profileManager.processProfile(profileName,
            ProfileManager.PROFILE_FLAG.SET, (String[]) null);

<pre><code>// Check the return status of processProfile
if (results.statusCode == EMDKResults.STATUS_CODE.CHECK_XML) {

    return "Applying '" + profileName + "' was successful.";

} else {
    return "Applying '" + profileName + "' failed.";
}
</code></pre>

  } catch (Exception ex) {

<pre><code>return ex.getMessage();
</code></pre>

  }
}
</code></pre>

<p>Your <code>applyProfile</code> method should look like:</p>

<p><img src="../../images/ApplyProfileSilentlyTutorialImages/apply_profile.jpg" alt="img"></p></li>

<li><p>Now let's override the "onDestroy" method so we can release the EMDKManager resources:  </p>

<pre class="prettyprint"><code>
@Override
protected void onDestroy() {
 // TODO Auto-generated method stub
 super.onDestroy();

 //Clean up the objects created by EMDK manager
 emdkManager.release();
} 
</code></pre>

<p>Your onDestroy method should now look like this:  </p>

<p><img src="../../images/ApplyProfileSilentlyTutorialImages/on_destroy_method.jpg" alt="img"></p></li>

<li><p>Assign Null to EMDK objects in the "onClosed" method.</p>

<pre class="prettyprint"><code>
@Override
public void onClosed() {
 // TODO Auto-generated method stub

 // Assign null to the objects
 emdkManager = null;
 profileManager = null;
}
</code></pre></li>

<li><p>So far we have done with the coding that will use Runnable and Handler to apply App Manager's install configuration on background thread. It will also close the application immediately using <code>finish()</code> method once background thread starts its execution to apply configurations silently. But the app will still be visible to the user for that small period of time (few milliseconds) before it is closed. We want to avoid UI as it may not require for many Mx configurations. So We will make the UI invisible (basically transparent) for those few milliseconds by applying <a href="http://developer.android.com/guide/topics/ui/themes.html">Android Styles</a> to the <code>HandlerActivity</code>. </p>

<p>Before applying, we need to create a custom style that will make the UI transparent. So go to res -&gt; values -&gt; styles.xml of "ApplyProfileSilentlyTutorial" tutorial and write following Android style in <code>&lt;resources&gt;</code> tag that will make background transparent.</p>

<pre class="prettyprint"><code>
&lt;style name="Transparent" parent="@android:style/Theme"&gt;
  &lt;item name="android:windowBackground"&gt;@android:color/transparent&lt;/item&gt;
  &lt;item name="android:windowIsTranslucent"&gt;true&lt;/item&gt;
  &lt;item name="android:windowIsFloating"&gt;true&lt;/item&gt;
  &lt;item name="android:windowNoTitle"&gt;true&lt;/item&gt;
  &lt;item name="android:windowContentOverlay"&gt;@null&lt;/item&gt;
  &lt;item name="android:backgroundDimEnabled"&gt;false&lt;/item&gt;
&lt;/style&gt;
</code></pre>

<p>So the code for applying styles in res-&gt;values-&gt;styles.xml looks like:</p>

<p><img src="../../images/ApplyProfileSilentlyTutorialImages/styles.jpg" alt="img"></p></li>

<li><p>We will now include this style in HandlerActivity to make it transparent. So go to <code>AndroidManifest.xml</code> and add the following code in the <code>&lt;activity&gt;</code> tag for "HandlerActivity".</p>

<pre class="prettyprint"><code>
android:theme="@style/Transparent"
</code></pre>

<p>This will apply the styles to "HandlerActivity" and make it transparent for those few milliseconds when this Activity is displayed to the user, which will resolve the purpose of calling it Applying Profile <strong>Silently</strong>.</p>

<p>So the Manifest file looks like: looks like:
<img src="../../images/ApplyProfileSilentlyTutorialImages/handler_styles.jpg" alt="img"></p></li>

<li><p>This completes coding and configuration part that will allow us to apply App Manager's install configuration silently in a Non-Blocking way using Handler. If you want, you can run the Application now to test but we are now going to see how the same thing is done using our second option <strong>AsyncTask</strong>.  </p></li>
</ol>

<h3 id="usingasynctask" class="anchor"><a class="heading-anchor" href="#usingasynctask"><span></span></a>Using AsyncTask:</h3>

<ol>
<li><p>We will create another activity (Ex. AsyncTaskActivity) and apply App Manager's install configuration silently in a Non-Blocking way using <a href="http://developer.android.com/reference/android/os/AsyncTask.html">AsyncTask</a>.</p></li>

<li><p>Select the project and add a new Empty with name "AsyncTaskActivity".</p></li>

<li><p>Now we will start to add some code in the "AsyncTaskActivity" that we created to apply App Manager profile to the device on a background thread in a Non-Blocking way using AsyncTask. </p>

<p>Applying the profile silently without UI is same as we did for HandlerActivity.</p>

<blockquote>
  <p>Note: We will use the same earlier transparent styles in "AsyncTaskActivity" to make the Activity transparent, which will resolve the purpose of calling it Applying Profile <strong>Silently</strong>.</p>
</blockquote></li>

<li><p>Follow the step 1 of Adding Some Code using Handlers.</p>

<p>Add two more global variables.</p>

<pre class="prettyprint"><code>
// Contains XML while setting a profile programmatically. It can be Null.
private String[] modifyData;

// Contains the status of processProfile operation.            
private EMDKResults results;
</code></pre>

<p>The code should now look like:</p>

<p><img src="../../images/ApplyProfileSilentlyTutorialImages/async_oncreate_added.jpg" alt="img"></p></li>

<li><p>We will now create an inner class named "ConfigureProfile" in "AsyncTaskActivity" that will extend <code>AsyncTask</code>. <a href="http://developer.android.com/reference/android/os/AsyncTask.html">AsyncTask</a> will run the operation on a background thread without blocking UI thread. It can also return the processing result on UI thread if you want.</p>

<pre class="prettyprint"><code>
// Class extending AsyncTask that runs operations in a background thread
// without blocking UI thread. It returns result on UI thread once the
// operation is completed.
private class ConfigureProfile extends AsyncTask&lt;String, Integer, String&gt; {
  // Operation to be performed on background thread
  @Override
  protected String doInBackground(String... params) {
    modifyData = new String[1];
    // Call processPrfoile with profile name and SET flag to create the
    // profile. The modifyData can be null.
    results = profileManager.processProfile(profileName,
            ProfileManager.PROFILE_FLAG.SET, modifyData);
    return null;
  }

  // Return result to the UI Thread
  @Override
  protected void onPostExecute(String result) {
    // Display Success or Failure Message based on result
    // Check the return status of processProfile
    if (results.statusCode == EMDKResults.STATUS_CODE.CHECK_XML) {

<pre><code>    // Success

} else {

    // Failure
}
</code></pre>

  }

  // Method to implement actions before the AsynTask executes.
  @Override
  protected void onPreExecute() {

  }

  // Method to display updates of operation
  @Override
  protected void onProgressUpdate(Integer... progress) {

  }
}
</code></pre>

<p>The <code>doInBackground</code> method applies the App Manager's install configurations on background thread using <code>processProfile</code> method.</p>

<p>The <code>onPostExecute</code> is used to return the result back to the UI thread when the operation on background thread is done.  </p>

<blockquote>
  <p>Note: We won't return any result on UI thread as we want to apply profile silently in this tutorial.</p>
</blockquote>

<p>The code for AsyncTask should look like:</p>

<p><img src="../../images/ApplyProfileSilentlyTutorialImages/async_task_class.jpg" alt="img"></p></li>

<li><p>Once the EMDK is ready, we will get the <code>ProfileManager</code> object to process the profile in <code>onOpened</code> method.</p>

<blockquote>
  <p>Note: 
  Rename the argument of <code>onOpened</code> method from <code>arg0</code> to <code>emdkManager</code></p>
</blockquote>

<pre class="prettyprint"><code>
this.emdkManager = emdkManager;

// Get the ProfileManager object to process the profiles
profileManager = (ProfileManager) emdkManager
        .getInstance(EMDKManager.FEATURE_TYPE.PROFILE);
</code></pre>

<p>After that we will execute the AsyncTask that by creating instance of it and calling execute method. This will start the process of applying profile on background thread.</p>

<p>Since we don't want any UI for this application, we will call the <code>finish()</code> method immediately to close the application, once the AsyncTask starts executing on background thread. </p>

<pre class="prettyprint"><code>
if (profileManager != null) {
    // Start EMDK process profile operation on the background thread.
    new ConfigureProfile().execute("");
    finish();

}
</code></pre>

<p>So the complete <code>onOpened</code> method looks like:</p>

<p><img src="../../images/ApplyProfileSilentlyTutorialImages/async_on_opened_method.jpg" alt="img"></p></li>

<li><p>We will now write <code>onDestroy</code> and <code>onClosed</code> methods by adding the same code that we added in the Handler Activity.</p>

<p>So <code>onDestroy</code> and <code>onClosed</code> methods look like:</p>

<p><img src="../../images/ApplyProfileSilentlyTutorialImages/on_closed_destroyed_async.jpg" alt="img"></p></li>

<li><p>But the app will still be visible to the user for small period of time (few milliseconds) before it is closed similar to the case of Handler. We want to avoid UI as it may not require for many Mx configurations. So We will make the UI invisible (basically transparent) for those few milliseconds by applying <a href="http://developer.android.com/guide/topics/ui/themes.html">Android Styles</a> to the <code>AsyncTaskActivity</code>.</p>

<p>We have already created a transparent style earlier in this tutorial while applying profile using Handler. We will now  simply include that style in "AsyncTaskActivity" to make it transparent. So go to <code>AndroidManifest.xml</code> and add the following code in the <code>&lt;activity&gt;</code> tag for "AsyncTaskActivity".</p>

<pre class="prettyprint"><code>
android:theme="@style/Transparent"
</code></pre>

<p>This will apply the styles to "AsyncTaskActivity" and make it transparent for those few milliseconds when this Activity is displayed to the user, which will resolve the purpose of calling it Applying Profile <strong>Silently</strong>.</p>

<p>So the Manifest file looks like: looks like:
<img src="../../images/ApplyProfileSilentlyTutorialImages/async_styles.jpg" alt="img"></p></li>

<li><p>This completes coding and configuration part that will allow us to apply App Manager's install configuration silently in a Non-Blocking way using AsyncTask.</p></li>

<li><p>So far, We have created two different activities that perform the same operation of applying App Manager's install configuration silently in a Non-Blocking way, but using two different ways viz. Handler and AsyncTask respectively.</p>

<p>Now, Let us run the application. </p></li>
</ol>

<h2 id="runningtheapplication" class="anchor"><a class="heading-anchor" href="#runningtheapplication"><span></span></a>Running the Application</h2>

<ol>
<li><p>Connect the Symbol device (having the latest EMDK runtime) to USB port. </p>

<blockquote>
  <p>Note: <br>
  Make sure the device is in USB debug.</p>
</blockquote>

<p>Before running the application, change the lable name to application name for "AsyncTaskActivity" in the <code>&lt;activity&gt;</code> tag of AndroidManifest.xml" file by using following code.</p>

<pre class="prettyprint"><code>
android:label="@string/app_name"
</code></pre>

<p>So the Manifest file should now look like:</p>

<p><img src="../../images/ApplyProfileSilentlyTutorialImages/change_lable_name.jpg" alt="img"></p>

<blockquote>
  <p>Note: It is not necessary to change the label name. But if we don't change, it will display the "AsyncTaskActivity" name instead of application name in the device's applications grid, when we run the application using AsyncTask.</p>
</blockquote>

<p>Now when we run the application, it will launch "HandlerActivity" because currently that is the Launcher Activity in "AndroidManifest.xml" file. </p>

<p><img src="../../images/ApplyProfileSilentlyTutorialImages/handler_manifest_launcher.jpg" alt="img"> </p>

<blockquote>
  <p>Note: Make sure that "AllInstalledApps" is not installed on the device before running the app, else the install feature will give error.  </p>
</blockquote></li>

<li><p>Run the application (Uses Handler).</p>

<p>You will not see any User Interface. The application applied the App Manager's install configuration on background thread silently using Handler and installed the "AllInstalledApps" application whose APK we had provided in the wizard.</p>

<p><img src="../../images/ApplyProfileSilentlyTutorialImages/handler_success.png" alt="img"></p></li>

<li><p>Now we will run the application using AsyncTask. We need to set "AsyncTaskActivity" as the Launcher Activity to start the application with "AsyncTaskActivity". So remove the "Intent-Filter" code from "HandlerActivity" and add to the "AsyncTaskActivity" in the "AndroidManifest.xml" file.</p>

<pre class="prettyprint"><code>
&lt;intent-filter&gt;
   &lt;action android:name="android.intent.action.MAIN" /&gt;

   &lt;category android:name="android.intent.category.LAUNCHER" /&gt;
&lt;/intent-filter&gt;
</code></pre>

<p>So the AndroidManifest.xml file now looks like:</p>

<p><img src="../../images/ApplyProfileSilentlyTutorialImages/async_manifest_launcher.jpg" alt="img"></p>

<p>Before running the application using "AsyncTask", uninstall the "AllInstalledApps" application that we installed using Handler just now.</p>

<blockquote>
  <p>Note: Make sure that "AllInstalledApps" is not installed on the device before running the app, else the install feature will give error. </p>
</blockquote></li>

<li><p>Run the application (Uses AsyncTask).</p>

<p>You will not see any User Interface. The application applied the App Manager's install configuration on background thread silently using AsyncTask and installed the "AllInstalledApps" application whose APK we had provided in the wizard.  </p>

<p><img src="../../images/ApplyProfileSilentlyTutorialImages/handler_success.png" alt="img"></p>

<blockquote>
  <p>Note: While running the application using both Handler and AsyncTask, you can interact with the User Interface while profile settings are being applied on background thread. It won't hang the User Interface this time.</p>
</blockquote>

<p>So this is how we can use both Handler and AsyncTask to apply profile settings on background thread in a Non-Blocking way with the help of Android styles to execute it silently without UI.</p></li>
</ol>

<h2 id="importantprogrammingtips" class="anchor"><a class="heading-anchor" href="#importantprogrammingtips"><span></span></a>Important Programming Tips</h2>

<ol>
<li><p>It is required to do the following changes in the application's AndroidManifest.xml:  </p>

<blockquote>
  <p>Note:</p>
  
  <ul>
  <li>Include the permission for EMDK:  </li></ul>
</blockquote>

<pre class="prettyprint"><code>
&lt;uses-permission android:name="com.symbol.emdk.permission.EMDK"/&gt;
</code></pre>

<blockquote>
  <p>Note:</p>
  
  <ul>
  <li>Use the EMDK library:  </li></ul>
</blockquote>

<pre class="prettyprint"><code>
&lt;uses-library android:name="com.symbol.emdk"/&gt;
</code></pre></li>

<li><p>Installing the EMDK for Android application without deploying the EMDK runtime on device will fail because of missing shared library on the device.</p></li>

<li><p>Use the DataWedge v1.7.12 or higher version to test the ProfileManager.processProfile() for DataWedge profiles.</p></li>
</ol><p></p>
                                        


                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div><!--/.col-sm-6-->
            </div>
            </section>
        </div>
    </section>    

<div class="modal fade" id="basicModal" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true" data-backdrop="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
					</div>
					<div class="modal-body">
						<div id="modalImg">
						
						</div>
					</div>
			</div>
		  </div>
		</div> </div>
         <footer id="footer" class="navbar-fixed-bottom">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-sm-10">
                        © 2018 ZIH Corp and/or its affiliates. All rights reserved. Zebra and the stylized Zebra head are trademarks of ZIH Corp., registered in many jurisdictions worldwide. All other trademarks are the property of their respective owners. <a href="https://www.zebra.com/us/en/about-zebra/company-information/compliance/information-privacy/terms-of-use.html">Terms &amp; Conditions</a>
                    </div>
    <!--                 
                    <div class="col-sm-2">
                        <ul class="social-icons">
                            <li><a href="http://www.facebook.com/pages/Zebra-Technologies/107703715989073"><i class="fa fa-facebook"></i></a></li>
                            <li><a href="https://twitter.com/ZebraDevs"><i class="fa fa-twitter"></i></a></li>
                            <li><a href="http://www.youtube.com/zebratechnologies/"><i class="fa fa-youtube"></i></a></li>
                            <li><a href="https://www.linkedin.com/groups?home=&gid=3220074&trk=anet_ug_hm&goback=%2Egmr_3220074"><i class="fa fa-linkedin"></i></a></li>
                            <li><a href="https://github.com/developer-zebra"><i class="fa fa-github"></i></a></li>
                        </ul>
                    </div> -->
                </div>
            </div>
        </footer><!--/#footer-->
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/owl.carousel.min.js"></script>
    <script src="/js/mousescroll.js"></script>
    <script src="/js/smoothscroll.js"></script>
    <script src="/js/jquery.prettyPhoto.js"></script>
    <script src="/js/jquery.isotope.min.js"></script>
    <script src="/js/jquery.inview.min.js"></script>
    <script src="/js/wow.min.js"></script>
    <script src="/js/bootstrap-treenav.min.js"></script>
    <script src="/js/prettify.js"></script>
    <script src="/js/zepto.js"></script>
    <script src="/js/jquery.waterfall.js"></script>   
    <script src="/js/main.js"></script>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','zRzEsAUhWTTkrdEN2YfA','2.0.0');
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-72584442-1', 'auto');
  ga('send', 'pageview');

</script> 

<script>
    ChatraID = 'QDvZ76min4DhLW5vJ';
    (function(d, w, c) {
        var n = d.getElementsByTagName('script')[0],
            s = d.createElement('script');
        w[c] = w[c] || function() {
            (w[c].q = w[c].q || []).push(arguments);
        };
        s.async = true;
        s.src = (d.location.protocol === 'https:' ? 'https:': 'http:')
            + '//call.chatra.io/chatra.js';
        n.parentNode.insertBefore(s, n);
    })(document, window, 'Chatra');
</script>         


</body></html>