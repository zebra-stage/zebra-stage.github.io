
<!DOCTYPE html>
<html lang="en"><head>

    <meta charset="utf-8">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="-1">
    <meta http-equiv="CACHE-CONTROL" content="NO-CACHE">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Online Documentation for Zebra Technologies developer tools and utilties, including EMDK for Android, EMDK for Xamarin, StageNow and Enterprise Browser.">
    <meta name="author" content="Zebra Technologies">
    <meta name="google-site-verification" content="i4B78BrWnNy8ShJwe5feRW3jO3HE6gfYlYqYbxfl8yY">
    <meta name="msvalidate.01" content="6B651B00161BCE79B8950AC09D5C4C75">
    <meta title="Controlling App Access using Access Manager">
    <title>Controlling App Access using Access Manager - TechDocs</title>
    <!-- core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
<!--     
    <link href="/css/font-awesome.min.css" rel="stylesheet">
 -->    
    <link href="/css/all.css" rel="stylesheet">
    <link href="/css/v4-shims.css" rel="stylesheet">
    <link href="/css/animate.min.css" rel="stylesheet">
    <link href="/css/owl.carousel.css" rel="stylesheet">
    <link href="/css/owl.transitions.css" rel="stylesheet">
    <link href="/css/prettyPhoto.css" rel="stylesheet">
    <link href="/css/main.css" rel="stylesheet">
    <link href="/css/responsive.css" rel="stylesheet">
    <link href="/css/prettify.css" rel="stylesheet">
    <link href="/css/bootstrap-treenav.min.css" rel="stylesheet">
    <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
    <script src="js/respond.min.js"></script>
    <![endif]--> 

    <!-- 6/13/24- a "crown" icon randomly appeared in the MX matrix today. Rob said it looked like sumo. 
        <script src="//load.sumome.com/" data-sumo-site-id="699cb66cf4dc59352efb45705526d15cbe314e1cd43f7761b94d96f3cf7338e8" async="async"></script> -->
    <link rel="shortcut icon" href="/favicon.ico">
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-01QJCMQM9N"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-01QJCMQM9N');
</script><script src="/js/jquery.js"></script></head><!--/head-->

<!-- Google tag -->





<body id="home" class="homepage" data-spy="scroll" data-offset="100" data-target="#toc">

    <header id="header">
        <nav id="main-menu" class="navbar navbar-default navbar-fixed-top" role="banner">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/"><img src="/images/logo.png" alt="logo" style="max-height:66px;float: inherit;
    padding-right: 3px;"></a> 
                    
                   
                </div>
                <div class="collapse navbar-collapse navbar-left">
                    <ul class="nav navbar-nav">
                        <li class="navbar-text pull-left"><strong>TechDocs</strong></li>
                        <li class="dropdown">
                          <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown"> EMDK For Android 11.0
                          <span class="caret"></span></button>
                          <ul class="dropdown-menu">
                                <li><a onclick="changeVersion('5-0','4-2','/emdk-for-android/4-2/guide/about')">EMDK For Android 4.2</a></li>
                                <li><a onclick="changeVersion('5-0','4-0','/emdk-for-android/4-0/guide/about')">EMDK For Android 4.0</a></li>
                          </ul>
                        </li>                    
                    </ul>
                </div>
                <div class="collapse navbar-collapse navbar-right">
                    <ul class="nav navbar-nav">
                        


                        <li>
                            <a href="/emdk-for-android/11-0/guide/about">
                                    About
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/11-0/guide/gettingstarted">
                                    Set Up
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/11-0/tutorial/">
                                    Tutorials
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/11-0/samples">
                                    Samples
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/11-0/guide/programming-guides">
                                    Guides
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/11-0/guide/profile-manager-guides">
                                    Profile Manager
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/11-0/faq">
                                    FAQs
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/11-0/apimenu">
                                    APIs
                            </a>
                        </li>
                        <li>
                            <a href="https://developer.zebra.com/forum/search?keys=&amp;field_zebra_curated_tags_tid%5B%5D=184">
                                    <i class="fa fa-comments-o"></i>
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/11-0/search">
                                    <i class="fa fa-search"></i>
                            </a>
                        </li>
                        
                        <!-- <li ><a href="/products">SDKs</a></li>
                        <li ><a href="/samples">Samples</a></li>
                        <li ><a href="/guides">Guides</a></li>
                        <li ><a href="/tutorials">Tutorials</a></li>
                        <li ><a href="/apis">APIs</a></li> -->
                        <!-- <li><a href="#"><input type="text" class="st-default-search-input"></a></li> -->
                    </ul>
                </div>
            </div><!--/.container-->
        </nav><!--/nav-->
    </header><!--/header-->
<div class="container-fluid">
    <section id="blog">
        <div class="">
            <section class="content-with-sidebar">
            <div class="row">
                <div class="col-sm-3 hidden-sm hidden-xs" id="sidebar">
                    
                    
                    <nav id="toc" data-toggle="toc" data-spy="affix" style="height: 75%; max-width: 225px; overflow-y: auto; ">
                        
                        <ul class="nav">
                            <li><strong>Controlling App Access using Access Manager</strong></li>
                        </ul>
                    </nav>
                    <div class="modal fade" id="modal-smartdocs" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true" data-backdrop="true">
                    	<div class="modal-dialog">
                    		<div class="modal-content">
                    			<div class="modal-header">
                    				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
                    			</div>
                    			<div class="modal-body">
                    				<form>
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">MX Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="4.0">4.0</option>
                    					  <option value="4.1">4.1</option>
                    					  <option value="4.2">4.2</option>
                    					  <option value="4.3">4.3</option>
                    					  <option value="5.0">5.0</option>
                    					</select>
                    				  </div>						
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">OSX Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="1.0">1.0</option>
                    					  <option value="1.2">1.2</option>
                    					  <option value="1.3.4-56">1.3.4-56</option>
                    					  <option value="3.4">3.4</option>
                    					  <option value="3.5">3.5</option>
                    					  <option value="3.6">3.6</option>
                    					  <option value="4.1">4.1</option>
                    					  <option value="4.2">4.2</option>
                    					  <option value="4.3">4.3</option>
                    					  <option value="4.4">4.4</option>
                    					</select>
                    				  </div>						
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">Android Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="23">6.0 Marshmallow</option>
                    					  <option value="22">5.1 Lollipop</option>
                    					  <option value="21">5.0 Lollipop</option>
                    					  <option value="19">4.4 Kitkat</option>
                    					  <option value="18">4.3 Jellybean</option>
                    					  <option value="17">4.2.x Jellybean</option>
                    					  <option value="16">4.1.x Jellybean</option>
                    					  <option value="15">4.0.3-4.0.4 Ice Cream Sandwich</option>
                    					  <option value="14">4.0-4.0.2 Ice Cream Sandwich</option>
                    					  <option value="10">2.3.3-2.3.4 Gingerbread</option>
                    					</select>
                    				  </div>
                    				  <div class="form-group">
                    				  	<button class="primary" id="btn_SaveSmartDocOptions">Save Changes</button><button class="primary" id="btn_ClearSmartDocOptions">Clear Changes</button>
                    				  </div>
                    				</form>
                    			</div>
                    	</div>
                      </div>
                    </div>
                    
                    <script type="text/javascript">
                        $(document).ready(function() {
                        	$( "#btn_SaveSmartDocOptions" ).click(function() {
                      			console.log('Saving Options');
                      			$("#modal-smartdocs").modal({show: false});
                    		});
                        	$( "#btn_SaveSmartDocOptions" ).click(function() {
                      			console.log('Clearing Options');
                      			$("#modal-smartdocs").modal({show: false});
                    		});
                        });
                    </script><link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.3.0/dist/bootstrap-toc.min.css">
                    <script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.3.0/dist/bootstrap-toc.min.js"></script>
                    <script type="text/javascript">
                        $(document).ready(function() {
                    
                        });
                    
                    
                    </script>
                </div>                
                <div class="col-sm-9 ">
                    <div class="row">
                        <div class="col-sm-12">
                            <section id="cta" class="wow fadeIn">
                                <div class="">
                                    <h1 id="controlling-app-access-using-access-manager" class="anchor"><a class="heading-anchor" href="#controlling-app-access-using-access-manager"><span></span></a>Controlling App Access using Access Manager</h1>
                                    <p>
                                            EMDK For Android
                                            11.0
                                    </p>
                                </div>
                            </section>                    
                        </div>
                    </div>
                    <div id="mainContent" class="row">
                        <div class="col-sm-12">
                            <div class="blog-post blog-large wow fadeInLeft" data-wow-duration="300ms" data-wow-delay="0ms">
                            <!-- Start of guide -->
                                <div class="service-box wow fadeInRight">
                                    <div class="">

                                        <p></p><h2 id="overview" class="anchor"><a class="heading-anchor" href="#overview"><span></span></a>Overview</h2>

<p>This guide will walk you through creating an EMDK For Android application that will use MX features introduced in EMDK for Android API to perform device configurations. MX represents a suite of Enterprise Features on top of standard, commercially available Android Open Source Project. So this tutorial will focus on controlling access to the device's applications using <a href="../../mx/accessmgr">Access Manager</a> feature of Mx. The <a href="../../mx/accessmgr">Access Manager</a> feature allows you to configure a set of applications that will be allowed to run and install on the device. When a profile with this feature is enabled, the device will only allow user installed applications on the Whitelist to be executed and/or installed (some applications that are part of the default operating system will still be available). To disable the Whitelist, you would select "Single User Without Whitelist". Overall, the Access Manager supports following features.</p>

<blockquote>
  <p>Note: "Enable Whitelist" refers to "Single User Mode with Whitelist". "Disable Whitelist" refers to "Single User Mode without Whitelist" options in the wizard.</p>
</blockquote>

<p><strong>1. Enable/Disable single user mode white list:</strong></p>

<p>This feature allows user to Enable or Disable the single user mode white list. When the single user white list mode is enabled, user can see only those apps that have been added to the white list and have access restrictions. The user can see all the applications when single user mode white list is disabled.   </p>

<p><strong>2. Add packages to the white list:</strong></p>

<p>When the single user mode white list is enabled, user can add application package to the white list and set restricted access to that particular application (Ex. com.symbol.emdkmxaccessmanagertutorial). user can also add multiple applications to the white list separated by commas to control access across multiple applications (Ex. com.symbol.emdkmxaccessmanagertutorial,com.symbol.emdkmxclocktutorial,com.symbol.mxgprstutorial). </p>

<blockquote>
  <p>Note: Make sure to add executing EMDK application to the white list in order to set access restrictions on other applications. otherwise your application will lose control of the Whitelist configuration and you will not be able to change the behavior until you perform Enterprise Reset on the device to get the default settings back.  </p>
</blockquote>

<p><strong>3. Remove specific packages from the white list:</strong>  </p>

<p>User can remove specific package(s) from the white list. If we want to remove multiple applications from white list, we need to specify their package names separated by commas (Ex. com.testapp1, com.testapp2, com.testapp3).</p>

<blockquote>
  <p>Note: Package names are unique identifiers of Android applications. Hence the API requires package names to refer any specific application.   </p>
</blockquote>

<p><strong>4. Remove all packages from the white list:</strong></p>

<p>When the device has lots of applications in the white list and if we want to remove all applications from white list then we can use this feature of Access Manager. It prevents user from adding all the package names manually, which could be time consuming.</p>

<p><strong>5. Control the behavior of the system settings menu when in single user mode white list:</strong></p>

<p>When the single user mode white list is enabled, user can control the behavior of the system settings menu that lets user control the level of access to the applications added in the white list. The user can either provide "Full Access" or "Reduced Access" to the applications that have been added to the white list.</p>

<p>So now we will create a tutorial to demonstrate how to Add/Remove applications to/from single user mode white list and observe the difference when the single user white list mode is changed (Enabled/Disabled) programmatically. </p>

<h2 id="creatingtheproject" class="anchor"><a class="heading-anchor" href="#creatingtheproject"><span></span></a>Creating The Project</h2>

<blockquote>
  <p>Note: Provide "MxAccessManagerTutorial" as the project name for this tutorial.</p>
</blockquote>

<p>Create a new project with Android Studio, click <a href="/emdk-for-android/11-0/tutorial/tutCreateProjectAndroidStudio">here</a>.</p>

<h2 id="addingtheaccessmanagerprofilefeature" class="anchor"><a class="heading-anchor" href="#addingtheaccessmanagerprofilefeature"><span></span></a>Adding The Access Manager Profile Feature</h2>

<ol>
<li><p>Click <a href="/emdk-for-android/11-0/tutorial/tutAddProfileManagerFeature">here</a> to see how to add a specific feature to the Profile Manager.</p></li>

<li><p>Provide "AccessManagerProfile" as the Profile Name for this tutorial.</p>

<blockquote>
  <p>Note: You can provide any Profile Name but make sure to access it with the similar name in the Android code.</p>
</blockquote></li>

<li><p>Now, you can see all these MX features on the left hand side of the Profile Editor window. Select the "Access Manager" feature from the list and click "Right Arrow".</p>

<p><img src="../../images/MxAccessManagerTutorialImages/access_manager_feature.jpg" alt="img"></p>

<p>As mentioned earlier you can see the drop down showing two options in the operation Mode. First one is Single user without whitelist and second is single user with whitelist. We would demonstrate both of these feature programatically using Access Manager API later in this tutorial. But for now, lets us configure one of these two operation modes from the wizard. This is to show you that we can modify any MX feature both programmatically as well as using wizrad. Hence select Operation mode as "Single User Without Whitelist". </p>

<p>Provide some name to refer this feature programmatically in order to modify it (Ex. MyAccessMgr).You can also keep the "Name" field empty.    </p>

<p><img src="../../images/MxAccessManagerTutorialImages/access_mgr_details.jpg" alt="img">   </p></li>

<li><p>Click Apply to apply the settings we provided. This setting would display all the applications that have not been added to the whitelist.    </p>

<p><img src="../../images/MxAccessManagerTutorialImages/access_profile_applied.jpg" alt="img"></p></li>

<li><p>Click Finish and your Access Manager profile is created that would display all applications, which are not in the whitelist. We would configure rest of the features programmatically later in this tutorial.</p>

<p><img src="../../images/MxAccessManagerTutorialImages/access_manager_profile_created.jpg" alt="img"> </p></li>

<li><p>Click "Close".</p>

<blockquote>
  <p>Note: <br>
  Now the "EMDKConfig.xml" is created under "\assets" folder. This file will contain a definition of all of your profiles that you create. </p>
</blockquote></li>

<li><p>You can inspect the EMDKConfig.xml to see it is reflecting the changes made to the parameters via EMDK Profile Manager GUI earlier.  However, it is advised that this file not be manually updated and only be controlled via the Profile Manager.</p>

<p><img src="../../images/MxAccessManagerTutorialImages/emdk_config_file_entries.jpg" alt="img">    </p></li>
</ol>

<h2 id="enablingandroidpermissions" class="anchor"><a class="heading-anchor" href="#enablingandroidpermissions"><span></span></a>Enabling Android Permissions</h2>

<ol>
<li><p>Modify the Application's Manifest.xml to use the EMDK library and to set permission for the EMDK.</p>

<p><img src="../../images/MxAccessManagerTutorialImages/manifest_file.jpg" alt="img"></p>

<p>You must first enable permissions for 'com.symbol.emdk.permission.EMDK':  </p>

<pre class="prettyprint"><code>
&lt;uses-permission android:name="com.symbol.emdk.permission.EMDK"/&gt; 
</code></pre>

<p>Then you must enable the library:  </p>

<pre class="prettyprint"><code>
&lt;uses-library android:name="com.symbol.emdk"/&gt;
</code></pre>

<p>When done, your manifest.xml should look like:</p>

<p><img src="../../images/MxAccessManagerTutorialImages/manifest_permissions_added.jpg" alt="img"> </p></li>
</ol>

<h2 id="addingsomecode" class="anchor"><a class="heading-anchor" href="#addingsomecode"><span></span></a>Adding Some Code</h2>

<ol>
<li><p>Now we will start to add some code. </p>

<p>First you must add references to the libraries:  </p>

<pre class="prettyprint"><code>
import com.symbol.emdk.*;  
import com.symbol.emdk.EMDKManager.EMDKListener;  
import android.widget.Toast;    
</code></pre>

<p>Then you must extend the activity to implement EMDKListener.   </p>

<pre class="prettyprint"><code>
public class MainActivity extends Activity implements EMDKListener {  

<pre><code>.. .. .. .. .. .. ...  

@Override  
public void onClosed() {  
       // TODO Auto-generated method stub  
}  

@Override  
public void onOpened(EMDKManager emdkManager) {  
       // TODO Auto-generated method stub  
}  
</code></pre>

}      
</code></pre>

<p>We will now create some global variables to hold the profile name as well as instance objects of EMDKManager and ProfileManager with a status variable while applying the profile. Some of the variables are used to hold the name, type and description in case of any errors. These variables would be used throughout the code. </p>

<blockquote>
  <p>Note:
  Verify the Profile name in the code with the one created in the Profile Manager. They both should be identical.    </p>
</blockquote>

<pre class="prettyprint"><code>
// Assign the profile name used in EMDKConfig.xml
private String profileName = "AccessManagerProfile";

// Declare a variable to store ProfileManager object
private ProfileManager profileManager = null;

// Declare a variable to store EMDKManager object
private EMDKManager emdkManager = null;

// Contains the parm-error name (sub-feature that has error)
private String errorName = "";

// Contains the characteristic-error type (Root feature that has error)
private String errorType = "";

// contains the error description for parm or characteristic error.
private String errorDescription = "";

// contains status of the profile operation
private String status = "";
</code></pre>

<p>In the onCreate method, we call getEMDKManager so that the EMDK can be initialized and checked to see if it is ready. </p>

<pre class="prettyprint"><code>
//The EMDKManager object will be created and returned in the callback.  
EMDKResults results = EMDKManager.getEMDKManager(getApplicationContext(), this);  

//Check the return status of getEMDKManager  
if (results.statusCode == EMDKResults.STATUS_CODE.SUCCESS) {

<pre><code>// EMDKManager object creation success
</code></pre>

} else {

<pre><code>// EMDKManager object creation failed
</code></pre>

}
</code></pre>

<p>So far your code should look like:</p>

<p><img src="../../images/MxAccessManagerTutorialImages/on_create_added.jpg" alt="img"></p></li>

<li><p>Now let's override the "onDestroy" method so we can release the EMDKManager resources:  </p>

<pre class="prettyprint"><code>
@Override  
protected void onDestroy() {  
    // TODO Auto-generated method stub  
    super.onDestroy();  
    //Clean up the objects created by EMDK manager  
    emdkManager.release();  
} 
</code></pre>

<p>Your onDestroy method should now look like this:  </p>

<p><img src="../../images/MxAccessManagerTutorialImages/on_destroy_method.jpg" alt="img"> </p></li>

<li><p>Now we need to use the <code>onOpened</code> method to get a reference to the EMDKManager. The EMDKListener interface will trigger this event when the EMDK is ready to be used. The EMDKListener interface must be implemented in order to get a reference to the EMDKManager APIs. This event will pass the EMDKManager instance and we assign it to the global variable <code>emdkManager</code> that we created in the previous steps. We then use that instance object to get an instance of ProfileManager and assign it to the global variable <code>profileManager</code>. This is how we will interface with the APIs in the rest of the code:</p>

<blockquote>
  <p>Note: 
  Rename the argument of <code>onOpened</code> method from <code>arg0</code> to <code>emdkManager</code>  </p>
</blockquote>

<pre class="prettyprint"><code>
// This callback will be issued when the EMDK is ready to use.
this.emdkManager = emdkManager;

// Get the ProfileManager object to process the profiles
profileManager = (ProfileManager) emdkManager
        .getInstance(EMDKManager.FEATURE_TYPE.PROFILE);         
</code></pre>

<p>Now that we have a reference to ProfleManager, we use it to install and activate the profile we built earlier using the <code>processProfile</code> method. We could have also performed this action at a different time, say when someone pressed a button, but we chose to do it as soon as the EMDK was ready:  </p>

<pre class="prettyprint"><code>
if (profileManager != null) {
    String[] modifyData = new String[1];

  // Call processPrfoile with profile name and SET flag to create the profile. The modifyData can be null.
  EMDKResults results = profileManager.processProfile(profileName,
            ProfileManager.PROFILE_FLAG.SET, modifyData);

  if (results.statusCode == EMDKResults.STATUS_CODE.CHECK_XML) {


  } else {
    // Show dialog of Failure
      AlertDialog.Builder builder = new AlertDialog.Builder(this);
      builder.setTitle("Failure");
      builder.setMessage("Failed to apply profile...")
              .setPositiveButton("OK",
                    new DialogInterface.OnClickListener() {
                            public void onClick                                                                             (DialogInterface dialog,
                                    int id) {

<pre><code>                        }
                    });
  AlertDialog alert = builder.create();
  alert.show();
</code></pre>

   }
}
</code></pre>

<p>This <code>processProfile</code> method returns the result of applying a particular profile that we set using EMDK Profile Wizard in <a href="/emdk-for-android/11-0/api">EMDKResults</a> reference. If the profile is successfully processed, it returns the status as <code>CHECK_XML</code> and then we go on and parse the response to get further details whether the profile was applied successfully or not. Otherwise we display a Failure message in a <a href="http://developer.android.com/reference/android/app/AlertDialog.html">dialog</a>.</p>

<blockquote>
  <p>Note: 1. There is a difference between processing a profile successfully and applying a profile successfully.</p>
  
  <p>Note: 2. If the status is other than <code>CHECK_XML</code>, we are simply displaying a failure message. You can actually go ahead and check different types of status and display the appropriate message accordingly, which is not in the scope of this sample tutorial.</p>
</blockquote>

<p>Now we will call a method <code>handleEMDKResult</code> in case of <code>CHECK_XML</code> status to handle this <a href="/emdk-for-android/11-0/api">EMDKResults</a>, which we will create in the next step.</p>

<pre class="prettyprint"><code>
// Method call to handle EMDKResult
handleEMDKResult(results);    
</code></pre>

<p>Your complete <code>onOpened</code> method should now look like this:</p>

<p><img src="../../images/MxAccessManagerTutorialImages/on_opened_method.jpg" alt="img"></p></li>

<li><p>It shows error as we have not yet declared <code>handleEMDKResult</code> method. So let us create this method, which would get the XML String response from <a href="/emdk-for-android/11-0/api">EMDKResults</a>, call the <code>parseXML</code> method to parse it and eventually call <code>displayResults</code> method to display output in a <a href="http://developer.android.com/reference/android/app/AlertDialog.html">dialog</a>, which we would be declaring in coming steps. </p>

<pre class="prettyprint"><code>
// Method to handle EMDKResult by extracting response and parsing it
public void handleEMDKResult(EMDKResults results) {
    // Get XML response as a String
    String statusXMLResponse = results.getStatusString();

<pre><code>try {
    // Create instance of XML Pull Parser to parse the response
    XmlPullParser parser = Xml.newPullParser();
    // Provide the string response to the String Reader that reads
    // for the parser
    parser.setInput(new StringReader(statusXMLResponse));
    // Call method to parse the response
    parseXML(parser);
} catch (XmlPullParserException e) {
    e.printStackTrace();
}

// Method call to display results in a dialog
displayResults();
</code></pre>

}
</code></pre>

<p>Your <code>handleEMDKResult</code> method should now look like this:</p>

<p><img src="../../images/MxAccessManagerTutorialImages/handle_emdk_result.jpg" alt="img"></p></li>

<li><p>You will see few errors as we have not declared the respective methods to parse the response and display result. Lets do it one by one. In this step, we will create a method <code>parseXML</code> that uses <a href="http://developer.android.com/reference/org/xmlpull/v1/XmlPullParser.html">XML Pull Parser</a> to parse the XML string response and set the status and error parameters if any.</p>

<p>In the reponse, we are supposed to capture <code>name</code> and <code>desc</code> for <code>parm-error</code> tag, <code>type</code> and <code>desc</code> for <code>characteristic-error</code> tag in case of any errors.</p>

<pre class="prettyprint"><code>
// Method to parse the XML response using XML Pull Parser
public void parseXML(XmlPullParser myParser) {
int event;
try {
    event = myParser.getEventType();
    while (event != XmlPullParser.END_DOCUMENT) {
        String name = myParser.getName();
        switch (event) {
        case XmlPullParser.START_TAG:
            // Get Status, error name and description in case of
            // parm-error
            if (name.equals("parm-error")) {
                status = "Failure";
                errorName = myParser.getAttributeValue(null, "name");
                errorDescription = myParser.getAttributeValue(null,
                        "desc");

<pre><code>            // Get Status, error type and description in case of
            // parm-error
        } else if (name.equals("characteristic-error")) {
            status = "Failure";
            errorType = myParser.getAttributeValue(null, "type");
            errorDescription = myParser.getAttributeValue(null,
                    "desc");
        }
        break;
    case XmlPullParser.END_TAG:

        break;
    }
    event = myParser.next();

  }
} catch (Exception e) {
e.printStackTrace();
}
</code></pre>

}
</code></pre>

<p>Your complete <code>parseXML</code> method should now look like:</p>

<p><img src="../../images/MxAccessManagerTutorialImages/parse_xml.jpg" alt="img"> </p></li>

<li><p>You will still see one error as we need to declare <code>displayResults</code> method to display the result of profile operation in a <a href="http://developer.android.com/reference/android/app/AlertDialog.html">dialog</a>. Before displaying the results, we should form the content of the result to be shown first, specifically in case of errors. This could be done by creating <code>buildFailureMessage</code> method.</p>

<p>In this method, the error message in case of error is formed using following way: </p>

<ul>
<li>Name and description of error if the response contains <code>parm-error</code>.</li>

<li>Type and description of error if the response contains <code>characteristic-error</code>.</li>

<li>Name, type and description of error if the response contains both <code>parm-error</code> and <code>characteristic-error</code>.</li></ul>

<p>The <code>buildFailureMessage</code> method would have following code to match the above mentioned criteria.  </p>

<pre class="prettyprint"><code>
// Method to build failure message that contains name, type and
// description of respective error (parm, characteristic or both)
public String buildFailureMessage() {
  String failureMessage = "";
  if (!TextUtils.isEmpty(errorName) &amp;&amp; !TextUtils.isEmpty(errorType))
     failureMessage = errorName + " :" + "\n" + errorType + " :" + "\n"
            + errorDescription;
  else if (!TextUtils.isEmpty(errorName))
     failureMessage = errorName + " :" + "\n" + errorDescription;
  else
     failureMessage = errorType + " :" + "\n" + errorDescription;
  return failureMessage;

}
</code></pre>

<p><code>buildFailureMessage</code> method should look like:</p>

<p><img src="../../images/MxAccessManagerTutorialImages/build_failure_message.jpg" alt="img"></p></li>

<li><p>In this step, we will add <code>displayResults</code> method to display the result of profile operation in a <a href="http://developer.android.com/reference/android/app/AlertDialog.html">dialog</a>. The dialog would display status as <code>Success</code> or <code>Failure</code> with corresponding message based on the response of profile operation.</p>

<pre class="prettyprint"><code>
// Method to display results (Status, Error Name, Error Type, Error
// Description) in a
// dialog
public void displayResults() {
  // Alert Dialog to display the status of the Profile creation
  // operation of MX features
  AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(
        MainActivity.this);

  if (TextUtils.isEmpty(errorDescription)) {
    alertDialogBuilder.setTitle("Success");
    alertDialogBuilder.setMessage("Profile Successfully Applied...");
  } else {
    // set title
    alertDialogBuilder.setTitle(status);
    // call buildFailureMessage() method to set failure message in
    // dialog
    alertDialogBuilder.setMessage(buildFailureMessage());
  }

  alertDialogBuilder.setCancelable(false).setPositiveButton("OK",
        new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int id) {
            }
        });
  // create alert dialog
  AlertDialog alertDialog = alertDialogBuilder.create();

  // show it
  alertDialog.show();

}  
</code></pre>

<p>The method <code>displayResults</code> should look like:</p>

<p><img src="../../images/MxAccessManagerTutorialImages/display_results.jpg" alt="img"></p>

<p>You can see that all the errors are gone.    </p></li>

<li><p>If you run the application at this moment, whatever the settings you made in the wizard would be applied to the device. But we are not done yet. We also have to implement a way to modify Access Manager settings programmatically using MX API as it could be annoying to change the wizard settings repetitively and then run the application each time to see the changes. So let us implement that using following steps.</p></li>

<li><p>Declare some global variables for User Interfaces such as Drop-down (Spinner), Button, Edit Text, Radio Group and Relative Layout. Now declare some global variables for drop-down (Spinner) adapter that holds lists for various drop downs such as system settings, add package, remove package. We will also declare some global integers that would contain position of an item clicked by the user in each of the three drop-downs (Spinners).</p>

<pre class="prettyprint"><code>
// Relative Layout that contains entire view when the single user mode with
// white list is enabled
private RelativeLayout whiteListLayout;

// Boolean that indicates whether single user mode with/without white list
// (False for without and True for with white list)
private boolean isWhiteListActive = false;

// Drop Down that contains options for settings menu of the Access Manager
private Spinner settingsAccessSpinner;

// Drop Down that contains options for deleting packages from white list
private Spinner deletePackageSpinner;

// Edit Text that contains comma separated package names to be removed from
// white list
private EditText deletePackageEditText;

// Drop Down that contains options for Adding packages to white list
private Spinner addPackageSpinner;

// Edit Text that contains comma separated package names to be added in the
// white list
private EditText AddPackageEditText;

// Array Adapter to hold arrays that are used in various drop downs
private ArrayAdapter&lt;String&gt; dataAdapter;

// Radio Group for holding Radio Buttons that enable user to select option
// for single user mode with or without white list
private RadioGroup radioGroup;

// Holds the position of user selected option in the settings drop down
private int settingsSpinnerPosition = 0;

// Holds the position of user selected option in the delete package drop
// down
private int deletePackageSpinnerPosition = 0;

// Holds the position of user selected option in the add package drop down
private int addPackageSpinnerPosition = 0;

// Set Button that is used to implement changes made by user in the
// Access Manager
private Button setButton;
</code></pre>

<p>So far the variables declared look like:   </p>

<p><img src="../../images/MxAccessManagerTutorialImages/global_variables.jpg" alt="img"></p></li>

<li><p>We will now add the layout for this application. This layout contains required View of this application. The view contains various drop downs for system settings menu, add package and drop package features. The view also contains two Radio Buttons to enable/disable white list mode. The layout also contains two Edit Texts that allow user to enter the package names to Add and Delete applications from the white list respectively when user enables the white list option from radio button. Finally the view contains a set button that implements all the changes made by the user.</p></li>
</ol>

<blockquote>
  <p>Remove all the code, inside "res/layout/activity_main.xml" and add following code to form a view described above.</p>
</blockquote>

<pre class="prettyprint"><code>
&lt;ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent" &gt;

&lt;RelativeLayout
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:layout_margin="10dip" &gt;

  &lt;RadioGroup
    android:id="@+id/radioGroupAccess"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" &gt;

    &lt;TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_margin="10dip"
        android:text="Choose your Access Manager Option:"
        android:textSize="14sp"
        android:textStyle="bold" /&gt;

    &lt;RadioButton
        android:id="@+id/radio_without_whitelist"
        android:layout_width="279dp"
        android:layout_height="wrap_content"
        android:checked="true"
        android:text="Single User Without Whitelist"
        android:textSize="14sp" /&gt;

    &lt;RadioButton
        android:id="@+id/radio_with_whitelist"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="Single User With Whitelist"
        android:textSize="14sp" /&gt;
  &lt;/RadioGroup&gt;

  &lt;RelativeLayout
    android:id="@+id/whitelist_layout"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_below="@+id/radioGroupAccess"
    android:visibility="gone" &gt;

    &lt;Spinner
        android:id="@+id/settings_access_spinner"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_margin="8dip" /&gt;

    &lt;Spinner
        android:id="@+id/delete_package_spinner"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_below="@+id/settings_access_spinner"
        android:layout_margin="8dip" /&gt;

    &lt;EditText
        android:id="@+id/et_delete_package"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_below="@+id/delete_package_spinner"
        android:layout_margin="8dip"
        android:hint="package names separated by commas"
        android:textSize="14sp"
        android:visibility="gone" /&gt;

    &lt;Spinner
        android:id="@+id/add_package_spinner"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_below="@+id/et_delete_package"
        android:layout_margin="8dip" /&gt;

    &lt;EditText
        android:id="@+id/et_add_package"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_below="@+id/add_package_spinner"
        android:layout_margin="8dip"
        android:hint="package names separated by commas"
        android:textSize="14sp"
        android:visibility="gone" /&gt;
  &lt;/RelativeLayout&gt;

   &lt;RelativeLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_below="@+id/whitelist_layout"
    android:paddingBottom="20dip" &gt;

    &lt;Button
        android:id="@+id/buttonSet"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="30dp"
        android:text="Set" /&gt;
   &lt;/RelativeLayout&gt;
 &lt;/RelativeLayout&gt;

&lt;/ScrollView&gt;
</code></pre>

<ol>
<li><p>We have three drop-downs (spinners) in the UI for system settings, Add Package and Remove Package respectively. These spinners show arrays based on their selections. We need to declare these arrays in order to set them to array adapters, which are held by spinners in the next step.</p>

<p>Go to "res/values" in the project. Right Click on "values" and create a new Android XML file.</p>

<p><img src="../../images/MxAccessManagerTutorialImages/right_click_value.jpg" alt="img"></p>

<p>If you are using Android Studio, use following screen shot as a reference by right clicking on "values" to create a new Android XML file.</p>

<p><img src="../../images/MxAccessManagerTutorialImages/right_click_value_android_studio.jpg" alt="img"></p>

<p>Provide the file name (Ex. arrays)</p>

<p><img src="../../images/MxAccessManagerTutorialImages/new_xml_file.jpg" alt="img"></p>

<p>Click Finish and "arrays.xml" file will be created under "res/values".</p>

<p>Add the following code that declare arrays in <code>&lt;resources&gt;</code> tag.</p>

<pre class="prettyprint"><code>
&lt;!-- Array for System Settings Menu --&gt;
&lt;string-array name="system_settings_array"&gt;
&lt;item&gt;Full Access&lt;/item&gt;
&lt;item&gt;Reduced Access&lt;/item&gt;
&lt;/string-array&gt;

&lt;!-- Array for delete packages options --&gt;
&lt;string-array name="delete_packages_array"&gt;
&lt;item&gt;Delete NO Packages&lt;/item&gt;
&lt;item&gt;Delete Specified Packages(s)&lt;/item&gt;
&lt;item&gt;Delete ALL Packages&lt;/item&gt;
&lt;/string-array&gt;

&lt;!-- Array for Add packages options --&gt;
&lt;string-array name="add_packages_array"&gt;
&lt;item&gt;Add NO Packages&lt;/item&gt;
&lt;item&gt;Add Specified Packages(s)&lt;/item&gt;
&lt;/string-array&gt;
</code></pre></li>

<li><p>Let us refer UI elements with their respective on click listeners in the <code>onCreate</code> method.</p>

<pre class="prettyprint"><code>
// Reference of Set Button
setButton = (Button) findViewById(R.id.buttonSet);

// On Click Listener Call for Set Button
setButton.setOnClickListener(onClickListsner);

// Reference for White List Layout
whiteListLayout = (RelativeLayout) findViewById(R.id.whitelist_layout);

// Reference for Radio Group that has Radio Buttons
radioGroup = (RadioGroup) findViewById(R.id.radioGroupAccess);

// On Checked Change Listener for Radio Buttons in a Radio Group
radioGroup.setOnCheckedChangeListener(onCheckedChangeListener);

// Reference for Add and Delete Package Edit Texts
deletePackageEditText = (EditText) findViewById(R.id.et_delete_package);
AddPackageEditText = (EditText) findViewById(R.id.et_add_package);

// Reference for settings, Add Package and Delete Package drop downs
settingsAccessSpinner = (Spinner) findViewById(R.id.settings_access_spinner);
deletePackageSpinner = (Spinner) findViewById(R.id.delete_package_spinner);
addPackageSpinner = (Spinner) findViewById(R.id.add_package_spinner);

// Adapter to hold the list system settings menu options
dataAdapter = new ArrayAdapter&lt;String&gt;(this,
        android.R.layout.simple_spinner_item, getResources()
                .getStringArray(R.array.system_settings_array));
dataAdapter
        .setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
// Set adapter to settings drop down
settingsAccessSpinner.setAdapter(dataAdapter);

// Adapter to hold the list delete package options
dataAdapter = new ArrayAdapter&lt;String&gt;(this,
        android.R.layout.simple_spinner_item, getResources()
                .getStringArray(R.array.delete_packages_array));
dataAdapter
        .setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
// Set adapter to delete package drop down
deletePackageSpinner.setAdapter(dataAdapter);

// Adapter to hold the list add package options
dataAdapter = new ArrayAdapter&lt;String&gt;(this,
        android.R.layout.simple_spinner_item, getResources()
                .getStringArray(R.array.add_packages_array));
dataAdapter
        .setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
// Set adapter to add package drop down
addPackageSpinner.setAdapter(dataAdapter);

// Call to common On Item Selected Listener for all drop downs based on
// view ID.
settingsAccessSpinner.setOnItemSelectedListener(onItemSelectedListener);
deletePackageSpinner.setOnItemSelectedListener(onItemSelectedListener);
addPackageSpinner.setOnItemSelectedListener(onItemSelectedListener);
</code></pre>

<p>So we have completed the <code>onCreate</code> method. Here is the screen capture of part of this method.</p>

<blockquote>
  <p>Note: Please read detailed comments in the code to get significance of each attribute. </p>
</blockquote>

<p><img src="../../images/MxAccessManagerTutorialImages/complete_on_create.jpg" alt="img"></p></li>

<li><p>At this point, you will see few of errors. This is because we have not implemented respective on click listeners yet. Let us implement them one by one.</p>

<p>First, we will implement <code>OnCheckedChangeListener</code> on Radio Group that is used to enable/disable white list mode. So when it is enabled, the user will see a whitelist layout, which is a view that has some spinners to perform further configurations. When whitelist is disbaled, the whitelist layout is hidden to the user.</p>

<pre class="prettyprint"><code>
// On checked change listener for Radio Buttons of Radio Group
private OnCheckedChangeListener onCheckedChangeListener = new OnCheckedChangeListener() {

 @Override
 public void onCheckedChanged(RadioGroup group, int checkedId) {
    switch (checkedId) {
    // Single User Mode Without White List
    case R.id.radio_without_whitelist:
        // Set the white list flag to false
        isWhiteListActive = false;
        // Clear all the edit texts
        deletePackageEditText.setText("");
        AddPackageEditText.setText("");
        // Hide the White List Layout
        whiteListLayout.setVisibility(View.GONE);
        break;
    // Single User Mode With White List
    case R.id.radio_with_whitelist:
        // Set the white list flag to false
        isWhiteListActive = true;
        // Show the White List Layout
        whiteListLayout.setVisibility(View.VISIBLE);
        break;
    default:
        break;
    }

 }
};
</code></pre>

<blockquote>
  <p>Note: While importing, select Radio Group and not compound button widget.</p>
</blockquote>

<p>The <code>OnCheckedChangeListener</code> for Radio Group looks like:</p>

<p><img src="../../images/MxAccessManagerTutorialImages/on_checked_change_listener.jpg" alt="img"></p></li>

<li><p>We have implemented a <code>onItemSelectedListener</code> for all three spinners that will take respective actions based on the spinner ID.</p>

<pre class="prettyprint"><code>
// Common On Item Selected Listener for all drop downs based on View ID
private OnItemSelectedListener onItemSelectedListener = new OnItemSelectedListener() {

@Override
public void onItemSelected(AdapterView&lt;?&gt; parent, View view,
        int position, long id) {
    // Get View Id of user selected drop down
    int spinnerID = parent.getId();
    switch (spinnerID) {
    // System Settings drop down is selected
    case R.id.settings_access_spinner:
        settingsSpinnerPosition = ++position;
        break;
    // Delete Package drop down is selected
    case R.id.delete_package_spinner:
        deletePackageSpinnerPosition = position;
        // Show/Hide delete package Edit Text based on user selection
        if (deletePackageSpinnerPosition == 1)
            // Show the delete package Edit Text
            deletePackageEditText.setVisibility(View.VISIBLE);
        else
            // Hide the delete package Edit Text
            deletePackageEditText.setVisibility(View.GONE);
        break;
    // Add Package drop down is selected
    case R.id.add_package_spinner:
        addPackageSpinnerPosition = position;
        // Show/Hide Add package Edit Text based on user selection
        if (addPackageSpinnerPosition == 1)
            // Show the Add package Edit Text
            AddPackageEditText.setVisibility(View.VISIBLE);
        else
            // Hide the Add package Edit Text
            AddPackageEditText.setVisibility(View.GONE);
        break;
    default:
        break;
    }

}

 @Override
 public void onNothingSelected(AdapterView&lt;?&gt; arg0) {
    // TODO Auto-generated method stub

 }
};
</code></pre>

<p>The <code>onItemSelectedListener</code> for spinners looks like:</p>

<p><img src="../../images/MxAccessManagerTutorialImages/on_item_slected_listener.jpg" alt="img"></p></li>

<li><p>Now we will implement the <code>onClickListener</code> for the set Button. this listener will call method <code>modifyAccessManagerProfileXML</code> that forms an XML based on users selection and sets the changes to the Profile.</p>

<pre class="prettyprint"><code>
// On Click Listener for Set Button
private OnClickListener onClickListsner = new OnClickListener() {

@Override
public void onClick(View view) {
    // TODO Auto-generated method stub
    int id = view.getId();
    switch (id) {
    case R.id.buttonSet:
        // Call modifyAccessManagerProfileXML method to set the user
        // selected changes
        modifyAccessManagerProfileXML(isWhiteListActive);
        break;
    default:
        break;
    }
 }
</code></pre>

<p>};</p>

<p>The <code>onClickListener</code> for set Button looks like:</p>

<p><img src="../../images/MxAccessManagerTutorialImages/on_click_listener.jpg" alt="img"></p></li>

<li><p>Finally, we will implement <code>modifyAccessManagerProfileXML</code> method. This is the method that actually implements Access Manager configurations set by the user. It prepares an xml input for the <code>processProfile</code> method based on "value" attribute of different Access Manager configurations. It then calls the <code>handleEMDKResult</code> method that we have already created to handle the <a href="/emdk-for-android/11-0/api">EMDKResults</a> and display the output.</p>

<blockquote>
  <p>Note: Please refer to code comments of <code>modifyAccessManagerProfileXML</code> method to understand more about "value" attribute.
  The global integres hold these "value" attributes based on user selection of various Access Manager features (Enable/Disable Whitelist, System Settings, Add/Delete Packages to/from whitelist etc.).</p>
</blockquote>

<p>So these global integer variables are set to the respective Access Manager attributes while forming the XML input, which is then passed to the <code>processProfile</code> method.</p>

<pre class="prettyprint"><code>
// Method to modify Access Manager settings based on user selection and set
// them in Profile Manager
private void modifyAccessManagerProfileXML(boolean isWhiteListActive) {

<pre><code>// Prepare XML to modify the existing profile settings
String[] modifyData = new String[1];

// Check if the user has selected with/without white list option
// from radio group in order to form modifyData xml accordingly.
if (isWhiteListActive) {
    // User has selected Single User Mode With White list
    modifyData[0] = "&amp;lt;?xml version=\"1.0\" encoding=\"utf-8\"?&amp;gt;"
            + "&amp;lt;characteristic type=\"Profile\"&amp;gt;"
            + "&amp;lt;parm name=\"ProfileName\" value=\"AccessManagerProfile\"/&amp;gt;"
            + "&amp;lt;characteristic type=\"AccessMgr\"&amp;gt;"
            + "&amp;lt;parm name=\"OperationMode\" value=\"2\"/&amp;gt;"
            + "&amp;lt;parm name=\"SystemSettings\" value=\""
            + settingsSpinnerPosition + "\"/&amp;gt;";

    // Set the delete package settings to the xml based on user
    // selection from
    // delete package drop down stored in
    // deletePackageSpinnerPosition integer
    // deletePackageSpinnerPosition = 0 -&amp;gt; Delete No Package
    // deletePackageSpinnerPosition = 1 -&amp;gt; Delete Specific
    // Packages(s)
    // deletePackageSpinnerPosition = 2 -&amp;gt; Delete All Packages
    if (deletePackageSpinnerPosition == 1) {
        // Get package names to be deleted from white list
        modifyData[0] = modifyData[0]
                + "&amp;lt;parm name=\"DeletePackagesAction\" value=\"1\"/&amp;gt;"
                + "&amp;lt;parm name=\"DeletePackageNames\" value=\""
                + deletePackageEditText.getText().toString()
                + "\"/&amp;gt;";
    } else {
        // Delete No Package or Delete All Package based on
        // deletePackageSpinnerPosition integer
        modifyData[0] = modifyData[0]
                + "&amp;lt;parm name=\"DeletePackagesAction\" value=\""
                + deletePackageSpinnerPosition + "\"/&amp;gt;";
    }

    // Set the Add package settings to the xml based on user
    // selection from
    // Add package drop down stored in
    // addPackageSpinnerPosition integer
    // addPackageSpinnerPosition = 0 -&amp;gt; Add No Package
    // addPackageSpinnerPosition = 1 -&amp;gt; Add Specific
    // Packages(s)
    if (addPackageSpinnerPosition == 1) {
        // Get package names to be added in the white list
        modifyData[0] = modifyData[0]
                + "&amp;lt;parm name=\"AddPackagesAction\" value=\"1\"/&amp;gt;"
                + "&amp;lt;parm name=\"AddPackageNames\" value=\""
                + AddPackageEditText.getText().toString() + "\"/&amp;gt;";
    } else {
        // Add No Package
        modifyData[0] = modifyData[0]
                + "&amp;lt;parm name=\"AddPackagesAction\" value=\""
                + addPackageSpinnerPosition + "\"/&amp;gt;";
    }

    modifyData[0] = modifyData[0] + "&amp;lt;/characteristic&amp;gt;"
            + "&amp;lt;/characteristic&amp;gt;";
} else {
    // User has selected Single User Mode Without White list
    modifyData[0] = "&amp;lt;?xml version=\"1.0\" encoding=\"utf-8\"?&amp;gt;"
            + "&amp;lt;characteristic type=\"Profile\"&amp;gt;"
            + "&amp;lt;parm name=\"ProfileName\" value=\"AccessManagerProfile\"/&amp;gt;"
            + "&amp;lt;characteristic type=\"AccessMgr\"&amp;gt;"
            + "&amp;lt;parm name=\"OperationMode\" value=\"1\"/&amp;gt;"
            + "&amp;lt;/characteristic&amp;gt;" + "&amp;lt;/characteristic&amp;gt;";
}

// Call process profile to modify the Access Manager Profile of
// specified profile
// name based on modifyData XML formed above
EMDKResults results = profileManager.processProfile(profileName,
        ProfileManager.PROFILE_FLAG.SET, modifyData);

if (results.statusCode == EMDKResults.STATUS_CODE.CHECK_XML) {

// Method call to handle EMDKResult
handleEMDKResult(results);

} else {
// Show dialog of Failure
AlertDialog.Builder builder = new AlertDialog.Builder(this);
builder.setTitle("Failure");
builder.setMessage("Failed to set device clock...")
        .setPositiveButton("OK",
                new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog,
                            int id) {

                    }
                });
AlertDialog alert = builder.create();
alert.show();
</code></pre>

  }
}
</code></pre></li>
</ol>

<p>The <code>modifyAccessManagerProfileXML</code> method looks like:</p>

<p><img src="../../images/MxAccessManagerTutorialImages/modify_profile_method.jpg" alt="img"></p>

<p>You can see all the errors are gone now. The sample XML for "without Whitelist" feature, which is passed to <code>processProfile</code> method looks like:</p>

<pre class="prettyprint"><code>    
    modifyData[0] = "&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;"
    + "&lt;characteristic type=\"Profile\"&gt;"
    + "&lt;parm name=\"ProfileName\" value=\"MxAccessManagerProfile\"/&gt;"
    + "&lt;characteristic type=\"AccessMgr\"&gt;"
    + "&lt;parm name=\"OperationMode\" value=\"1\"/&gt;"
    + "&lt;/characteristic&gt;" + "&lt;/characteristic&gt;";         
</code></pre>

<p>That's it!!! We are done with all the coding and configuration part that will allow us to implement Access Manager both programmatically as well as using wizard. Now let us run and test the application.</p>

<h2 id="runningtheapplication" class="anchor"><a class="heading-anchor" href="#runningtheapplication"><span></span></a>Running the Application</h2>

<ol>
<li><p>Connect the device to a USB port. </p>

<blockquote>
  <p>Note: Make sure the device has USB debugging enabled. </p>
</blockquote></li>

<li><p>Run the application.</p>

<p><img src="../../images/MxAccessManagerTutorialImages/home_screen.png" alt="img"></p>

<p>You can see an <a href="http://developer.android.com/reference/android/app/AlertDialog.html">Alert Dialog</a> with a success message, which indicates that the app has successfully implemented settings that we had configured in the wizard. You won't see any change as we had disabled the whitelist in the wizard. </p>

<blockquote>
  <p>Note: In case of any errors, you will see a Failure status with respective error message in that dialog.  </p>
</blockquote>

<p>Now you can see the two Radio Buttons of which first is checked. It means we are in a single user mode without whitelist. </p></li>

<li><p>Click the Radio Button Single user mode with whitelist and the respective view will be visible to user</p>

<p><img src="../../images/MxAccessManagerTutorialImages/with_whitelist.png" alt="img"></p>

<p>Now you have enabled whitelist. It means you can now add/remove applications to/from the whitelist. Let us add few applications to the whitelist. </p></li>

<li><p>Select "Add No Packages" drop-down and select "Add specified packages" option to add few applications to the whitelist.</p>

<p><img src="../../images/MxAccessManagerTutorialImages/add_package_spinner.png" alt="img"></p>

<p>It will display an Edit Text to provide the package names of the applications that you want to add to whitelist.</p>

<p><img src="../../images/MxAccessManagerTutorialImages/add_package_edit_text.png" alt="img"></p>

<p>Provide package names of few applications separated by commas. (Ex. com.symbol.mxaccessmanagertutorial, com.allinstalledapps, com.symbol.mxgprstutorial).</p>

<p><img src="../../images/MxAccessManagerTutorialImages/add_packages.png" alt="img"></p>

<blockquote>
  <p>Note: Make sure to add current application to the white list in order to set access restrictions on other applications. Otherwise user won't be able to access the current application that has access restrictions on other applications and eventually user has to perform Enterprise Reset on the device to get the default settings back.</p>
</blockquote>

<p>Keep the Full Access and press the "Set" button. </p>

<p><img src="../../images/MxAccessManagerTutorialImages/whitelist_mode.png" alt="img"></p>

<p>You can see that the device is in single user mode with whitelist. It shows the three applications in the whitelist whose package names we had provided in Add Package Edit Text. The other developed apps are not visible in this mode.</p></li>

<li><p>Now let us remove one application from the whitelist by going to our app and adding the package name in the delete package Edit Text.</p>

<p>But if you start the application, it will disable whitelist as we have set that feature in the wizard. So we have to comment some code to ensure delete package from the whitelist feature works fine.</p>

<p>Go to <code>onOpened</code> method and comment the highlighted code in the following snapshot.</p>

<p><img src="../../images/MxAccessManagerTutorialImages/commented_code.jpg" alt="img"> </p>

<blockquote>
  <p>Note: You can uncomment this code later after verifying "Delete Package from Whitelist" feature.   </p>
</blockquote></li>

<li><p>Run the application again.
Check the Radio Button "Single User with Whitelist" -&gt; click "Delete No Packages" drop down -&gt; Select "Delete Specified Packages(s)" option -&gt; Add name of the application package in Edit Text that you want to remove from whitelist (Ex. com.allinstalledapps).</p>

<p><img src="../../images/MxAccessManagerTutorialImages/delete_package.png" alt="img"></p>

<p>Click "Set" button.</p>

<p><img src="../../images/MxAccessManagerTutorialImages/delete_package.png" alt="img"></p>

<p>You can see that the application with package name "com.allinstalledapps" has been removed from the whitelist as there are only two application whereas we had added three application previously in the whitelist.</p></li>

<li><p>In this way, you can configure and test various features of MX Access Manager on your Zebra device.      </p></li>
</ol>

<h2 id="importantprogrammingtips" class="anchor"><a class="heading-anchor" href="#importantprogrammingtips"><span></span></a>Important Programming Tips</h2>

<ol>
<li><p>It is required to do the following changes in the application's AndroidManifest.xml:  </p>

<blockquote>
  <p>Note:</p>
  
  <ul>
  <li>Include the permission for EMDK:  </li></ul>
</blockquote>

<pre class="prettyprint"><code>
&lt;uses-permission android:name="com.symbol.emdk.permission.EMDK"/&gt;
</code></pre>

<blockquote>
  <p>Note:</p>
  
  <ul>
  <li>Use the EMDK library:  </li></ul>
</blockquote>

<pre class="prettyprint"><code>
&lt;uses-library android:name="com.symbol.emdk"/&gt;
</code></pre></li>

<li><p>Use DataWedge v1.7.12 or higher version to test the <code>ProfileManager.processProfile()</code> method for DataWedge profiles.</p></li>
</ol>

<hr>

<h2 id="whatsnext" class="anchor"><a class="heading-anchor" href="#whatsnext"><span></span></a>What's Next</h2>

<p>Now that you have learned how to configure access to different applications on your device through your application using MX Access Manager, let us try to understand and implement some of the other MX features. So in the next tutorial, we will concentrate on the "Certificate Manager" MX feature and try to explore this feature by creating a tutorial.</p><p></p>
                                        


                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div><!--/.col-sm-6-->
            </div>
            </section>
        </div>
    </section>    

<div class="modal fade" id="basicModal" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true" data-backdrop="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
					</div>
					<div class="modal-body">
						<div id="modalImg">
						
						</div>
					</div>
			</div>
		  </div>
		</div> </div>
         <footer id="footer">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-sm-10">
                        ZEBRA and the stylized Zebra head are trademarks of Zebra Technologies Corp., registered in many jurisdictions worldwide. All other trademarks are the property of their respective owners. 2024 Zebra Technologies Corp. and/or its affiliates.<br> <a href="https://www.zebra.com/us/en/about-zebra/company-information/legal.html">Legal</a> | <a href="https://www.zebra.com/us/en/about-zebra/company-information/compliance/information-privacy/terms-of-use.html">Terms of Use</a> | <a href="https://www.zebra.com/us/en/about-zebra/company-information/legal/privacy-statement.html">Privacy Policy</a> 
                    </div>
                     <!--
                     <div class="col-sm-2">
                        <ul class="social-icons">
                            <li><a href="http://www.facebook.com/pages/Zebra-Technologies/107703715989073"><i class="fa fa-facebook"></i></a></li>
                            <li><a href="https://twitter.com/ZebraDevs"><i class="fa fa-twitter"></i></a></li>
                            <li><a href="http://www.youtube.com/zebratechnologies/"><i class="fa fa-youtube"></i></a></li>
                            <li><a href="https://www.linkedin.com/groups?home=&gid=3220074&trk=anet_ug_hm&goback=%2Egmr_3220074"><i class="fa fa-linkedin"></i></a></li>
                            <li><a href="https://github.com/developer-zebra"><i class="fa fa-github"></i></a></li>
                        </ul>
                    </div> -->
                 </div>
            </div>
        </footer>
    
    <!--/#footer 
        10/25/18 removed <footer id="footer" class="navbar-fixed-bottom">
    -->
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/owl.carousel.min.js"></script>
    <script src="/js/mousescroll.js"></script>
    <script src="/js/smoothscroll.js"></script>
    <script src="/js/jquery.prettyPhoto.js"></script>
    <script src="/js/jquery.isotope.min.js"></script>
    <script src="/js/jquery.inview.min.js"></script>
    <script src="/js/wow.min.js"></script>
    <script src="/js/bootstrap-treenav.min.js"></script>
    <script src="/js/prettify.js"></script>
    <script src="/js/zepto.js"></script>
    <script src="/js/jquery.waterfall.js"></script>   
    <script src="/js/main.js"></script>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','zRzEsAUhWTTkrdEN2YfA','2.0.0');
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-72584442-1', 'auto');
  ga('send', 'pageview');

</script> 

<script>
    ChatraID = 'QDvZ76min4DhLW5vJ';
    (function(d, w, c) {
        var n = d.getElementsByTagName('script')[0],
            s = d.createElement('script');
        w[c] = w[c] || function() {
            (w[c].q = w[c].q || []).push(arguments);
        };
        s.async = true;
        s.src = (d.location.protocol === 'https:' ? 'https:': 'http:')
            + '//call.chatra.io/chatra.js';
        n.parentNode.insertBefore(s, n);
    })(document, window, 'Chatra');
</script>         


</body></html>