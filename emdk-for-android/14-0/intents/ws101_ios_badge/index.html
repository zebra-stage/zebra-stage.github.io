
<!DOCTYPE html>
<html lang="en"><head>

    <meta charset="utf-8">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="-1">
    <meta http-equiv="CACHE-CONTROL" content="NO-CACHE">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Online Documentation for Zebra Technologies developer tools and utilties, including EMDK for Android, EMDK for Xamarin, StageNow and Enterprise Browser.">
    <meta name="author" content="Zebra Technologies">
    <meta name="google-site-verification" content="i4B78BrWnNy8ShJwe5feRW3jO3HE6gfYlYqYbxfl8yY">
    <meta name="msvalidate.01" content="6B651B00161BCE79B8950AC09D5C4C75">
    <meta title="WS101 Programmer's Guide for iOS">
    <title>WS101 Programmer's Guide for iOS - TechDocs</title>
    <!-- core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
<!--     
    <link href="/css/font-awesome.min.css" rel="stylesheet">
 -->    
    <link href="/css/all.css" rel="stylesheet">
    <link href="/css/v4-shims.css" rel="stylesheet">
    <link href="/css/animate.min.css" rel="stylesheet">
    <link href="/css/owl.carousel.css" rel="stylesheet">
    <link href="/css/owl.transitions.css" rel="stylesheet">
    <link href="/css/prettyPhoto.css" rel="stylesheet">
    <link href="/css/main.css" rel="stylesheet">
    <link href="/css/responsive.css" rel="stylesheet">
    <link href="/css/prettify.css" rel="stylesheet">
    <link href="/css/bootstrap-treenav.min.css" rel="stylesheet">
    <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
    <script src="js/respond.min.js"></script>
    <![endif]--> 

    <!-- 6/13/24- a "crown" icon randomly appeared in the MX matrix today. Rob said it looked like sumo. 
        <script src="//load.sumome.com/" data-sumo-site-id="699cb66cf4dc59352efb45705526d15cbe314e1cd43f7761b94d96f3cf7338e8" async="async"></script> -->
    <link rel="shortcut icon" href="/favicon.ico">
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-01QJCMQM9N"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-01QJCMQM9N');
</script><script src="/js/jquery.js"></script></head><!--/head-->

<!-- Google tag -->





<body id="home" class="homepage" data-spy="scroll" data-offset="100" data-target="#toc">

    <header id="header">
        <nav id="main-menu" class="navbar navbar-default navbar-fixed-top" role="banner">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/"><img src="/images/logo.png" alt="logo" style="max-height:66px;float: inherit;
    padding-right: 3px;"></a> 
                    
                   
                </div>
                <div class="collapse navbar-collapse navbar-left">
                    <ul class="nav navbar-nav">
                        <li class="navbar-text pull-left"><strong>TechDocs</strong></li>
                        <li class="dropdown">
                          <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown"> EMDK For Android 14.0
                          <span class="caret"></span></button>
                          <ul class="dropdown-menu">
                                <li><a onclick="changeVersion('5-0','4-2','/emdk-for-android/4-2/guide/about')">EMDK For Android 4.2</a></li>
                                <li><a onclick="changeVersion('5-0','4-0','/emdk-for-android/4-0/guide/about')">EMDK For Android 4.0</a></li>
                          </ul>
                        </li>                    
                    </ul>
                </div>
                <div class="collapse navbar-collapse navbar-right">
                    <ul class="nav navbar-nav">
                        


                        <li>
                            <a href="/emdk-for-android/14-0/guide/about">
                                    About
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/14-0/guide/gettingstarted">
                                    Set Up
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/14-0/tutorial/">
                                    Tutorials
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/14-0/samples">
                                    Samples
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/14-0/guide/programming-guides">
                                    Guides
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/14-0/guide/profile-manager-guides">
                                    Profile Manager
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/14-0/faq">
                                    FAQs
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/14-0/apimenu">
                                    APIs
                            </a>
                        </li>
                        <li>
                            <a href="https://developer.zebra.com/forum/search?keys=&amp;field_zebra_curated_tags_tid%5B%5D=184">
                                    <i class="fa fa-comments-o"></i>
                            </a>
                        </li>
                        <li>
                            <a href="/emdk-for-android/14-0/search">
                                    <i class="fa fa-search"></i>
                            </a>
                        </li>
                        
                        <!-- <li ><a href="/products">SDKs</a></li>
                        <li ><a href="/samples">Samples</a></li>
                        <li ><a href="/guides">Guides</a></li>
                        <li ><a href="/tutorials">Tutorials</a></li>
                        <li ><a href="/apis">APIs</a></li> -->
                        <!-- <li><a href="#"><input type="text" class="st-default-search-input"></a></li> -->
                    </ul>
                </div>
            </div><!--/.container-->
        </nav><!--/nav-->
    </header><!--/header-->
<div class="container-fluid">
    <section id="blog">
        <div class="">
            <section class="content-with-sidebar">
            <div class="row">
                <div class="col-sm-3 hidden-sm hidden-xs" id="sidebar">
                    
                    
                    <nav id="toc" data-toggle="toc" data-spy="affix" style="height: 75%; max-width: 225px; overflow-y: auto; ">
                        
                        <ul class="nav">
                            <li><strong>WS101 Programmer's Guide for iOS</strong></li>
                        </ul>
                    </nav>
                    <div class="modal fade" id="modal-smartdocs" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true" data-backdrop="true">
                    	<div class="modal-dialog">
                    		<div class="modal-content">
                    			<div class="modal-header">
                    				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
                    			</div>
                    			<div class="modal-body">
                    				<form>
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">MX Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="4.0">4.0</option>
                    					  <option value="4.1">4.1</option>
                    					  <option value="4.2">4.2</option>
                    					  <option value="4.3">4.3</option>
                    					  <option value="5.0">5.0</option>
                    					</select>
                    				  </div>						
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">OSX Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="1.0">1.0</option>
                    					  <option value="1.2">1.2</option>
                    					  <option value="1.3.4-56">1.3.4-56</option>
                    					  <option value="3.4">3.4</option>
                    					  <option value="3.5">3.5</option>
                    					  <option value="3.6">3.6</option>
                    					  <option value="4.1">4.1</option>
                    					  <option value="4.2">4.2</option>
                    					  <option value="4.3">4.3</option>
                    					  <option value="4.4">4.4</option>
                    					</select>
                    				  </div>						
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">Android Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="23">6.0 Marshmallow</option>
                    					  <option value="22">5.1 Lollipop</option>
                    					  <option value="21">5.0 Lollipop</option>
                    					  <option value="19">4.4 Kitkat</option>
                    					  <option value="18">4.3 Jellybean</option>
                    					  <option value="17">4.2.x Jellybean</option>
                    					  <option value="16">4.1.x Jellybean</option>
                    					  <option value="15">4.0.3-4.0.4 Ice Cream Sandwich</option>
                    					  <option value="14">4.0-4.0.2 Ice Cream Sandwich</option>
                    					  <option value="10">2.3.3-2.3.4 Gingerbread</option>
                    					</select>
                    				  </div>
                    				  <div class="form-group">
                    				  	<button class="primary" id="btn_SaveSmartDocOptions">Save Changes</button><button class="primary" id="btn_ClearSmartDocOptions">Clear Changes</button>
                    				  </div>
                    				</form>
                    			</div>
                    	</div>
                      </div>
                    </div>
                    
                    <script type="text/javascript">
                        $(document).ready(function() {
                        	$( "#btn_SaveSmartDocOptions" ).click(function() {
                      			console.log('Saving Options');
                      			$("#modal-smartdocs").modal({show: false});
                    		});
                        	$( "#btn_SaveSmartDocOptions" ).click(function() {
                      			console.log('Clearing Options');
                      			$("#modal-smartdocs").modal({show: false});
                    		});
                        });
                    </script><link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.3.0/dist/bootstrap-toc.min.css">
                    <script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.3.0/dist/bootstrap-toc.min.js"></script>
                    <script type="text/javascript">
                        $(document).ready(function() {
                    
                        });
                    
                    
                    </script>
                </div>                
                <div class="col-sm-9 ">
                    <div class="row">
                        <div class="col-sm-12">
                            <section id="cta" class="wow fadeIn">
                                <div class="">
                                    <h1 id="ws101-programmers-guide-for-ios" class="anchor"><a class="heading-anchor" href="#ws101-programmers-guide-for-ios"><span></span></a>WS101 Programmer's Guide for iOS</h1>
                                    <p>
                                            EMDK For Android
                                            14.0
                                    </p>
                                </div>
                            </section>                    
                        </div>
                    </div>
                    <div id="mainContent" class="row">
                        <div class="col-sm-12">
                            <div class="blog-post blog-large wow fadeInLeft" data-wow-duration="300ms" data-wow-delay="0ms">
                            <!-- Start of guide -->
                                <div class="service-box wow fadeInRight">
                                    <div class="">

                                        <p></p><h2 id="overview" class="anchor"><a class="heading-anchor" href="#overview"><span></span></a>Overview</h2>

<p><strong>Zebra's <a href="https://www.zebra.com/us/en/products/mobile-computers/wearable-computers/ws1x-series.html">WS101 Bluetooth Communication Badge</a> is a rugged Bluetooth comm device</strong> that can add hands-free voice capabilities to Zebra mobile computers and tablets. Small and light enough to be worn or pocketed, WS101-series devices provide workers with a means to easily communicate with fellow employees through Zebra's voice-enabled apps or a company's own. Staff can make calls, look up inventory items, hear responses and receive instructions, all without touching a mobile device or tablet. </p>

<table>
    <tbody><tr>
        <td><img style="height:250px" src="ws101_icu.jpg"></td>
        <td>&nbsp;&nbsp;</td>
        <td><img style="height:250px" src="ws101_pharma.jpg"></td>
        <td>&nbsp;&nbsp;</td>
        <td><img style="height:250px" src="ws101_retail.jpg"></td>
        <td>&nbsp;&nbsp;</td>
    </tr>
    <tr>
        <td col="" span="3"><i>The WS101 in healthcare, pharma and retail.</i></td>
    </tr>
</tbody></table>

<h3 id="mainfeatures" class="anchor"><a class="heading-anchor" href="#mainfeatures"><span></span></a>Main Features</h3>

<ul>
<li><strong>Button Events</strong>: P1, P2, P3</li>

<li><strong>Voice Triggers</strong>: Wake Word, Duress Word</li>

<li><strong>SDK version query</strong>: <code>(getSDKVersion())</code> </li>

<li><strong>Voice Control</strong>: Leverages SiriKit for hands-free app operation</li>

<li><strong>Hardware Integration</strong>: Use of physical buttons on the Bluetooth speaker for core app functions</li>

<li><strong>Safety Features</strong>: Implements a duress/panic button feature triggered by either physical button or dedicated wake word</li>
</ul>

<h3 id="appdevrequirements" class="anchor"><a class="heading-anchor" href="#appdevrequirements"><span></span></a>App-dev Requirements</h3>

<ul>
<li>Apple Xcode 15 (or later)</li>

<li>Apple iPhone or iPad running iOS 16 (or later) with:


<ul>
<li>Bluetooth </li>

<li>Microphone</li>

<li>Siri</li></ul>
</li>

<li><strong>Background modes enabled</strong>:


<ul>
<li>Use Bluetooth LE accessories</li>

<li>Act as a Bluetooth LE accessory</li>

<li>Voice over IP</li>

<li>Remote notifications</li>

<li>Background processing</li>

<li>Background fetch</li>

<li>Audio, AirPlay, Picture-in-Picture</li></ul>
</li>

<li>WS101 device connected via Bluetooth for <strong>"Phone calls" <u>and</u> "Media audio"</strong></li>
</ul>

<p><strong>Also required, the following must be addded to the</strong> <code>info.plist</code> <strong>file</strong>:</p>

<pre class="prettyprint"><code>    
    &lt;key&gt;NSBluetoothAlwaysUsageDescription&lt;/key&gt;
    &lt;string&gt;This app uses Bluetooth to connect to Zebra Audio Devices.&lt;/string&gt;
    &lt;key&gt;NSMicrophoneUsageDescription&lt;/key&gt;
    &lt;string&gt;This app requires access to the microphone to record audio for voice notes.&lt;/string&gt;
    &lt;key&gt;UIBackgroundModes&lt;/key&gt;
    &lt;array&gt;
        &lt;string&gt;bluetooth-peripheral&lt;/string&gt;
        &lt;string&gt;bluetooth-central&lt;/string&gt;
        &lt;string&gt;fetch&lt;/string&gt;
        &lt;string&gt;processing&lt;/string&gt;
        &lt;string&gt;audio&lt;/string&gt;
        &lt;string&gt;voip&lt;/string&gt;
        &lt;string&gt;remote-notification&lt;/string&gt;
    &lt;/array&gt;
</code></pre>

<blockquote>
  <p><i class="fa fa-hand-o-right" style="color:#FF0000;"></i> <strong>See <a href="../ws101_badge">WS101 Programmer's Guide for Android</a></strong></p>
</blockquote>

<hr>

<h4 id="whatisscoaudio" class="anchor"><a class="heading-anchor" href="#whatisscoaudio"><span></span></a>What is SCO Audio?</h4>

<p>Synchronous Connection-oriented (SCO) Audio is a Bluetooth protocol designed for usage scenarios that can benefit from low-latency communications, such as those for voice. SCO Audio delivers its payload with less delay than other protocols by using reserved time slots. The trade-off is lower bandwidth, making SCO Audio unsuitable for music streaming and other high-fidelity audio content. </p>

<hr>

<h3 id="ws101seriescontrols" class="anchor"><a class="heading-anchor" href="#ws101seriescontrols"><span></span></a>WS101 Series Controls</h3>

<h4 id="frontview" class="anchor"><a class="heading-anchor" href="#frontview"><span></span></a>Front View</h4>

<p><img style="height:350px" src="ws101-front.jpg">
<br></p>

<table class="facelift" align="center" style="width:80%" border="1" padding="5px">
<tbody><tr bgcolor="#dce8ef">
</tr></tbody></table><table class="table table-striped">

<tbody><tr>
<th></th>
<th>Control</th>
<th>Description</th>
</tr>

<tr>
<td>1</td>
<td><b>Microphone</b></td>
<td>Captures voice and ambient sounds.</td>
</tr>

<tr>
<td>2</td>
<td><b>Badge clip tower bar</b></td>
<td>Enables the attachment of a lanyard and/or badge clip.</td>
</tr>

<tr>
<td>3</td>
<td><b>Power</b></td>
<td>Performs multiple functions:<br><b>Power</b>: Press and hold to turn device on or off. Device enters pairing mode each time it's turned on.<br><b>Pairing</b>: Hold to re-enter pairing mode after device has been powered up.<br><b>Incoming call</b>: Press once to answer; press twice to reject. <b>On a call</b>: Press twice to hang up.</td>
</tr>

<tr>
<td>4</td>
<td><b>P1 programmable button</b></td>
<td>Sends an event to a registered app (unprogrammed by default). Zebra recommends programming this button for push-to-talk function.</td>
</tr>

<tr>
<td>5</td>
<td><b>LED ring</b></td>
<td>Multi-colored visual indicator for multiple functions, including <b>pairing, battery charging and level, incoming call, call on hold</b>.</td>
</tr>

</tbody></table>


<hr>

<h4 id="sideviews" class="anchor"><a class="heading-anchor" href="#sideviews"><span></span></a>Side Views</h4>

<p><img style="height:350px" src="ws101_sides.jpg">
<br></p>

<table class="facelift" align="center" style="width:80%" border="1" padding="5px">
<tbody><tr bgcolor="#dce8ef">
</tr></tbody></table><table class="table table-striped">

<tbody><tr>
<th></th>
<th>Control</th>
<th>Description</th>
</tr>

<tr>
<td>1</td>
<td><b>Volume up/down</b></td>
<td>Adjusts volume of the device speaker or call volume for headset.</td>
</tr>

<tr>
<td>2</td>
<td><b>P2 programmable button</b></td>
<td>Sends an event to a registered app. By default, mutes/unmutes the mic during calls.</td>
</tr>

<tr>
<td>3</td>
<td><b>Barcode</b></td>
<td>Enables the "scan-to-pair" Bluetooth function.</td>
</tr>

<tr>
<td>4</td>
<td><b>NFC "N-Mark"</b></td>
<td>Location for the "tap-to-pair" Bluetooth function.</td>
</tr>

</tbody></table>


<hr>

<h4 id="topview" class="anchor"><a class="heading-anchor" href="#topview"><span></span></a>Top View</h4>

<p><img style="height:300px" src="ws101_top.jpg">
<br></p>

<table class="facelift" align="center" style="width:80%" border="1" padding="5px">
<tbody><tr bgcolor="#dce8ef">
</tr></tbody></table><table class="table table-striped">

<tbody><tr>
<th></th>
<th>Control</th>
<th>Description</th>
</tr>

<tr>
<td>1</td>
<td><b>3.5mm audio jack*</b></td>
<td>Input for headphones or headset; supports push-to-talk functions.</td>
</tr>

<tr>
<td>2</td>
<td><b>Top LED</b></td>
<td>Visual status indicator for incoming calls, call on hold.</td>
</tr>

<tr>
<td>3</td>
<td><b>Speaker</b></td>
<td>Projects audio upward, toward device user.</td>
</tr>

<tr>
<td>4</td>
<td><b>P3 programmable button (red)</b></td>
<td>Sends an event to a registered app (unprogrammed by default).</td>
</tr>

</tbody></table>


<p>* <i><font size="2" color="DimGrey"> Feature not present on "-H" (blue) models.</font></i> </p>

<hr>

<h2 id="installation" class="anchor"><a class="heading-anchor" href="#installation"><span></span></a>Installation</h2>

<h3 id="stepiaddzebraaudioconnectsdk" class="anchor"><a class="heading-anchor" href="#stepiaddzebraaudioconnectsdk"><span></span></a>Step I. Add Zebra AudioConnect SDK</h3>

<ol>
<li><p>Drag and drop <code>project.ZebraAudioConnectSDK.xcframework</code> into the project.</p></li>

<li><p>Go to <strong>Project &gt; General &gt; Frameworks, <code>Libraries, and Embedded Content</code></strong> <code>&lt;&lt;&lt; is "LIBRARIES, AND EMBEDDED CONTENT" one thing?</code></p></li>

<li><p><code>Set it to</code> <strong>Embed &gt; Sign</strong>  <code>&lt;&lt;&lt; WHAT IS "IT" REFERRING TO???</code></p></li>

<li><p>If an error appears relating to the <code>plist</code>, perform the following:<br> 
&nbsp;&nbsp;&nbsp; a. Go to target Build Phases<br>
&nbsp;&nbsp;&nbsp; b. Expand "Copy Bundle Resources" (see image, below)<br> 
&nbsp;&nbsp;&nbsp; c. Select <code>Info.plist</code> from the list and remove it using the minus ("-") button:
<img alt="image" style="height:150px" src="iOS_step01.jpg">
<em>Click image to enlarge; ESC to exit</em>.
<br></p></li>
</ol>

<hr>

<h3 id="stepiiinitializeblemanager" class="anchor"><a class="heading-anchor" href="#stepiiinitializeblemanager"><span></span></a>Step II. Initialize BLE Manager</h3>

<p><strong>1. Import the SDK</strong> in ViewController: </p>

<pre class="prettyprint"><code>    
    import ZebraAudioConnectSDK 
</code></pre>

<p><strong>2. Create an instance</strong> of <code>BLEmanager</code> and assign the delegate:</p>

<pre class="prettyprint"><code>    
    class ViewController: UIViewController, BLEManagerDelegate { 
        var bleManager: BLEManager?
        override func viewDidLoad() {
            super.viewDidLoad()
            bleManager = BLEManager()
            bleManager?.delegate = self
        }
    }
</code></pre>

<hr>

<h3 id="stepiiiimplementdelegatemethods" class="anchor"><a class="heading-anchor" href="#stepiiiimplementdelegatemethods"><span></span></a>Step III. Implement Delegate Methods</h3>

<p>The <code>BLEManagerDelegate</code> methods allow the app to receive real-time events from the BLE device. Supported methods are shown below. </p>

<table class="facelift" align="center" style="width:80%" border="1" padding="5px">
<tbody><tr bgcolor="#dce8ef">
</tr></tbody></table><table class="table table-striped">
 <tbody><tr>
<th>Delegate Method</th>
<th>Description</th>
</tr>

<tr>
<td><b>func </b><code>didDetectButtonEvent (button: ZWAButton, state: ButtonState)</code></td>
<td>Triggered when a button event occurs. Provides details about the button involved (e.g. PTT, DND, DURESS) and its current state (e.g., pressed, released, long-pressed).</td>
</tr>

<tr>
<td><b>func </b><code>didDetectVoiceTrigger (triggerType: VoiceTriggerType)</code></td>
<td>Called when a voice trigger is detected. Provides details about the type of voice command that was recognized, such as a Wake Word or Duress Word.</td>
</tr>

<tr>
<td><b>func </b><code>deviceDidConnect (device: ZWABluetoothDevice)</code></td>
<td>Called when a Zebra WS101 device successfully connects. Passes the <code>ZWABluetooth</code> object, which includes device name, connection status, and type (e.g. <code>hDeviceBLE</code>)</td>
</tr>

<tr>
<td><b>func </b><code>ZWAdeviceDidDisconnect (device: ZWABluetoothDevice, reason: DisconnectReareason)</code></td>
<td>Called when a device disconnects. Provides the <code>ZWABluetoothDevice</code> object with device details and a <code>DisconnectReason</code> to explain why disconnection occurred.</td>
</tr>

</tbody></table>


<h4 id="exampledelegatemethod" class="anchor"><a class="heading-anchor" href="#exampledelegatemethod"><span></span></a>Example Delegate Method</h4>

<pre class="prettyprint"><code>
func didDetectButtonEvent(button: ZebraAudioConnectSDK.ZWAButton, state: ZebraAudioConnectSDK.ButtonState) {
    switch button {
        case .p1:
                print("P1 button \(state)")
        case .p2:
                print("P2 button \(state)")
        case .p3:
                print("P3 button \(state)")
        @unknown default:
                print("Unknown Button Detected")    
    }
}

func didDetectVoiceTrigger(triggerType: ZebraAudioConnectSDK.VoiceTriggerType) {
        switch triggerType {
        case .wakeWord:
            print("Wakeword Voice Trigger Detected")
        case .duressWord:
            print("Duressword Voice Trigger Detected")
        @unknown default:
            print("Unknown Voice Trigger Detected")        
    }
}

func deviceDidConnect(device: ZebraAudioConnectSDK.ZWABluetoothDevice) {
        print("Model Name: \(device.name)")
}

func deviceDidDisconnect(device: ZebraAudioConnectSDK.ZWABluetoothDevice, reason: ZebraAudioConnectSDK.DisconnectReason) {
        print("Device Disconnected - Name: \(device.name) Reason: \(reason)")
}
</code></pre>

<hr>

<h3 id="stepivstaterestorationsupport" class="anchor"><a class="heading-anchor" href="#stepivstaterestorationsupport"><span></span></a>Step IV. State Restoration Support</h3>

<p>The SDK retains state information from previous connections and can reconnect to previously connected devices automatically when the app is subsequently launched or termination. </p>

<h4 id="backgroundmodesupport" class="anchor"><a class="heading-anchor" href="#backgroundmodesupport"><span></span></a>Background Mode Support</h4>

<p>To receive BLE events in the background:</p>

<ul>
<li>Ensure <code>bluetooth-central</code> is enabled in <strong>Background Modes</strong>.</li>

<li>Avoid blocking main thread operations inside delegate methods.</li>
</ul>

<hr>

<h3 id="stepvtestingtheintegration" class="anchor"><a class="heading-anchor" href="#stepvtestingtheintegration"><span></span></a>Step V. Testing the Integration</h3>

<p>Zebra recommends following the procedures listed below to test the app. </p>

<p><i class="fa fa-exclamation-circle" style="color:#FF0000;"></i> <strong>NOTE</strong>: Testing must be done on physical devices; BLE does not support simulation.</p>

<ol>
<li><strong>Ensure that a BLE audio device (e.g., WS101) is nearby</strong>, powered up and connected to the host device.</li>

<li><strong>Trigger actions</strong> (P1, P2 and P3 button events, and Duress and Wake Word voice triggers) and confirm callbacks are received.</li>

<li><strong>Press and hold P1</strong>; an audio recording should begin.</li>

<li><strong>Release P1</strong>; the recording should stop.</li>

<li><strong>Press and release P2</strong>; the last-saved audio recording should play.</li>

<li><strong>Speak the wake word</strong> to determine whether the WS101 badge detects the word and wakes. </li>

<li><strong>Speak the command "Start recording on SDK tester"</strong> to verify that the app records audio for 10 seconds.</li>

<li><strong>Speak the Wake Word</strong> to wake the device. </li>

<li><strong>Speak the command "Play the recording of SDK tester"</strong> to verify that the app plays back the last saved audio recording.</li>

<li><strong>Long-press P3</strong> (Duress) button for at least three (3) seconds to verify that the app immediately displays an incoming call screen to simulate a "Duress Call" and provides a pretext for the user to leave a situation. </li>

<li><strong>Speak the Duress Wake Word</strong> to verify that the app immediately displays the same incoming test call screen.</li>
</ol>

<hr>

<h2 id="datastructures" class="anchor"><a class="heading-anchor" href="#datastructures"><span></span></a>Data Structures</h2>

<h3 id="buttoneventlistener" class="anchor"><a class="heading-anchor" href="#buttoneventlistener"><span></span></a>Button Event Listener</h3>

<pre class="prettyprint"><code>
public protocol BLEManagerDelegate: AnyObject {
    func didDetectButtonEvent(button: ZWAButton, state: ButtonState)
}

public enum ZWAButton {
    case p1 //Programmable Button 1
    case p2 //Programmable Button 2
    case p3 //Programmable Button 3
}

public enum ButtonState {
    case press          // Button pressed down
    case release        // Button released
    case longPress      // Button held down for longer than 1 second
}
</code></pre>

<h3 id="connectioneventlistenerinterface" class="anchor"><a class="heading-anchor" href="#connectioneventlistenerinterface"><span></span></a>Connection Event Listener Interface</h3>

<pre class="prettyprint"><code>
public protocol BLEManagerDelegate: AnyObject {
    func systemConnectedDeviceStatus(isConnected: Bool)
    func deviceDidConnect(device: ZWABluetoothDevice)
    func deviceDidDisconnect(device: ZWABluetoothDevice, reason: DisconnectReason)
}

public struct ZWABluetoothDevice {
    public var name: String           // Device name (e.g., "Zebra WS101")
    public var isConnected: Bool      // Current connection status
    public var deviceType: DeviceType // BLE

    public init(name: String, isConnected: Bool, deviceType: DeviceType) {
        self.name = name
        self.isConnected = isConnected
        self.deviceType = deviceType
    }
}

public enum DeviceType {
    case ble
    case classic
}

public enum DisconnectReason {
    case connectionFailed
    case unknownError
    case bluetoothDisabled
}
</code></pre>

<h3 id="voicetriggerlistenerinterface" class="anchor"><a class="heading-anchor" href="#voicetriggerlistenerinterface"><span></span></a>Voice Trigger Listener Interface</h3>

<pre class="prettyprint"><code>
public protocol BLEManagerDelegate: AnyObject {
    func didDetectVoiceTrigger(triggerType: VoiceTriggerType)
}

public enum VoiceTriggerType {
    case wakeWord
    case duressWord
}
</code></pre>

<p><strong>Wakeup Word</strong>: Triggers app-defined actions (e.g. launch a voice assistant app).
<strong>Duress Word</strong>: Triggers actions associated with Duress word</p>

<hr>

<h2 id="internalsdkbehavior" class="anchor"><a class="heading-anchor" href="#internalsdkbehavior"><span></span></a>Internal SDK Behavior</h2>

<h3 id="bluetoothhandling" class="anchor"><a class="heading-anchor" href="#bluetoothhandling"><span></span></a>Bluetooth Handling</h3>

<ul>
<li>The SDK automatically manages Bluetooth connections. </li>

<li>A device actively connected with audio from system settings automatically connects from the client app.</li>

<li>Once a Zebra WS101 device is connected, button events and voice triggers start streaming, provided the device was configured to send SDK events on button and voice triggers using the Bluetooth Comms Utility.</li>

<li>No explicit handling is required by the client app.</li>
</ul>

<h3 id="wakeandduresswordprocessing" class="anchor"><a class="heading-anchor" href="#wakeandduresswordprocessing"><span></span></a>Wake and Duress Word Processing</h3>

<ul>
<li>The SDK listens for predefined events when a voice trigger is detected on the Bluetooth device.</li>

<li>Wakeup Duress words can be used to trigger actions defined by the app or a customer.</li>
</ul>

<hr>

<h2 id="usageexample" class="anchor"><a class="heading-anchor" href="#usageexample"><span></span></a>Usage Example</h2>

<h5 id="descriptionofapprequiredhere" class="anchor"><a class="heading-anchor" href="#descriptionofapprequiredhere"><span></span></a><code>description of app required here</code></h5>

<pre class="prettyprint"><code>
import UIKit
import ZebraAudioConnectSDK
import AVFoundation

class ViewController: UIViewController, BLEManagerDelegate, UITableViewDataSource, UITableViewDelegate {

    var bleManager: BLEManager?
    @IBOutlet weak var sdkVersionLabel: UILabel!
    @IBOutlet weak var tableView: UITableView!

    private var messages: [String] = []

    override func viewDidLoad() {
        super.viewDidLoad()

        bleManager = BLEManager()
        bleManager?.delegate = self

        tableView.dataSource = self
        tableView.delegate = self

        // Get and display the SDK version
        if let sdkVersion = bleManager?.getSDKVersion() {
            sdkVersionLabel.text = "SDK Version: \(sdkVersion)"
        }

        tableView.register(UITableViewCell.self, forCellReuseIdentifier: "MessageCell")
        NotificationCenter.default.addObserver(
            self,
            selector: #selector(appWillEnterForeground),
            name: UIApplication.willEnterForegroundNotification,
            object: nil
        )
        NotificationCenter.default.addObserver(
            self,
            selector: #selector(handleAudioRouteChange),
            name: AVAudioSession.routeChangeNotification,
            object: nil
        )
    }

    deinit {
        NotificationCenter.default.removeObserver(self, name: UIApplication.willEnterForegroundNotification, object: nil)
        NotificationCenter.default.removeObserver(self, name: AVAudioSession.routeChangeNotification, object: nil)
    }

    @objc private func appWillEnterForeground() {
        if bleManager == nil {
            bleManager = BLEManager()
            bleManager?.delegate = self
            print("BLEManager initialized")
        } else {
            print("BLEManager already exists")
        }
        bleManager?.getSystemConnectedDeviceStatus()
    }

    func systemConnectedDeviceStatus(isConnected: Bool) {
        if !isConnected{
            self.updateMessages(with: "Ensure the BT device is turned on and connected to the host via System Settings.")
        }
    }

    func didDetectButtonEvent(button: ZebraAudioConnectSDK.ZWAButton, state: ZebraAudioConnectSDK.ButtonState) {
        switch button {
        case .p1:
            self.updateMessages(with: "P1 button \(state)")
        case .p2:
            self.updateMessages(with: "P2 button \(state)")
        case .p3:
            self.updateMessages(with: "P3 button \(state)")
        }
    }

    func didDetectVoiceTrigger(triggerType: ZebraAudioConnectSDK.VoiceTriggerType) {
        switch triggerType {
        case .wakeWord:
            self.updateMessages(with: "Wakeword Voice Trigger Detected")
        case .duressWord:
            self.updateMessages(with: "Duressword Voice Trigger Detected")
        @unknown default:
            self.updateMessages(with: "Unknown Voice Trigger Detected")
        }
    }

    func deviceDidConnect(device: ZebraAudioConnectSDK.ZWABluetoothDevice) {
        self.updateMessages(with: "Device Connected - Name: \(device.name)")
    }

    func deviceDidDisconnect(device: ZebraAudioConnectSDK.ZWABluetoothDevice, reason: ZebraAudioConnectSDK.DisconnectReason) {
        self.updateMessages(with: "Device Disconnected - Name: \(device.name) Reason: \(reason)")
    }

    private func updateMessages(with newText: String) {
        DispatchQueue.main.async { [weak self] in
            guard let self = self else { return }
            self.messages.append(newText)
            self.tableView.reloadData()
        }
    }

    // MARK: - UITableViewDataSource

    func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -&gt; Int {
        return messages.count
    }

    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -&gt; UITableViewCell {
        let cell = tableView.dequeueReusableCell(withIdentifier: "MessageCell", for: indexPath)
        cell.textLabel?.text = messages[indexPath.row]
        cell.textLabel?.numberOfLines = 0
        return cell
    }

    @objc func handleAudioRouteChange(notification: Notification) {
        guard let userInfo = notification.userInfo,
              let reasonValue = userInfo[AVAudioSessionRouteChangeReasonKey] as? UInt,
              let reason = AVAudioSession.RouteChangeReason(rawValue: reasonValue) else {
            return
        }

        switch reason {
        case .newDeviceAvailable:
            bleManager?.getSystemConnectedDeviceStatus()
            bleManager?.startScanning()
        case .oldDeviceUnavailable:
            if let previousRoute = userInfo[AVAudioSessionRouteChangePreviousRouteKey] as? AVAudioSessionRouteDescription {
                for output in previousRoute.outputs {
                    print("Disconnected device: \(output.portName)")
                    bleManager?.disconnectActiveDevice(named: output.portName)
                }
            }
            bleManager?.startScanning()
        case .categoryChange: break
        case .routeConfigurationChange: break
        default: break
        }
    }
}
</code></pre>

<hr>

<h2 id="physicalbuttoncontrol" class="anchor"><a class="heading-anchor" href="#physicalbuttoncontrol"><span></span></a>Physical Button Control</h2>

<p>This feature permits use of WS101 buttons to record and play audio when the app is open on the screen.</p>

<blockquote>
  <p><i class="fa fa-exclamation-triangle" style="color:#FFA500;"></i> Button actions work only when the SDKTester app is in the foreground.</p>
</blockquote>

<h3 id="p1button" class="anchor"><a class="heading-anchor" href="#p1button"><span></span></a>P1 Button</h3>

<ul>
<li>Long-press to start Recording: 


<ul>
<li>Press and hold the P1 button to start recording audio</li>

<li>Release to stop and save recording </li></ul>
</li>
</ul>

<h3 id="p2button" class="anchor"><a class="heading-anchor" href="#p2button"><span></span></a>P2 Button</h3>

<ul>
<li>Press to play last recording: 


<ul>
<li>Press the P2 button to play the most recent recording</li></ul>
</li>
</ul>

<hr>

<h2 id="siriusageexample" class="anchor"><a class="heading-anchor" href="#siriusageexample"><span></span></a>Siri Usage Example</h2>

<h3 id="startrecordingintentappintent" class="anchor"><a class="heading-anchor" href="#startrecordingintentappintent"><span></span></a>StartRecordingIntent AppIntent</h3>

<pre class="prettyprint"><code>
struct StartRecordingIntent: AppIntent {
    static var title = "Start Recording"
    static var openAppWhenRun = true
@MainActor
func perform() async throws -&gt; some IntentResult {
    NotificationCenter.default.post(name: .startRecording, object: nil)
    return .result()
    }
}
</code></pre>

<ol>
<li>User speaks the <code>"standard" wake word &gt;&gt; THIS IS NOT DEFINED ANYWHERE</code> (detected by the WS101 badge hardware).</li>

<li>User then says "Start recording on SDK Tester." </li>

<li>Siri runs this intent.</li>

<li>The intent sends a small message to the app using NotificationCenter.</li>

<li>The app listens for this notification and starts a 10-second recording using the Audio Manager.</li>
</ol>

<hr>

<h3 id="playrecordingintentappintent" class="anchor"><a class="heading-anchor" href="#playrecordingintentappintent"><span></span></a>PlayRecordingIntent AppIntent</h3>

<pre class="prettyprint"><code>
struct PlayRecordingIntent: AppIntent {
    static var title = "Play Recording"
    static var openAppWhenRun = true
@MainActor
func perform() async throws -&gt; some IntentResult {
    NotificationCenter.default.post(name: .playRecording, object: nil)
    return .result()
    }
}
</code></pre>

<ol>
<li>User speaks wake word.</li>

<li>User then says "Play recording on SDK Tester." </li>

<li>Siri runs this intent.</li>

<li>The intent sends a small message to the app using NotificationCenter.</li>

<li>App receives message and starts playing the latest saved recording.</li>
</ol>

<hr>

<h3 id="sdktesterappshortcutsappshortcutsprovider" class="anchor"><a class="heading-anchor" href="#sdktesterappshortcutsappshortcutsprovider"><span></span></a>SDKTesterAppShortcuts AppShortcutsProvider</h3>

<p>The app uses an AppShortcutsProvider to register voice commands that Siri can recognize. This makes it easy for the user to start recording or playing saved audio using natural phrases. The shortcuts help Siri understand multiple ways of saying the command.</p>

<pre class="prettyprint"><code>
import AppIntents
struct SDKTesterAppShortcuts: AppShortcutsProvider {
    static var shortcutTileColor: ShortcutTileColor = .lightBlue
    @AppShortcutsBuilder
    static var appShortcuts: [AppShortcut] {
        // Start Recording Shortcut
        AppShortcut(
            intent: StartRecordingIntent(),
            phrases: [
                "Start recording on \(.applicationName)",
                "Start recording in \(.applicationName)",
                "Record audio in \(.applicationName)"
            ],
            shortTitle: LocalizedStringResource(stringLiteral: "Record"),
            systemImageName: "record.circle.fill"
        )
        // Play Recording Shortcut
        AppShortcut(
            intent: PlayRecordingIntent(),
            phrases: [
                "Play recording on \(.applicationName)",
                "Play recording in \(.applicationName)",
                "Play last recording in \(.applicationName)"
            ],
            shortTitle: LocalizedStringResource(stringLiteral: "Play"),
            systemImageName: "play.circle.fill"
        )
    }
</code></pre>

<h4 id="startrecordingshortcuts" class="anchor"><a class="heading-anchor" href="#startrecordingshortcuts"><span></span></a>Start Recording Shortcuts</h4>

<ul>
<li>These phrases allow Siri to start a 10-second recording and are linked to <code>StartRecordingIntent</code>: 


<ul>
<li>“Start recording in SDKTester”</li>

<li>“Start recording on SDKTester”</li>

<li>“Record audio in SDKTester”</li></ul>
</li>
</ul>

<h4 id="playrecordingshortcuts" class="anchor"><a class="heading-anchor" href="#playrecordingshortcuts"><span></span></a>Play Recording Shortcuts</h4>

<ul>
<li>These phrases allow Siri to play the most recent audio clip and are linked to <code>PlayRecordingIntent</code>:


<ul>
<li>“Play recording on SDKTester”</li>

<li>“Play recording in SDKTester”</li>

<li>“Play last recording in SDKTester”</li></ul>
</li>
</ul>

<hr>

<h2 id="callkitusageexample" class="anchor"><a class="heading-anchor" href="#callkitusageexample"><span></span></a>CallKit Usage Example</h2>

<pre class="prettyprint"><code>
// MARK: - CallKit Setup &amp; Handling

extension ViewController: CXProviderDelegate {

    func setupCallKit() {
        let providerConfiguration = CXProviderConfiguration(localizedName: "Duress Call")
        providerConfiguration.supportsVideo = false
        providerConfiguration.maximumCallsPerCallGroup = 1
        providerConfiguration.supportedHandleTypes = [.generic]

        callProvider = CXProvider(configuration: providerConfiguration)
        callProvider?.setDelegate(self, queue: nil)
    }

    /// Entry point when wakeword detected in background – shows an incoming call UI
    func handleWakewordDetected() {
        appendMessage("Wakeword detected. Initiating VoIP call...")

        // Generate a unique call UUID
        let uuid = UUID()
        currentCallUUID = uuid

        let update = CXCallUpdate()
        update.remoteHandle = CXHandle(type: .generic, value: "Duress Call")
        update.hasVideo = false

        callProvider?.reportNewIncomingCall(with: uuid, update: update) { [weak self] error in
            if let error = error {
                self?.appendMessage("Failed to report incoming call: \(error.localizedDescription)")
            } else {
                self?.appendMessage("Incoming call reported successfully.")
            }
        }
    }

    func endCall(uuid: UUID) {
        let endCallAction = CXEndCallAction(call: uuid)
        let transaction = CXTransaction(action: endCallAction)

        callController.request(transaction) { [weak self] error in
            if let error = error {
                print("Failed to end call: \(error.localizedDescription)")
            } else {
                DispatchQueue.main.asyncAfter(deadline: .now() + 0.5) {
                    self?.startAutoRecordingForWakeword()
                }
                print("Call ended successfully.")
            }
        }
    }

    // MARK: - CXProviderDelegate

    func provider(_ provider: CXProvider, perform action: CXAnswerCallAction) {
        appendMessage("Call accepted. Starting recording...")
        isCallAccept = true
        if UIApplication.shared.applicationState == .active {
            if isCallAccept {
                if let callUUID = currentCallUUID {
                    endCall(uuid: callUUID)
                }
                isCallAccept = false
            }
        }
        action.fulfill()
    }

    func provider(_ provider: CXProvider, perform action: CXEndCallAction) {
        appendMessage("Call ended.")
        isCallAccept = false
        action.fulfill()
    }

    func providerDidReset(_ provider: CXProvider) {
        appendMessage("Call provider has been reset.")

        // Clean up any ongoing call-related resources
        stopRecordingIfNeeded()
        currentCallUUID = nil
    }
}

// MARK: - VoIP Setup
extension ViewController: PKPushRegistryDelegate {
    func setupVoIP() {
        voipRegistry = PKPushRegistry(queue: .main)
        voipRegistry?.delegate = self
        voipRegistry?.desiredPushTypes = [.voIP]
    }
    func pushRegistry(_ registry: PKPushRegistry,
                      didUpdate pushCredentials: PKPushCredentials,
                      for type: PKPushType) {
        appendMessage("VoIP push credentials updated.")
        // Send the credentials to your server for push notifications
    }
    func pushRegistry(_ registry: PKPushRegistry,
                      didReceiveIncomingPushWith payload: PKPushPayload,
                      for type: PKPushType,
                      completion: @escaping () -&gt; Void) {
        appendMessage("Received VoIP push notification.")
        handleWakewordDetected()
        completion()
    }
}
</code></pre>

<h4 id="duresspanicfeature" class="anchor"><a class="heading-anchor" href="#duresspanicfeature"><span></span></a>Duress/Panic Feature</h4>

<p>If the app is in the foreground or background, the user can long-press the P3 button to initialize a call. Once <code>the user -- DO YOU MEAN "CALL RECIENT"?</code> accepts the call, recording will start. </p>

<p>Releasing the P3 button stops the recording.</p>

<p><i class="fa fa-exclamation-triangle" style="color:#FFA500;"></i> If a call is triggered by a duress word voice event, the recording stops automatically after 5 seconds.</p>

<h2 id="endendend" class="anchor"><a class="heading-anchor" href="#endendend"><span></span></a><code>END END END</code></h2>

<!--

**&#49;. Copy** `libs/zebra-audio-connect-sdk-release.aar` to the `app/libs/` directory.

**&#50;. Modify** `settings.gradle` to include:

            :::XML
            dependencyResolutionManagement {
                repositories {
                flatDir { dirs 'libs' }
                // ... other repos
                }
            }

**&#51;. Modify** `app/build.gradle` to include:

        :::XML
        implementation files('libs/zebra-audio-connect-sdk-release.aar')

> <i class="fa fa-exclamation-triangle" style="color:#FFA500;"></i> If the app is to enable R8 (formerly ProGuard) minification `(minifyEnabled = true)`, the consumer [R8 Rules](#r8rules) (below) also must be included.

-----

## Permissions

The SDK does not request permissions automatically. The app must declare and request them as below. 

### Manifest entries

        // Bluetooth Classic and SCO 
        <uses-permission android:name="android.permission.BLUETOOTH" />
        <uses-permission android:name="android.permission.BLUETOOTH_ADMIN" />

        // Android 12+ Bluetooth control 
        <uses-permission android:name="android.permission.BLUETOOTH_CONNECT" />
        <uses-permission android:name="android.permission.BLUETOOTH_SCAN" />

        // Microphone for SCO audio capture
        <uses-permission android:name="android.permission.RECORD_AUDIO" />

### Runtime requests (example)

        // Permissions array
        private val requiredPermissions = arrayOf(
            Manifest.permission.RECORD_AUDIO,
            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.S) {
                Manifest.permission.BLUETOOTH_CONNECT,
             Manifest.permission.BLUETOOTH_SCAN
         } else {
             Manifest.permission.BLUETOOTH,
             Manifest.permission.BLUETOOTH_ADMIN
         }
        )

        // Launcher
        private val permLauncher = registerForActivityResult(
            ActivityResultContracts.RequestMultiplePermissions()
        ) { results ->
            if (results.values.all { it }) initSdk() else onPermsDenied()
        }

        // In Activity.onCreate():
        if (hasAllPermissions()) initSdk() else
        permLauncher.launch(requiredPermissions)

-----

## Data Structures

### Button Event Listener:

        :::java
        interface ZWAButtonEventListener {
            fun onButtonEvent(button: ZWAButton, state: ButtonState)
        }
        enum class ZWAButton {
            P1,     //Programmable button 1
            P2,     //Programmable button 2
            P3      //Programmable button 3
        }
        enum class ButtonState {
            PRESS,      // Button pressed down
            RELEASE,    // Button released
            LONG_PRESS  // Button held down for longer than one (1) second
        }

<img alt="image" style="height:400px" src="ws101_key_IDs.jpg"/>
_WS101 and WS101-H programmable button identifiers_.<br>
_Click image to enlarge; ESC to exit_.
<br>

### Connection Event Listener Interface:

        :::java
        interface ZWAConnectionListener {
            fun onDeviceConnected(device: ZWABluetoothDevice)
            fun onDeviceDisconnected(device: ZWABluetoothDevice)
        }
        data class ZWABluetoothDevice(
            val name: String,           // Device name (e.g., "Zebra WS101")
            val address: String,        // Bluetooth MAC address("00:11:22:33:AA:BB")
            val deviceType: DeviceType, // CLASSIC or BLE
            val isConnected: Boolean    // Current connection status
        )
        enum class DeviceType {
            CLASSIC,
            BLE
        }

### Voice Trigger Listener Interface:

        :::java
        interface ZWAVoiceTriggerListener {
            fun onVoiceTriggerDetected(triggerType: VoiceTriggerType)
        }
        enum class VoiceTriggerType {
            WAKE_WORD,
            DURESS_WORD
        }


* **WAKE_WORD**: Triggers app-defined actions, such as launching a voice assistant app.
* **DURESS_WORD**: Triggers app-defined actions, such calling for emergency services.

### SCO Connection Listener Interface:

        :::java
        interface ScoConnectionListener {
            fun onScoStarted()
            fun onScoFailed(error: ScoError)
        }
        enum class ScoError {
            BLUETOOTH_DISABLED,
            DISCONNECTED,
            UNKNOWN_ERROR
        }

-----

## Initialization

### Application-level:

Recommended for apps that can declare manifest permissions ahead of runtime.

        :::java
    class MyApp : Application() {
        override fun onCreate() {
            super.onCreate()
            ZebraAudioConnectSDK.initialize(
                this,
                setOf(
                    ZebraAudioConnectSDK.Module.BUTTONS,
                    ZebraAudioConnectSDK.Module.VOICE,
                    ZebraAudioConnectSDK.Module.CONNECTION,
                    ZebraAudioConnectSDK.Module.SCO
         )
       )
    }
        override fun onTerminate() {
            ZebraAudioConnectSDK.shutdown()
            super.onTerminate()
        }
    }


### Activity-level (after permissions):

        :::java
        fun initSdk() {
            ZebraAudioConnectSDK.initialize(
                applicationContext,
                setOf(
                    ZebraAudioConnectSDK.Module.BUTTONS,
                    ZebraAudioConnectSDK.Module.VOICE,
                    ZebraAudioConnectSDK.Module.CONNECTION,
                    ZebraAudioConnectSDK.Module.SCO
            )
        )
        versionTextView.text = "SDK v${ZebraAudioConnectSDK.getVersion()}"
    }

<a id="r8rules"></a>

### R8 Rules:
Required only if the consuming app enables `minifyEnabled = true`.

Add these lines to the R8 (formerly ProGuard) configuration (e.g. in consumer-rules.pro):

        :::java
        # Keep all SDK classes and members
        -keep class com.zebra.audio.connect.sdk.** { *; }

        # Keep enum values for correct dispatch in listeners
        -keepclassmembers enum com.zebra.audio.connect.sdk.** { *; }

        # Ensure the module’s build.gradle already references this file:
        android {
        defaultConfig {

        // ...
        consumerProguardFiles("consumer-rules.pro")
        }
        buildTypes {
        release {
            isMinifyEnabled = true
            proguardFiles(
                getDefaultProguardFile("proguard-android-optimize.txt"),
                "proguard-rules.pro"
        )
        consumerProguardFiles("consumer-rules.pro")
                }
           }
        }    


-----

## Public API

        :::java
        // Version
        val sdkVersion = ZebraAudioConnectSDK.getVersion()        

        // Listeners
        ZebraAudioConnectSDK.setButtonEventListener { button, state -> /* ... */ }
        ZebraAudioConnectSDK.setVoiceTriggerListener { triggerType -> /* ... */ }
        ZebraAudioConnectSDK.setConnectionListener(object : ZWAConnectionListener {
            override fun onDeviceConnected(device: ZWABluetoothDevice) { /* ... */ }
            override fun onDeviceDisconnected(device: ZWABluetoothDevice, reason:
        DisconnectReason) { /* ... */ }
        })
        ZebraAudioConnectSDK.setScoListener(object : ScoConnectionListener {
            override fun onScoStarted() = /* ... */
            override fun onScoFailed(error: ScoError) = /* ... */
        })

        // SCO control
        ZebraAudioConnectSDK.startScoConnection()
        ZebraAudioConnectSDK.stopScoConnection()

-----

## Usage Example (MainActivity)

        :::java
        class MainActivity : AppCompatActivity() {

        // UI elements
        private lateinit var btnRecord: Button
        private lateinit var btnPlay: Button
        private lateinit var txtLog: TextView
        private var isRecording = false
        private var isPlaying = false

        override fun onCreate(savedInstanceState: Bundle?) {
            super.onCreate(savedInstanceState)
            setContentView(R.layout.activity_main)

        // init views
        btnRecord = findViewById(R.id.btn_start_recording)
        btnPlay = findViewById(R.id.btn_playback)
        txtLog = findViewById(R.id.textLog)

        // permissions & SDK init
        if (hasAllPermissions()) initSdkAndListeners()
        else permLauncher.launch(requiredPermissions)
        updateUi()
        btnRecord.setOnClickListener {
        if (!isRecording) startScoAndRecord() else stopRecording()
        }
        btnPlay.setOnClickListener { if (!isPlaying) startPlayback() else
        stopPlayback() }
        }
        private fun initSdkAndListeners() {
        ZebraAudioConnectSDK.initialize(...)

        // Delay before recording to allow SCO setup
        val scoDelayMs = 50L // Adjust per device; can be 0-200 ms. See Best Practices and Error Handling (below)

        // Button events
        ZebraAudioConnectSDK.setButtonEventListener { btn, st -> log("Btn $btn →
        $st") }

        // Voice triggers
         ZebraAudioConnectSDK.setVoiceTriggerListener { tr -> log("Voice $tr") }

        // Connection events
        ZebraAudioConnectSDK.setConnectionListener(...)

        // SCO events
        ZebraAudioConnectSDK.setScoListener(...)
        }

        // ... record, playback, log, updateUi implementations ...
        }

-----

## Best Practices and Error Handling

* **SCO timing**: Establishing an SCO link is asynchronous and varies by hardware. After invoking `startScoConnection()`, a brief delay (typically 50–200 ms) before starting `MediaRecorder` ensures that the audio pipeline is ready, and avoids clipping. Test with target device to determine the optimal delay. **On Android 12 (and later)**, it's OK to proceed after receiving the "SCO Ready" event.
* **Permission denial**: Disable relevant UI `(btnRecord.isEnabled = false)` and
show guidance to the user.
* **ScoError cases**: `Handle ScoError.BLUETOOTH_DISABLED`, prompt user to enable
Bluetooth. Retry or abort gracefully.
* **Multi-app**: Initiate only one SCO session at a time. Use Android Audio Focus or custom
locking if multiple apps integrate the SDK.


<!-- replaced below with above, per eng.
* **SCO timing**: SCO link is asynchronous. Introduce a ~1 second delay before
starting `MediaRecorder` after `startScoConnection()`.
 -->

<hr>

<h2 id="multiappconsiderations" class="anchor"><a class="heading-anchor" href="#multiappconsiderations"><span></span></a>Multi-app Considerations</h2>

<ul>
<li><strong>Button/Voice events</strong>: Broadcast to all registered listeners across apps.</li>

<li><strong>SCO sessions</strong>: Only one active session is allowed at a time. Subsequent <code>startScoConnection()</code> calls fail; handle using <code>onScoFailed()</code>.</li>
</ul>

<hr>

<h2 id="frequentlyaskedquestions" class="anchor"><a class="heading-anchor" href="#frequentlyaskedquestions"><span></span></a>Frequently Asked Questions</h2>

<h3 id="whyisntthews101micworking" class="anchor"><a class="heading-anchor" href="#whyisntthews101micworking"><span></span></a>Why isn't the WS101 mic working?</h3>

<p><strong>The WS101 requires exclusive use of the microphone via Synchronous Connection-oriented (SCO) audio connection</strong> for voice capture. Some of the most common causes of mic failure are listed below. </p>

<h4 id="causesformicfailure" class="anchor"><a class="heading-anchor" href="#causesformicfailure"><span></span></a>Causes for mic failure:</h4>

<ul>
<li><strong>Wrong connection type</strong>: SCO requires the Bluetooth "Hands-free" or "Headset" profile to be active. <strong>The WS101 must be connected for "Phone calls" and "Media audio"</strong> in the Android System settings panel.</li>

<li><strong>Another app using the microphone</strong>: Only one app can use Bluetooth SCO audio at a time. <strong>Quit other app(s) that use the mic</strong> (e.g. phone dialer, voice recorder) before running yours.</li>

<li><strong>Missing permissions</strong>: If the device is running Android 12 or later, the problem could be that your app lacks special Bluetooth permissions required at runtime. </li>

<li><strong>Also see next question</strong>. </li>
</ul>

<hr>

<h3 id="whydoesntmyappworkonandroid12" class="anchor"><a class="heading-anchor" href="#whydoesntmyappworkonandroid12"><span></span></a>Why doesn't my app work on Android 12?</h3>

<p>In addition to a declaration in the app manifest (as indicated under <a href="#permissions">Permissions</a> above), <strong>devices running Android 12 (or later) enforce additional Bluetooth permissions that must be requested at runtime</strong>. Heightened security introduced with Android 12 requires that apps be granted permission for "Nearby devices" or "Bluetooth" when they start up. To address the issue, try the steps below: </p>

<ol>
<li>When the app first runs, grant the "Nearby devices" permission when prompted.</li>

<li>If previously denied, go to <strong>Settings &gt; Apps &gt; [Your App Name] &gt; Permissions</strong> and enable "Nearby devices."</li>

<li>Restart the app to activate the permission changes.</li>
</ol>

<p><i class="fa fa-exclamation-triangle" style="color:#FFA500;"></i> <strong>Lack of background permission also might be hindering the app</strong>. Try granting the app background permission if the issue persists. </p>

<hr>

<h3 id="whyisntmyappreceivingws101buttonpressesorwakewordevents" class="anchor"><a class="heading-anchor" href="#whyisntmyappreceivingws101buttonpressesorwakewordevents"><span></span></a>Why isn't my app receiving WS101 button presses or wake-word events?</h3>

<p><strong>Button presses and voice commands use the Bluetooth "Hands-free Profile" control channel</strong>, which is enabled only when Bluetooth is configured for audio <strong><em>and</em></strong> for calls. If the device is configured only for audio, the channel that carries button and voice signals is not available for your app to use. </p>

<h4 id="checkws101settings" class="anchor"><a class="heading-anchor" href="#checkws101settings"><span></span></a>Check WS101 settings:</h4>

<ol>
<li>Go to <strong>Settings &gt; Connections (or) Connected Devices*</strong> and look for a WS101 device.</li>

<li><strong>If there's none</strong>, tap "Pair new device" and/or follow the normal process for Bluetooth pairing.<br>
The message <strong>"Connected for Phone calls and Media audio"</strong> should appear.*  </li>

<li>Otherwise, <strong>tap the gear icon." The "Phone calls" and "Media audio" toggle controls should both be active</strong>. </li>
</ol>

<p><strong>*</strong> <i><font size="1" color="Grey">Exact processes and wording vary by Android version.</font></i></p>

<h4 id="otherthingstocheck" class="anchor"><a class="heading-anchor" href="#otherthingstocheck"><span></span></a>Other things to check:</h4>

<ul>
<li><strong>Pairing vs. Active Connection -</strong> Check that the device is not only paired but also <strong><em>connected</em></strong>.<br>
Previously paired (and remembered) devices don't always reconnect when a host device comes into range.</li>

<li><strong>Wrong button or voice trigger mappings -</strong> Zebra recommends using the <a href="linkToCome">Zebra Bluetooth Comms Utility</a> (coming soon) to create and verify button mappings to configure wake- and duress-word settings.</li>
</ul>

<hr>

<h3 id="canicheckwhetheraws101isconnectedbeforeinitializingthesdk" class="anchor"><a class="heading-anchor" href="#canicheckwhetheraws101isconnectedbeforeinitializingthesdk"><span></span></a>Can I check whether a WS101 is connected before initializing the SDK?</h3>

<p>Yes. The sample Java code below shows how to detect existing WS101 connections using Android Bluetooth APIs:</p>

<pre class="prettyprint"><code>    
    /**
     * Checks if any supported Zebra WS101 devices are currently connected
     * Supports device name matching ("ws101"), MAC prefix ("94:FB:29"),
     * or Zebra manufacturer ID filtering
     */
    @RequiresPermission(Manifest.permission.BLUETOOTH_CONNECT)
    private fun checkConnectedDevices(context: Context): Boolean {
        return try {
        val bluetoothAdapter = (context.getSystemService(BLUETOOTH_SERVICE) as? BluetoothManager)?.
    adapter
        if (bluetoothAdapter?.isEnabled != true) return false
        bluetoothAdapter.bondedDevices?.any { device -&gt;
        val supported = isDeviceSupported(device.name, device.address)
        val connected = isDeviceConnected(device)
        supported &amp;&amp; connected
    } ?: false
    } catch (e: Exception) {
        Log.e(TAG, "Error checking connected devices", e)
        false
        }
    }
    private fun isDeviceSupported(deviceName: String?, macAddress: String?): Boolean {
        val nameMatches = deviceName?.lowercase()?.contains("ws101") == true
        val macMatches = macAddress?.uppercase()?.startsWith("94:FB:29") == true //MAC address prefix 94:
    FB:29 is registered to Zebra Technologies Inc.
        return nameMatches || macMatches
    }

    /**
     * Checks if a Bluetooth device is currently connected to the Headset/Hands-free profile
     */
    @RequiresPermission(Manifest.permission.BLUETOOTH_CONNECT)
    private fun isDeviceConnected(device: BluetoothDevice): Boolean {
     return try {
     val bluetoothAdapter = (getSystemService(BLUETOOTH_SERVICE) as? BluetoothManager)?.adapter
     ?: return false
     // Check Headset (HFP) connection state - required for WS101 button/voice events
     val headsetState = bluetoothAdapter.getProfileConnectionState(android.bluetooth.
    BluetoothProfile.HEADSET)
     headsetState == android.bluetooth.BluetoothProfile.STATE_CONNECTED
     } catch (e: Exception) {
     Log.w(TAG, "Unable to check headset profile connection for ${device.name}: ${e.message}")
     false
     }
    }
</code></pre>

<blockquote>
  <p><i class="fa fa-exclamation-circle" style="color:#FF0000;"></i> The program code above is provided <strong><u>for demonstration purposes only</u></strong>, and is <strong><em>NOT</em></strong> intended for use in production environments. </p>
</blockquote>

<hr>

<h2 id="alsosee" class="anchor"><a class="heading-anchor" href="#alsosee"><span></span></a>Also See</h2>

<ul>
<li><strong><a href="comingSOON">Zebra WS101 Product Reference Guide (HTML)</a></strong> | <code>COMING SOON</code> Complete usage and technical reference in searchable online format</li>
</ul><p></p>
                                        


                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div><!--/.col-sm-6-->
            </div>
            </section>
        </div>
    </section>    

<div class="modal fade" id="basicModal" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true" data-backdrop="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
					</div>
					<div class="modal-body">
						<div id="modalImg">
						
						</div>
					</div>
			</div>
		  </div>
		</div> </div>
         <footer id="footer">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-sm-10">
                        ZEBRA and the stylized Zebra head are trademarks of Zebra Technologies Corp., registered in many jurisdictions worldwide. All other trademarks are the property of their respective owners. ©2026 Zebra Technologies Corp. and/or its affiliates.<br> <a href="https://www.zebra.com/us/en/about-zebra/company-information/legal.html">Legal</a> | <a href="https://www.zebra.com/us/en/about-zebra/company-information/compliance/information-privacy/terms-of-use.html">Terms of Use</a> | <a href="https://www.zebra.com/us/en/about-zebra/company-information/legal/privacy-statement.html">Privacy Policy</a> 
                    </div>
                     <!--
                     <div class="col-sm-2">
                        <ul class="social-icons">
                            <li><a href="http://www.facebook.com/pages/Zebra-Technologies/107703715989073"><i class="fa fa-facebook"></i></a></li>
                            <li><a href="https://twitter.com/ZebraDevs"><i class="fa fa-twitter"></i></a></li>
                            <li><a href="http://www.youtube.com/zebratechnologies/"><i class="fa fa-youtube"></i></a></li>
                            <li><a href="https://www.linkedin.com/groups?home=&gid=3220074&trk=anet_ug_hm&goback=%2Egmr_3220074"><i class="fa fa-linkedin"></i></a></li>
                            <li><a href="https://github.com/developer-zebra"><i class="fa fa-github"></i></a></li>
                        </ul>
                    </div> -->
                 </div>
            </div>
        </footer>
    
    <!--/#footer 
        10/25/18 removed <footer id="footer" class="navbar-fixed-bottom">
    -->
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/owl.carousel.min.js"></script>
    <script src="/js/mousescroll.js"></script>
    <script src="/js/smoothscroll.js"></script>
    <script src="/js/jquery.prettyPhoto.js"></script>
    <script src="/js/jquery.isotope.min.js"></script>
    <script src="/js/jquery.inview.min.js"></script>
    <script src="/js/wow.min.js"></script>
    <script src="/js/bootstrap-treenav.min.js"></script>
    <script src="/js/prettify.js"></script>
    <script src="/js/zepto.js"></script>
    <script src="/js/jquery.waterfall.js"></script>   
    <script src="/js/main.js"></script>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','zRzEsAUhWTTkrdEN2YfA','2.0.0');
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-72584442-1', 'auto');
  ga('send', 'pageview');

</script> 

<script>
    ChatraID = 'QDvZ76min4DhLW5vJ';
    (function(d, w, c) {
        var n = d.getElementsByTagName('script')[0],
            s = d.createElement('script');
        w[c] = w[c] || function() {
            (w[c].q = w[c].q || []).push(arguments);
        };
        s.async = true;
        s.src = (d.location.protocol === 'https:' ? 'https:': 'http:')
            + '//call.chatra.io/chatra.js';
        n.parentNode.insertBefore(s, n);
    })(document, window, 'Chatra');
</script>         


</body></html>