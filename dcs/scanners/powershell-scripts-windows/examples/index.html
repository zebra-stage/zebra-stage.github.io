<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="Programmers can use these scanner Software Development Kits to build applications.">
        <meta name="author" content="Zebra Technologies">
        <meta name="google-site-verification" content="i4B78BrWnNy8ShJwe5feRW3jO3HE6gfYlYqYbxfl8yY">
        <meta name="msvalidate.01" content="6B651B00161BCE79B8950AC09D5C4C75">
        <meta title="About Scanner SDK for Windows">
        <title>Scanner SDK for Windows - About - Zebra Technologies</title>
        <!-- core CSS -->
        <link rel="stylesheet" href="/home/css/uikit.min.css" />
        <link rel="stylesheet" href="/home/css/style.css" />
        <link rel="stylesheet" href="/home/css/bootstrap.min.css" />  
        <link rel="stylesheet" href="/home/css/main.css" >
        <!-- <link href="/css/bootstrap.min.css" rel="stylesheet"> -->
        <link href="/css/font-awesome.min.css" rel="stylesheet">
        <link href="/css/animate.min.css" rel="stylesheet">
        <link href="/css/owl.carousel.css" rel="stylesheet">
        <link href="/css/owl.transitions.css" rel="stylesheet">
        <link href="/css/prettyPhoto.css" rel="stylesheet">
        <!-- <link href="/css/main.css" rel="stylesheet"> -->
        <link href="/css/responsive.css" rel="stylesheet">
        <link href="/css/prettify.css" rel="stylesheet">
        <link href="/css/bootstrap-treenav.min.css" rel="stylesheet">
        <link href="../../dcs_styles.css" rel="stylesheet">
        <!--[if lt IE 9]>
        <script src="js/html5shiv.js"></script>
        <script src="js/respond.min.js"></script>
        <![endif]--> 
        <script src="//load.sumome.com/" data-sumo-site-id="699cb66cf4dc59352efb45705526d15cbe314e1cd43f7761b94d96f3cf7338e8" async="async"></script>
        <link rel="shortcut icon" href="/favicon.ico">
        <script src="/js/jquery.js"></script>
        <script src="../../dcs_script.js"></script>
    </head>
    <body id="home" class="homepage" data-spy="scroll" data-offset="100" data-target="#toc">
        <header id="header">
            <nav id="main-menu" class="navbar navbar-default navbar-fixed-top" role="banner">
                <div class="container-fluid">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="/">
                            <img src="/images/logo.png" alt="logo" style="max-height:66px;float: inherit; padding-right: 3px;">
                        </a> 
                    </div>
                    <div class="collapse navbar-collapse navbar-left">
                        <ul class="nav navbar-nav">
                            <li class="navbar-text pull-left"><strong>TechDocs</strong></li>
                            <li>
                                <a href="/dcs/scanners">Barcode Scanner Tools</a>
                            </li>
                            <p class="navbar-text">PowerShell Scripts for Windows</p>
                        </ul>
                    </div>
                    <div class="collapse navbar-collapse navbar-right">
                        <ul class="nav navbar-nav">
                            <li>
                                <a href="/dcs/scanners/powershell-scripts-windows/about/">About</a>
                            </li>
                            <li>
                                <a href="/dcs/scanners/powershell-scripts-windows/examples/">Examples</a>
                            </li>
                        </ul>
                    </div>
                </div><!--/.container-->
            </nav><!--/nav-->
        </header><!--/header-->
        <div class="container-fluid">
            <section id="blog">
                <div class="">
                    <section class="content-with-sidebar">
                        <div class="row">
                            <div class="col-sm-3 hidden-sm hidden-xs" id="sidebar">
                                <nav id="toc" data-toggle="toc" data-spy="affix" style="height: 75%; max-width: 225px; overflow-y: auto; ">
                                    <ul class="nav">
                                        <li><strong>Scanner SDK Usage via Windows Powershell</strong></li>
                                    </ul>
                                </nav>                    
                                <script type="text/javascript">
                                    $(document).ready(function() {
                        	            $( "#btn_SaveSmartDocOptions" ).click(function() {
                      			            console.log('Saving Options');
                      			            $("#modal-smartdocs").modal({show: false});
                    		            });
                        	            $( "#btn_SaveSmartDocOptions" ).click(function() {
                      			            console.log('Clearing Options');
                      			            $("#modal-smartdocs").modal({show: false});
                    		            });
                                    });
                                </script>
                                <link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.3.0/dist/bootstrap-toc.min.css">
                                <script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.3.0/dist/bootstrap-toc.min.js"></script>
                                <script type="text/javascript">
                                    $(document).ready(function() {                    
                                    });
                                </script>
                            </div>                
                            <div class="col-sm-9 ">
                                <div class="row">
                                    <div class="col-sm-12">
                                        <section id="cta" class="wow fadeIn">
                                            <div class="">
                                                <h1 id="scanner-sdk-powershell-scripts" class="anchor">
                                                    <a class="heading-anchor" href="#scanner-sdk-powershell-scripts"><span></span></a>Scanner SDK Usage via Windows Powershell
                                                </h1>
                                            </div>
                                        </section>                    
                                    </div>
                                </div>
                                <div id="mainContent" class="row">
                                    <div class="col-sm-12">
                                        <div class="blog-post blog-large wow fadeInLeft" data-wow-duration="300ms" data-wow-delay="0ms">
                                            <!-- Start of guide -->
                                            <div class="service-box wow fadeInRight">
                                                <div class="">
                                                    <h2 id="overview" class="anchor"><a class="heading-anchor" href="#overview"><span></span></a>Overview</h2>

                                                    <p>API calls to the Scanner SDK for Windows are accessible through the Microsoft Windows native PowerShell scripting language. The Zebra CoreScanner service must be installed and running to support method calls from PowerShell.</p>

                                                    <p>As with C++ and C# development, a CoreScanner instance must first be opened, followed by the GetScanners method call to discover connected scanner devices.</p>

                                                    <p>Other API methods can then be called by PowerShell via each device's ScannerID using the syntax described in the <a href="../api/#examples" target="_blank">Using the Methods</a> section.</p>

                                                    <h2 id="list-of-powershell-scripts" class="anchor"><a class="heading-anchor" href="#list-of-powershell-scripts"><span></span></a>Catalog of PowerShell Scripts</h2>

                                                    <p>This collection provides a comprehensive directory of PowerShell scripts specifically designed for managing Zebra Barcode Scanners.</p>

                                                    <h3 id="powershell-scripts-asset-info" class="anchor"><a class="heading-anchor" href="#powershell-scripts-asset-info"><span></span></a>Retrieve Asset Information</h3>

                                                    <p>Retrieve detailed asset information for the scanners currently connected to the system.</p>

                                                    <div class="code-container">
                                                        <button class="button copy-button" onclick="copyCode(this)">Copy</button>
                                                        <button class="button download-button" onclick="downloadFile('CoreScanner_AssetInfo.ps1')">
                                                            <img src="../../images/common/download.png">
                                                        </button>                                     
<pre class="prettyprint">
<code id="code-snippet">
# Description : Query the asset information of the connected scanners.
# Support PSVersion 5+.
# Copyright : Â©2025 Zebra Technologies Corp. and/or its affiliates.

# Enable logging.
Start-Transcript -Append -Path $PSScriptRoot"\CoreScanner_AssetInfo.log.txt"

# Process GetScanners out XML and list the asset information
Function Process-Out-XML ($XML)
{
    $XmlContent = New-Object -TypeName System.Xml.XmlDocument
    $XmlContent.LoadXml($XML)

    # Pipe asset information
    $XmlContent.scanners.scanner | Format-Table -AutoSize @{Name = 'Scanner ID'; Expression = {$_.scannerID}},
                                                            @{Name = 'Host Mode'; Expression = {$_.type}}, 
                                                            @{Name = 'Model Number'; Expression = {$_.modelnumber}},
                                                            @{Name = 'Serial Number'; Expression = {$_.serialnumber}},
                                                            @{Name = 'Date of Manufacture'; Expression = {$_.DoM}},
                                                            @{Name = 'Scanner Firmware Version'; Expression = {$_.firmware}}
}

# Main script to execute
Invoke-Command -ScriptBlock {
    # Initialize CoreScanner
    Write-Output "$(Get-Date) Loading Interop.CoreScanner.dll";		
    [System.Reflection.Assembly]::LoadFile("C:\Program Files\Zebra Technologies\Barcode Scanners\Common\Interop.CoreScanner.dll")|Out-Null;		
    $ScannerObject = New-Object Interop.CoreScanner.CCoreScannerClass;

    # Initialize
    $Status = 0;
    $AppHandle = 0;
    $OutXML = "";
    $ScannerCount = 0;
    
    # For all scanners, set to 1
    $ScannerTypes = New-Object int16[] 11;
    $ScannerTypes[0] = 1;
    
    # For all scanner types, set to 1
    $NumberOfScannerTypes = [int16] 1;

    $ScannerIDList = New-Object int16[] 255;
    
    # Invokde Open API		
    $ScannerObject.Open($AppHandle, $ScannerTypes, $NumberOfScannerTypes, [ref] $Status);
    Write-Output "$(Get-Date) Scanner.Open() Status: $Status";

    # Invoke GetScanners API, process XML to query scanners
    $ScannerObject.GetScanners([ref] $ScannerCount, $ScannerIDList, [ref] $OutXML, [ref] $Status)
    Write-Output "$(Get-Date) GetScanners API Invoke Status: $Status";
    Write-Output "$(Get-Date) Number of Connected Scanner(s) to the Host: $ScannerCount";
    
    Process-Out-XML -XML $OutXML;
}
</code>
</pre>
                                                    </div>

                                                    <h3 id="powershell-scripts-barcode-data" class="anchor"><a class="heading-anchor" href="#powershell-scripts-barcode-data"><span></span></a>Barcode Data</h3>

                                                    <p>Barcode data.</p>

                                                    <div class="code-container">
                                                        <button class="button copy-button" onclick="copyCode(this)">Copy</button>
                                                        <button class="button download-button" onclick="downloadFile('CoreScanner_BarcodeData.ps1')">
                                                            <img src="../../images/common/download.png">
                                                        </button>                                     
<pre class="prettyprint">
<code id="code-snippet">
# Description : Scanner Barcode Data.
# Support PSVersion 5+.
# Copyright : Â©2025 Zebra Technologies Corp. and/or its affiliates.

# Main script to execute
Invoke-Command -ScriptBlock {

add-Type -typedef @"
using System;
using System.Reflection;
using System.Runtime.InteropServices;

namespace CoreScannerWrapperLib
{
    public delegate void BarcodeEventHandler(int dataType, string pscanData);
    
    /// &lt;summary>
    /// CoreScanner Wrapper for barcode events
    /// &lt;/summary>
    public class CoreScannerWrapper
    {
        public static event BarcodeEventHandler OnBarcode;

        private const int EventTypeBarcode = 1;
        private const short NumberOfScannerTypes = 1;
        private const int StatusFalse = -1;

        private Type objType;
        private object coreScannerObject = null;
        private int appHandle = 0;
        private short[] scannerTypes = new short[NumberOfScannerTypes];

        // Initialize CoreScanner COM object
        public CoreScannerWrapper()
        {
            string progId = "CoreScanner.CoreScanner";
            objType = Type.GetTypeFromProgID(progId);
            coreScannerObject = Activator.CreateInstance(objType);
        }

        public int Open()
        {
            int status = StatusFalse;
            short numberOfTypes = 1;
            short[] scannerTypes = { 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            scannerTypes[0] = 1;

            coreScannerObject.GetType().InvokeMember("Open", BindingFlags.InvokeMethod, null,
                coreScannerObject, new object[]
                {
                    appHandle,scannerTypes, numberOfTypes, status
                });
            RegisterForEvents();
            return status;
        }

        public void RegisterForEvents()
        {
            string inXml = "";
            string outXml = "";
            long status = -1;
            int opCodeRegisterForEvents = 1001;
            int eventIdCount = 1; // Number of events to register (only barcode events)
            int[] eventIdList = new int[eventIdCount];
            // Register for barcode events only
            eventIdList[0] = EventTypeBarcode;

            string eventIds = String.Join(",", eventIdList);
            inXml = "&lt;inArgs>" +
                    "&lt;cmdArgs>" +
                    "&lt;arg-int>" + eventIdCount + "&lt;/arg-int>" + // Number of events to register
                    "&lt;arg-int>" + eventIds + "&lt;/arg-int>" + // Event id list of events to register for
                    "&lt;/cmdArgs>" +
                    "&lt;/inArgs>";
           
            // Call register for events
            status=ExecCommand(opCodeRegisterForEvents, // Opcode: Register for events
                inXml, // Input XML
                out outXml // Output XML 
                ); // Command execution success/failure return status  
           
            MethodInfo method =
                this.GetType().GetMethod("BarcodeEvent",
                    BindingFlags.NonPublic | BindingFlags.Instance);

            MethodInfo barcodeEventCallbackMethod = this.GetType().GetMethod("BarcodeEvent", BindingFlags.Public| BindingFlags.Instance);
            BarcodeEventHandler callback  = (BarcodeEventHandler) Delegate.CreateDelegate(typeof(BarcodeEventHandler), this, barcodeEventCallbackMethod, false);

            Guid sourceId = new Guid("981E3D8B-C756-4195-A702-F198965031C6");   // CoreScanner events GUID
            int dispId = 3;  // Barcode data disp id
            ComEventsHelper.Combine(coreScannerObject, sourceId, dispId, callback);
        }

        public void BarcodeEvent(int dataType,  string pscanData)
        {
            if (OnBarcode != null)
            { 
                OnBarcode(dataType, pscanData);
            }
        }

        public int ExecCommand(int opCode, string inXml, out string outXml)
        {
            int status = StatusFalse;
            outXml = "";

            ParameterModifier[] mods = new ParameterModifier[] { new ParameterModifier(4) };
            mods[0][2] = true;
            mods[0][3] = true;

            object[] parameters = new object[4];
            parameters[0] = opCode;
            parameters[1] = inXml;
            parameters[2] = "";
            parameters[3] = StatusFalse;

            coreScannerObject.GetType().InvokeMember("ExecCommand", BindingFlags.InvokeMethod, null, coreScannerObject, parameters, mods, null, null);
            outXml = (string)parameters[2];
            status = (int)parameters[3];
            return status;
        }

        public int Close()
        {
            int status = StatusFalse;
            coreScannerObject.GetType().InvokeMember("Close", BindingFlags.InvokeMethod, null,
                coreScannerObject, new object[]
                {
                    appHandle, status
                });
            return status;
        }
    }
}
"@
    #Add-Type -TypeDefinition $Source -Language CSharp 
	$ScanneWrapperObject = New-Object CoreScannerWrapperLib.CoreScannerWrapper;

    Write-Output "Starting --------------------"

    $Action = {   
       Write-Host $event.SourceArgs
     }

    Register-ObjectEvent -InputObject $ScanneWrapperObject -SourceIdentifier "BarcodeEvents" -EventName "OnBarcode"  -Action  $Action

    $stat= $ScanneWrapperObject.Open();

    Write-Output "Scan barcodes now --------------------"
    for (($i = 0); $i -lt 10; $i++)
    {
        Start-Sleep -Seconds 1
    }
    $stat= $ScanneWrapperObject.Close();
    Write-Output "Closing CoreScanner";
    Unregister-Event -SourceIdentifier "BarcodeEvents"
}
</code>
</pre>
                                                    </div>

                                                    <p></p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </section>    
            <div class="modal fade" id="basicModal" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true" data-backdrop="true">
			    <div class="modal-dialog">
				    <div class="modal-content">
					    <div class="modal-header">
						    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
					    </div>
					    <div class="modal-body">
						    <div id="modalImg"></div>
					    </div>
			        </div>
		        </div>
            </div>
        </div>
        <footer id="footer" class="navbar-fixed-bottom">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-sm-10">
                        ZEBRA and the stylized Zebra head are trademarks of Zebra Technologies Corp., registered in many jurisdictions worldwide. All other trademarks are the property of their respective owners. &copy;2025 Zebra Technologies Corp. and/or its affiliates. <a href="https://www.zebra.com/us/en/about-zebra/company-information/legal.html">Legal</a> | <a href="https://www.zebra.com/us/en/about-zebra/company-information/legal/terms-of-use.html">Terms of Use</a> | <a href="https://www.zebra.com/us/en/about-zebra/company-information/legal/privacy-statement.html">Privacy Policy</a> 
                    </div>
                    <!--<div class="col-sm-2">
                        <ul class="social-icons">
                            <li><a href="http://www.facebook.com/pages/Zebra-Technologies/107703715989073"><i class="fa fa-facebook"></i></a></li>
                            <li><a href="https://twitter.com/ZebraDevs"><i class="fa fa-twitter"></i></a></li>
                            <li><a href="http://www.youtube.com/zebratechnologies/"><i class="fa fa-youtube"></i></a></li>
                            <li><a href="https://www.linkedin.com/groups?home=&amp;gid=3220074&amp;trk=anet_ug_hm&amp;goback=%2Egmr_3220074"><i class="fa fa-linkedin"></i></a></li>
                            <li><a href="https://github.com/zebra-technologies"><i class="fa fa-github"></i></a></li>
                        </ul>
                    </div>-->
                </div>
            </div>
        </footer><!--/#footer-->
        <script src="/js/bootstrap.min.js"></script>
        <script src="/js/owl.carousel.min.js"></script>
        <script src="/js/mousescroll.js"></script>
        <script src="/js/smoothscroll.js"></script>
        <script src="/js/jquery.prettyPhoto.js"></script>
        <script src="/js/jquery.isotope.min.js"></script>
        <script src="/js/jquery.inview.min.js"></script>
        <script src="/js/wow.min.js"></script>
        <script src="/js/bootstrap-treenav.min.js"></script>
        <script src="/js/prettify.js"></script>
        <script src="/js/zepto.js"></script>
        <script src="/js/jquery.waterfall.js"></script>   
        <script src="/js/main.js"></script>
        <script type="text/javascript">
            (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
                (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
                e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
            })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

            _st('install','zRzEsAUhWTTkrdEN2YfA','2.0.0');
        </script>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-72584442-1', 'auto');
            ga('send', 'pageview');
        </script> 
        <script>
            ChatraID = 'QDvZ76min4DhLW5vJ';
            (function(d, w, c) {
                var n = d.getElementsByTagName('script')[0],
                    s = d.createElement('script');
                w[c] = w[c] || function() {
                    (w[c].q = w[c].q || []).push(arguments);
                };
                s.async = true;
                s.src = (d.location.protocol === 'https:' ? 'https:': 'http:')
                    + '//call.chatra.io/chatra.js';
                n.parentNode.insertBefore(s, n);
            })(document, window, 'Chatra');
        </script>         
    </body>
</html>