
<!DOCTYPE html>
<html lang="en"><head>

    <meta charset="utf-8">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="-1">
    <meta http-equiv="CACHE-CONTROL" content="NO-CACHE">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Online Documentation for Zebra Technologies developer tools and utilties, including EMDK for Android, EMDK for Xamarin, StageNow and Enterprise Browser.">
    <meta name="author" content="Zebra Technologies">
    <meta name="google-site-verification" content="i4B78BrWnNy8ShJwe5feRW3jO3HE6gfYlYqYbxfl8yY">
    <meta name="msvalidate.01" content="6B651B00161BCE79B8950AC09D5C4C75">
    <meta title="APIs">
    <title>APIs - TechDocs</title>
    <!-- core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
<!--     
    <link href="/css/font-awesome.min.css" rel="stylesheet">
 -->    
    <link href="/css/all.css" rel="stylesheet">
    <link href="/css/v4-shims.css" rel="stylesheet">
    <link href="/css/animate.min.css" rel="stylesheet">
    <link href="/css/owl.carousel.css" rel="stylesheet">
    <link href="/css/owl.transitions.css" rel="stylesheet">
    <link href="/css/prettyPhoto.css" rel="stylesheet">
    <link href="/css/main.css" rel="stylesheet">
    <link href="/css/responsive.css" rel="stylesheet">
    <link href="/css/prettify.css" rel="stylesheet">
    <link href="/css/bootstrap-treenav.min.css" rel="stylesheet">
    <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
    <script src="js/respond.min.js"></script>
    <![endif]--> 

    <script src="//load.sumome.com/" data-sumo-site-id="699cb66cf4dc59352efb45705526d15cbe314e1cd43f7761b94d96f3cf7338e8" async="async"></script>
    <link rel="shortcut icon" href="/favicon.ico">
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-01QJCMQM9N"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-01QJCMQM9N');
</script><script src="/js/jquery.js"></script></head><!--/head-->

<!-- Google tag -->





<body id="home" class="homepage" data-spy="scroll" data-offset="100" data-target="#toc">

    <header id="header">
        <nav id="main-menu" class="navbar navbar-default navbar-fixed-top" role="banner">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/"><img src="/images/logo.png" alt="logo" style="max-height:66px;float: inherit;
    padding-right: 3px;"></a> 
                    
                   
                </div>
                <div class="collapse navbar-collapse navbar-left">
                    <ul class="nav navbar-nav">
                        <li class="navbar-text pull-left"><strong>TechDocs</strong></li>
                        <p class="navbar-text">
                                            Identity Guardian
                                            1.2
                        </p>

                    </ul>
                </div>
                <div class="collapse navbar-collapse navbar-right">
                    <ul class="nav navbar-nav">
                        


                        <li>
                            <a href="/identityguardian/1-2/about">
                                    About
                            </a>
                        </li>
                        <li>
                            <a href="/identityguardian/1-2/setup">
                                    Setup
                            </a>
                        </li>
                        <li>
                            <a href="/identityguardian/1-2/licensing">
                                    Licensing
                            </a>
                        </li>
                        <li>
                            <a href="/identityguardian/1-2/mc">
                                    Managed Configurations
                            </a>
                        </li>
                        <li>
                            <a href="/identityguardian/1-2/usage">
                                    User Guide
                            </a>
                        </li>
                        <li>
                            <a href="/identityguardian/1-2/api">
                                    APIs
                            </a>
                        </li>
                        <li>
                            <a href="/identityguardian/1-2/search">
                                    <i class="fa fa-search"></i>
                            </a>
                        </li>
                        
                        <!-- <li ><a href="/products">SDKs</a></li>
                        <li ><a href="/samples">Samples</a></li>
                        <li ><a href="/guides">Guides</a></li>
                        <li ><a href="/tutorials">Tutorials</a></li>
                        <li ><a href="/apis">APIs</a></li> -->
                        <!-- <li><a href="#"><input type="text" class="st-default-search-input"></a></li> -->
                    </ul>
                </div>
            </div><!--/.container-->
        </nav><!--/nav-->
    </header><!--/header-->
<div class="container-fluid">
    <section id="blog">
        <div class="">
            <section class="content-with-sidebar">
            <div class="row">
                <div class="col-sm-3 hidden-sm hidden-xs" id="sidebar">
                    
                    
                    <nav id="toc" data-toggle="toc" data-spy="affix" style="height: 75%; max-width: 225px; overflow-y: auto; ">
                        
                        <ul class="nav">
                            <li><strong>APIs</strong></li>
                        </ul>
                    </nav>
                    <div class="modal fade" id="modal-smartdocs" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true" data-backdrop="true">
                    	<div class="modal-dialog">
                    		<div class="modal-content">
                    			<div class="modal-header">
                    				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
                    			</div>
                    			<div class="modal-body">
                    				<form>
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">MX Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="4.0">4.0</option>
                    					  <option value="4.1">4.1</option>
                    					  <option value="4.2">4.2</option>
                    					  <option value="4.3">4.3</option>
                    					  <option value="5.0">5.0</option>
                    					</select>
                    				  </div>						
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">OSX Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="1.0">1.0</option>
                    					  <option value="1.2">1.2</option>
                    					  <option value="1.3.4-56">1.3.4-56</option>
                    					  <option value="3.4">3.4</option>
                    					  <option value="3.5">3.5</option>
                    					  <option value="3.6">3.6</option>
                    					  <option value="4.1">4.1</option>
                    					  <option value="4.2">4.2</option>
                    					  <option value="4.3">4.3</option>
                    					  <option value="4.4">4.4</option>
                    					</select>
                    				  </div>						
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">Android Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="23">6.0 Marshmallow</option>
                    					  <option value="22">5.1 Lollipop</option>
                    					  <option value="21">5.0 Lollipop</option>
                    					  <option value="19">4.4 Kitkat</option>
                    					  <option value="18">4.3 Jellybean</option>
                    					  <option value="17">4.2.x Jellybean</option>
                    					  <option value="16">4.1.x Jellybean</option>
                    					  <option value="15">4.0.3-4.0.4 Ice Cream Sandwich</option>
                    					  <option value="14">4.0-4.0.2 Ice Cream Sandwich</option>
                    					  <option value="10">2.3.3-2.3.4 Gingerbread</option>
                    					</select>
                    				  </div>
                    				  <div class="form-group">
                    				  	<button class="primary" id="btn_SaveSmartDocOptions">Save Changes</button><button class="primary" id="btn_ClearSmartDocOptions">Clear Changes</button>
                    				  </div>
                    				</form>
                    			</div>
                    	</div>
                      </div>
                    </div>
                    
                    <script type="text/javascript">
                        $(document).ready(function() {
                        	$( "#btn_SaveSmartDocOptions" ).click(function() {
                      			console.log('Saving Options');
                      			$("#modal-smartdocs").modal({show: false});
                    		});
                        	$( "#btn_SaveSmartDocOptions" ).click(function() {
                      			console.log('Clearing Options');
                      			$("#modal-smartdocs").modal({show: false});
                    		});
                        });
                    </script><link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.3.0/dist/bootstrap-toc.min.css">
                    <script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.3.0/dist/bootstrap-toc.min.js"></script>
                    <script type="text/javascript">
                        $(document).ready(function() {
                    
                        });
                    
                    
                    </script>
                </div>                
                <div class="col-sm-9 ">
                    <div class="row">
                        <div class="col-sm-12">
                            <section id="cta" class="wow fadeIn">
                                <div class="">
                                    <h1 id="apis" class="anchor"><a class="heading-anchor" href="#apis"><span></span></a>APIs</h1>
                                    <p>
                                            Identity Guardian
                                            1.2
                                    </p>
                                </div>
                            </section>                    
                        </div>
                    </div>
                    <div id="mainContent" class="row">
                        <div class="col-sm-12">
                            <div class="blog-post blog-large wow fadeInLeft" data-wow-duration="300ms" data-wow-delay="0ms">
                            <!-- Start of guide -->
                                <div class="service-box wow fadeInRight">
                                    <div class="">

                                        <p></p><h2 id="overview" class="anchor"><a class="heading-anchor" href="#overview"><span></span></a>Overview</h2>

<p>This guide discusses the APIs offered by <strong>Identity Guardian.</strong> Identity Guardian implements a content provider interface to securely retrieve and share data between applications. The content provider URI contains four distinct parts: <code>&lt;Scheme:&gt;//&lt;Authority&gt;/&lt;API&gt;/&lt;data&gt;</code></p>

<ol>
<li><strong>Scheme -</strong> The identifier that informs Android that the URI provides access to a content source. This is typically: <code>content://</code></li>

<li><strong>Authority -</strong> The authority name, typically in the forma <code>packagename.provider</code>.</li>

<li><strong>API -</strong> Th path that differentiates the content data.</li>

<li><strong>Data -</strong> The key name which points to data in the path.</li>
</ol>

<p>Example of content provider URI: <code>content://com.zebra.mdna.els.provider/&lt;API&gt;/&lt;data&gt;</code></p>

<p><code>&lt;API&gt;</code> and <code>&lt;data&gt;</code> are replaced with the appropriate string.</p>

<hr>

<h2 id="requirements" class="anchor"><a class="heading-anchor" href="#requirements"><span></span></a>Requirements</h2>

<ul>
<li><p>In the <strong>AndroidManifest.xml</strong> of your application, add the required permission and the <code>&lt;queries&gt;</code> tag, which defines the package name for Identity Guardian:</p>

<pre class="prettyprint"><code>&lt;uses-permission android:name="com.zebra.mdna.els.permission.PROVIDER" /&gt;
&lt;queries&gt;
    &lt;package android:name="com.zebra.mdna.els" /&gt;
&lt;/queries&gt;
</code></pre></li>

<li><p>To use Identity Guardian APIs, they need to be <a href="#whitelistapis">whitelisted</a> within your application.</p></li>

<li><p>For security purposes, your app must be included on Identity Guardian's permitted app whitelist using <a href="/mx/accessmgr">AccessMgr CSP</a> from <a href="/flux/about">Zebra Device Manager (ZDM)</a> to enable utilization of the APIs. Create a profile using <a href="/stagenow">StageNow</a> to deploy the configuration to whitelist your app. Set the following parameters:</p>

<ul>
<li><strong>Operation Mode:</strong> "Single User without Whitelist"</li>

<li><strong>Service Access Action</strong>: "Allow Caller to Call Service"</li>

<li><strong>Service Identifier</strong>: &lt;delegation scope of the API category&gt;</li>

<li><strong>Specify Caller Package Name</strong>: &lt;enter app package name, e.g.: com.company.appname&gt;</li>

<li><strong>Caller Signature</strong>: &lt;select signature file that contains the app certificate&gt;</li></ul>

<p>See <a href="/mx/accessmgr/#caller-signature">Caller Signature</a> in the Access Mgr CSP documentation for information on generating a signature file. After creating the StageNow profile, use StageNow to scan the barcode generated or deploy the XML file via Enterprise Mobility Management (EMM) software.</p></li>
</ul>

<hr>

<h2 id="registerfornotifications" class="anchor"><a class="heading-anchor" href="#registerfornotifications"><span></span></a>Register for Notifications</h2>

<h3 id="lockscreenstatus" class="anchor"><a class="heading-anchor" href="#lockscreenstatus"><span></span></a>Lock Screen Status</h3>

<p>Register to receive notifications about the locked/unlocked status of Identity Guardian during user sign in/out events. Register this API in onCreate() and unregister it in onDestroy() method.</p>

<p>URI: <code>content://com.zebra.mdna.els.provider/lockscreenstatus/state</code></p>

<p>Sample code:</p>

<pre class="prettyprint"><code>    Uri URI_CURRENT_LOCKSCREEN_STATE = Uri.parse("content://com.zebra.mdna.els.provider/lockscreenstatus/state");
    cr.registerContentObserver(URI_CURRENT_LOCKSCREEN_STATE, false, contentObserverLockScreenState);
    contentObserverLockScreenState = new ContentObserver(new Handler(getMainLooper())) {

        @Override
        public void onChange(boolean selfChange, Uri uri) {
            super.onChange(selfChange, uri);
            Log.d(TAG, "content has changed, uri = " + uri);
            new Thread(new Runnable() {
                @Override
                public void run() {
                    getCurrentLockScreenStateOfDevice();
                }
            }).start();

        }
    };
</code></pre>

<p>The return value is in JSON string format:</p>

<pre class="prettyprint"><code>    {state: “SHOWN” or “HIDDEN”, lastchangedtimestamp:”MM:DD:YY HH:MM:SS”}
</code></pre>

<ul>
<li>"HIDDEN" indicates that the device is unlocked and a user is currently logged in.</li>

<li>"SHOWN" indicates that the device is locked and no user is logged in.</li>
</ul>

<hr>

<h2 id="retrieveusersession" class="anchor"><a class="heading-anchor" href="#retrieveusersession"><span></span></a>Retrieve User Session</h2>

<p>Retrieve session data associated with the current or previous user. <em><strong>When the device is in a locked state, these APIs are functional if the lock state is activated by specific device system events,</strong> <u>not</u> by an application triggering the lock state.</em> The lock screen can be activated by the following device system events, based on <a href="../mc/#authenticationconfiguration">Authentication Configuration</a>:</p>

<ul>
<li>Unlocking the device (OnUnlock)</li>

<li>Rebooting the device (OnReboot)</li>

<li>Connecting the device to AC power (OnACPowerConnected)</li>

<li>Disconnecting the device from AC power (OnACPowerDisconnected)</li>
</ul>

<p>An application can activate the lock screen by invoking <a href="#startauthentication">Start Authentication</a>.</p>

<h3 id="currentsession" class="anchor"><a class="heading-anchor" href="#currentsession"><span></span></a>Current Session</h3>

<p>Retrieve data from the current user's session. The data retrieved includes but is not limited to: user ID, role, timestamps for sign in/out and multifactor authentication.</p>

<p>URI: <code>content://com.zebra.mdna.els.provider/currentsession</code></p>

<p>Sample code:</p>

<pre class="prettyprint"><code>    Uri URI_USER_CURRENT_SESSION = Uri.parse("content://com.zebra.mdna.els.provider/currentsession");
    Cursor cursor = cr.query(URI_USER_CURRENT_SESSION, null, null, null, null);
</code></pre>

<p>The 'cursor' is given in JSON format where each key is accompanied by a series of possible values separated by '/'  and custom values enclosed in '[ ]' in the key-value pair: </p>

<pre class="prettyprint"><code>    {
        "signin_time": "[time stamp]",
        "user_role":"[string]",
        "user_id":"[string]",
        "signout_time":"[time stamp]",
        "authenticationFactors": 
        {
            "SchemaVersion": "1.0"
            "factors":[
                {
                    "FactorType": "PRIMARYPRIMARYFACTOR",
                    "Factor": "PASSCODE/FACE/SSO/NO_COMPARISON",                    
                    "Status": "EXECUTED/EXECUTED BUT NOT CONSIDERED/TIMEDOUT"
                },
                {
                    "FactorType": "PRIMARYSECONDARYFACTOR1",
                    "Factor": "PASSCODE/FACE/SSO/NONE",
                    "Status": "TIMEDOUT/USERSKIPPED/EXECUTED"
                },
                {
                    "FactorType": "FALLBACKFACTOR1",
                    "Factor": "PASSCODE/FACE/SSO/ADMINBYPASS/NONE",
                    "Status": "EXECUTED/TIMEDOUT/USERSKIPPED"
                }            
            ]
            "EventType": "PreviousUser/CurrentUser",
            "lockScreenEventType": "on_reboot/on_unlock/on_user_change/ac_power_connected/ac_power_disconnected/on_devicemanual_checkin/on_forcelock"
        }
        "barcode_id":"[string]",
        "signed_in_state":"1/0"
    }
</code></pre>

<p><strong>The result from 'cursor' includes an authentication factors section,</strong> which encapsulates an array of authentication factors used in multifactor authentication (MFA) with each factor represented as an object.</p>

<p><strong>The properties returned in the 'cursor' result are:</strong></p>

<ul>
<li><strong>FactorType -</strong> Specifies the level of authentication:


<ul>
<li><strong>PRIMARYPRIMARYFACTOR -</strong> Primary authentication</li>

<li><strong>PRIMARYSECONDARYFACTOR1 -</strong> Secondary authentication</li>

<li><strong>FALLBACKFACTOR1 -</strong> Fallback authentication</li></ul>
</li>

<li><strong>Factor -</strong> Describes the type of authentication:


<ul>
<li><strong>PASSCODE</strong></li>

<li><strong>FACE</strong></li>

<li><strong>SSO</strong></li>

<li><strong>NO_COMPARISON -</strong> Applies to "PRIMARYPRIMARYFACTOR" FactorType</li>

<li><strong>NONE -</strong> Applies to "PRIMARYSECONDARYFACTOR1" and "FALLBACKFACTOR1" FactorType</li></ul>
</li>

<li><strong>Status -</strong> Indicates the current status of authentication:


<ul>
<li><strong>EXECUTED -</strong> Authentication is successful.</li>

<li><strong>EXECUTED BUT NOT CONSIDERED -</strong> Primary authentication was successful but secondary authentication failed.</li>

<li><strong>TIMEDOUT -</strong> The authentication request exceeded the time limit.</li>

<li><strong>USERSKIPPED -</strong> The user opted for fallback authentication, bypassing the SSO login prompt by pressing the back button.</li></ul>
</li>

<li><strong>EventType -</strong> Indicates whether the authentication is for a previous user or the current user. This could be relevant for tracking user sessions or determining access rights:


<ul>
<li><strong>PreviousUser</strong></li>

<li><strong>CurrentUser</strong></li></ul>
</li>

<li><strong>lockScreenEventType -</strong> Specifies the event that triggered the lock screen to appear. This could include events like device reboot, user unlock, power connection/disconnection, manual check-in, or forced lock.


<ul>
<li><strong>on_reboot -</strong> Device rebooted</li>

<li><strong>on_unlock -</strong> User unlocked device</li>

<li><strong>on_user_change -</strong> User signed out and another user signed into the device</li>

<li><strong>ac_power_connected -</strong> Device connected to power</li>

<li><strong>ac_power_disconnected -</strong> Device disconnected from power</li>

<li><strong>on_devicemanual_checkin -</strong> User manually signed out of the device through the "Sign out" button in Identity Guardian (applies to Shared Devices only).</li>

<li><strong>on_forcelock -</strong> Device automatically locked after reaching the specified timeout period.</li></ul>
</li>

<li><strong>signed_in_state -</strong> Specifies whether a user has signed into the device.


<ul>
<li><strong>1 -</strong> A user is signed into the device.</li>

<li><strong>0 -</strong> No user is signed into the device.</li></ul>
</li>
</ul>

<p><strong>Sample return value in JSON string format for 'cursor'.</strong> If 'cursor' is null or empty, that indicates no user has signed in:</p>

<pre class="prettyprint"><code>    {
        "signin_time":"2024-04-03 18:24.670+0530",
        "user_role":"Manager",
        "user_id":"manager@gmail.com",
        "signout_time":null,
        "authenticatedFactors": 
        {
            "schemaVersion":"1.0",
            "factors":
            [
                {
                    "factor":"FACE", 
                    "factorType":"PRIMARYPRIMARYFACTORY",
                    "status":"EXECUTED",
                }   
                {
                    "factor":"PASSCODE",
                    "factorType":"PRIMARYSECONDARYFACTOR1",
                    "status":"EXECUTED"
                }
            ]
            "eventType":"CurrentUser",
            "lockScreenEventType":"on_unlock"
        }
        "barcode_id":"1709030550634ADFODBD", 
        "signed_in_state":"1"
    }
</code></pre>

<p><strong>Sample <u>authentication results</u> based on the success or failure of primary, secondary, and/or fallback authentication methods:</strong></p>

<ul>
<li><p>Primary authentication is successful, secondary authentication is successful:</p>

<pre class="prettyprint"><code>"factors": [ 
    { 
        "FactorType": "PRIMARYPRIMARYFACTOR", 
        "Status": "EXECUTED" 
    }, 
    { 
        "FactorType": "PRIMARYSECONDARYFACTOR1", 
        "Status": "EXECUTED" 
    } 
],
</code></pre></li>

<li><p>Primary authentication timed out, fallback authentication is successful:</p>

<pre class="prettyprint"><code>"factors": [ 
    { 
        "FactorType": "PRIMARYPRIMARYFACTOR", 
        "Status": "TIMEDOUT" 
    }, 
    { 
        "FactorType": "FALLBACKFACTOR1", 
        "Status": "EXECUTED" 
    } 
],
</code></pre></li>

<li><p>Primary authentication is successful, secondary authentication timed out, fallback authentication timed out:</p>

<pre class="prettyprint"><code>"factors": [ 
    { 
        "FactorType": "PRIMARYPRIMARYFACTOR", 
        "Status": "EXECUTED BUT NOT CONSIDERED" 
    }, 
    { 
        "Factor":"PASSCODE"
        "FactorType": "PRIMARYSECONDARYFACTOR1", 
        "Status": "TIMEDOUT" 
    }, 
    { 
        "FactorType": "FALLBACKFACTOR1", 
        "Status": "EXECUTED" 
    } 
],
</code></pre></li>

<li><p>Primary authentication is successful for SSO, secondary authentication is skipped by user, fallback authentication is successful:</p>

<pre class="prettyprint"><code>"factors": [ 
    { 
        "FactorType": "PRIMARYPRIMARYFACTOR", 
        "Factor":"SSO",
        "Status": "EXECUTED BUT NOT CONSIDERED" 
    }, 
    { 
        "FactorType": "PRIMARYSECONDARYFACTOR1", 
        "Status": "USERSKIPPED" 
    }, 
    { 
        "FactorType": "FALLBACKFACTOR1", 
        "Status": "EXECUTED" 
    } 
],
</code></pre></li>
</ul>

<h3 id="previoussession" class="anchor"><a class="heading-anchor" href="#previoussession"><span></span></a>Previous Session</h3>

<p>Retrieve data from the previous user's session. Data retrieved includes but is not limited to: user ID, role, timestamps for sign in/out and multifactor authentication.</p>

<p>URI = <code>content://com.zebra.mdna.els.provider/previoussession</code></p>

<p>Sample code:</p>

<pre class="prettyprint"><code>    Uri URI_PREVIOUS_USER_SESSION = Uri.parse("content://com.zebra.mdna.els.provider/previoussession");
    Cursor cursor = cr.query(URI_PREVIOUS_USER_SESSION , null, null, null, null);
</code></pre>

<p>The 'cursor' is given in JSON format where each key is accompanied by a series of possible values separated by '/'  and custom values enclosed in '[ ]' in the key-value pair: </p>

<pre class="prettyprint"><code>    {
        "signin_time": "[time stamp]",
        "user_role":"[string]",
        "user_id":"[string]",
        "signout_time":"[time stamp]",
        "authenticationFactors": {
            "SchemaVersion": "1.0"
            "factors":
            [
                {
                    "FactorType": "PRIMARYPRIMARYFACTOR",
                    "Factor": "PASSCODE/FACE/SSO/NO_COMPARISON",                    
                    "Status": "EXECUTED/EXECUTED BUT NOT CONSIDERED/TIMEDOUT"
                },
                {
                    "FactorType": "PRIMARYSECONDARYFACTOR1",
                    "Factor": "PASSCODE/FACE/SSO/NONE",
                    "Status": "TIMEDOUT/USERSKIPPED/EXECUTED"
                },
                {
                    "FactorType": "FALLBACKFACTOR1",
                    "Factor": "PASSCODE/FACE/SSO/ADMINBYPASS/NONE",
                    "Status": "EXECUTED/TIMEDOUT/USERSKIPPED"
                }
            ]
            "EventType": "PreviousUser/CurrentUser",
            "lockScreenEventType": "on_reboot/on_unlock/on_user_change/ac_power_connected/ac_power_disconnected/on_devicemanual_checkin/on_forcelock"
        }
        "barcode_id":"[string]",
        "signed_in_state":"1/0"
    }
</code></pre>

<p><strong>The result from 'cursor' includes an authentication factors section,</strong> which encapsulates an array of authentication factors used in multifactor authentication (MFA) with each factor represented as an object.</p>

<p><strong>The properties returned in the 'cursor' result are:</strong></p>

<ul>
<li><strong>FactorType -</strong> Specifies the level of authentication:


<ul>
<li><strong>PRIMARYPRIMARYFACTOR -</strong> Primary authentication</li>

<li><strong>PRIMARYSECONDARYFACTOR1 -</strong> Secondary authentication</li>

<li><strong>FALLBACKFACTOR1 -</strong> Fallback authentication</li></ul>
</li>

<li><strong>Factor -</strong> Describes the type of authentication:


<ul>
<li><strong>PASSCODE</strong></li>

<li><strong>FACE</strong></li>

<li><strong>SSO</strong></li>

<li><strong>NO_COMPARISON -</strong> Applies to "PRIMARYPRIMARYFACTOR" FactorType</li>

<li><strong>NONE -</strong> Applies to "PRIMARYSECONDARYFACTOR1" and "FALLBACKFACTOR1" FactorType</li></ul>
</li>

<li><strong>Status -</strong> Indicates the current status of authentication:


<ul>
<li><strong>EXECUTED -</strong> Authentication is successful.</li>

<li><strong>EXECUTED BUT NOT CONSIDERED -</strong> Primary authentication was successful but secondary authentication failed.</li>

<li><strong>TIMEDOUT -</strong> The authentication request exceeded the time limit.</li>

<li><strong>USERSKIPPED -</strong> The user opted for fallback authentication, bypassing the SSO login prompt by pressing the back button.</li></ul>
</li>

<li><strong>EventType -</strong> Indicates whether the authentication is for a previous user or the current user. This could be relevant for tracking user sessions or determining access rights:


<ul>
<li><strong>PreviousUser</strong></li>

<li><strong>CurrentUser</strong></li></ul>
</li>

<li><strong>lockScreenEventType -</strong> Specifies the event that triggered the lock screen to appear:


<ul>
<li><strong>on_reboot -</strong> Device rebooted</li>

<li><strong>on_unlock -</strong> User unlocked device</li>

<li><strong>on_user_change -</strong> User signed out and another user signed into the device</li>

<li><strong>ac_power_connected -</strong> Device connected to power</li>

<li><strong>ac_power_disconnected -</strong> Device disconnected from power</li>

<li><strong>on_devicemanual_checkin -</strong> User manually signed out of the device through the "Sign out" button in Identity Guardian (applies to Shared Devices only).</li>

<li><strong>on_forcelock -</strong> Device automatically locked after reaching the specified timeout period.</li></ul>
</li>

<li><strong>signed_in_state -</strong> Specifies whether a user has signed into the device.


<ul>
<li><strong>1 -</strong> A user is signed into the device.</li>

<li><strong>0 -</strong> No user is signed into the device.</li></ul>
</li>
</ul>

<p><strong>Sample return value in JSON string format for 'cursor'.</strong> If 'cursor' is null or empty, that indicates no user has signed in:</p>

<pre class="prettyprint"><code>    {
        "signin_time":"2023-10-04 11:19.338+0530",
        "user_role":"Warehouse",
        "user_id":"John Doe",
        "signout_time":"2023-10-04 11:19.068+0530",
        "authenticatedFactors": 
        {
            "schemaVersion":"1.0",
            "factors":
            [
                {
                    "factor":"FACE", 
                    "factorType":"PRIMARYPRIMARYFACTORY",
                    "status":"EXECUTED",
                }   
                {
                    "factor":"PASSCODE",
                    "factorType":"PRIMARYSECONDARYFACTOR1",
                    "status":"EXECUTED"
                }
            ]
            "eventType":"CurrentUser",
            "lockScreenEventType":"on_unlock"
        }
        "barcode_id":"1693820652113F736CAB", 
        "signed_in_state":"0"
    }
</code></pre>

<p><strong>Sample <u>authentication results</u> based on the success or failure of primary, secondary, and/or fallback authentication methods:</strong></p>

<ul>
<li><p>Primary authentication is successful, secondary authentication is successful:</p>

<pre class="prettyprint"><code>"factors": [ 
    { 
        "FactorType": "PRIMARYPRIMARYFACTOR", 
        "Status": "EXECUTED" 
    }, 
    { 
        "FactorType": "PRIMARYSECONDARYFACTOR1", 
        "Status": "EXECUTED" 
    } 
],
</code></pre></li>

<li><p>Primary authentication timed out, fallback authentication is successful:</p>

<pre class="prettyprint"><code>"factors": [ 
    { 
        "FactorType": "PRIMARYPRIMARYFACTOR", 
        "Status": "TIMEDOUT" 
    }, 
    { 
        "FactorType": "FALLBACKFACTOR1", 
        "Status": "EXECUTED" 
    } 
],
</code></pre></li>

<li><p>Primary authentication is successful, secondary authentication timed out, fallback authentication is successful:</p>

<pre class="prettyprint"><code>"factors": [ 
    { 
        "FactorType": "PRIMARYPRIMARYFACTOR", 
        "Status": "EXECUTED BUT NOT CONSIDERED" 
    }, 
    { 
        "Factor":"PASSCODE"
        "FactorType": "PRIMARYSECONDARYFACTOR1", 
        "Status": "TIMEDOUT" 
    }, 
    { 
        "FactorType": "FALLBACKFACTOR1", 
        "Status": "EXECUTED" 
    } 
],
</code></pre></li>

<li><p>Primary authentication is successful for SSO, secondary authentication is skipped by user, fallback authentication is successful:</p>

<pre class="prettyprint"><code>"factors": [ 
    { 
        "FactorType": "PRIMARYPRIMARYFACTOR", 
        "Factor":"SSO",
        "Status": "EXECUTED BUT NOT CONSIDERED" 
    }, 
    { 
        "FactorType": "PRIMARYSECONDARYFACTOR1", 
        "Status": "USERSKIPPED" 
    }, 
    { 
        "FactorType": "FALLBACKFACTOR1", 
        "Status": "EXECUTED" 
    } 
],
</code></pre></li>
</ul>

<hr>

<h2 id="authenticateuser" class="anchor"><a class="heading-anchor" href="#authenticateuser"><span></span></a>Authenticate User</h2>

<p><strong>Start Authentication</strong> launches Identity Guardian and displays it over any open apps, restricting device access until the user successfully logs in to the device.</p>

<h3 id="startauthentication" class="anchor"><a class="heading-anchor" href="#startauthentication"><span></span></a>Start Authentication</h3>

<p>URI = <code>content://com.zebra.mdna.els.provider/lockscreenaction/startauthentication</code></p>

<p>Sample code:</p>

<pre class="prettyprint"><code>    String BASE_URI = "content://com.zebra.mdna.els.provider/";
    private final String USER_VERIFICATION = "user_verification";
    private final String LAUNCH_FLAG = "launchflag";
    Uri uri = Uri.parse(BASE_URI);

    String METHOD_NAME = "lockscreenaction";
    String API_NAME = "startauthentication";
    ContentResolver cr = getContentResolver();
    Bundle bundle = new Bundle();
    bundle.putString(USER_VERIFICATION, "authenticationScheme1");
    bundle.putString(LAUNCH_FLAG, "blocking");

    Bundle response = cr.call(uri, METHOD_NAME, API_NAME, bundle);
    if (response != null &amp;&amp; response.containsKey("RESULT")) {
        Log.i(TAG, response.getString("RESULT"));
    }
</code></pre>

<p>Possible "user_verification" values:</p>

<ul>
<li>authenticationScheme1</li>

<li>authenticationScheme2</li>

<li>authenticationScheme3</li>

<li>authenticationScheme4</li>
</ul>

<p>Possible "launchflag" values:</p>

<ul>
<li>blocking (The notification bar, system bar, home button, and recent button are disabled and cannot be accessed by the user.)</li>

<li>unblocking</li>
</ul>

<p>Return RESULT:</p>

<ul>
<li>authState: IN_PROGRESS (The device screen is in the process of being locked by Identity Guardian.)</li>

<li>authState: BUSY (The device screen is already locked by another application.)</li>

<li>authState: SUCCESS (The device screen is successfully locked by Identity Guardian.)</li>

<li>authState: ERROR (An exception has occurred.)</li>
</ul>

<hr>

<h2 id="checkappstatus" class="anchor"><a class="heading-anchor" href="#checkappstatus"><span></span></a>Check App Status</h2>

<h3 id="authenticationstatus" class="anchor"><a class="heading-anchor" href="#authenticationstatus"><span></span></a>Authentication Status</h3>

<p>After calling Authenticate User, monitor the Identity Guardian status of screen lock state and user sign in/out by registering for notifications of these state changes. For example, if Identity Guardian launched successfully, will be launched or is launched by another application, listen for these notifications to take further action if needed.</p>

<p>URI: <code>content://com.zebra.mdna.els.provider/lockscreenaction/authenticationstatus</code></p>

<p>Sample code:</p>

<pre class="prettyprint"><code>    Uri uri = Uri.parse(BASE_URI + "lockscreenaction/authenticationstatus");
    ContentResolver cr = getContentResolver();
    Cursor cursor = cr.query(uri, null, null, null, null);
    if (cursor != null){
        Bundle bundle = cursor.getExtras();
        if (bundle != null &amp;&amp; bundle.containsKey("RESULT")) {
            String valueFromBundle = bundle.getString("RESULT");
            Log.i("TAG", "" + valueFromBundle);

        }
    }
</code></pre>

<p>Return RESULT:</p>

<ul>
<li>authState: IN_PROGRESS (The device screen is in the process of being locked by Identity Guardian.)</li>

<li>authState: BUSY (The device screen is already locked by another application.)</li>

<li>authState: SUCCESS (The device screen is successfully locked by Identity Guardian.)</li>

<li>authState: ERROR (An exception has occurred.)</li>
</ul>

<p>Register for application state change (sign in/out, screen lock state):</p>

<pre class="prettyprint"><code>    Uri URI_AUTHENTICATION_STATUS = Uri.parse("content://com.zebra.mdna.els.provider/lockscreenaction/authenticationstatus");
    cr.registerContentObserver(URI_AUTHENTICATION_STATUS,false,contentObserverAuthenticationStatus);
    contentObserverAuthenticationStatus = new ContentObserver(new Handler(getMainLooper())) {

        @Override
        public void onChange(boolean selfChange, Uri uri) {
            super.onChange(selfChange, uri);
            Log.d(TAG, "content has changed, uri = " + uri);
        }
    }
</code></pre>

<p>Return value:</p>

<pre class="prettyprint"><code>    response: {"code":0,"message":"Authenticated user","status":"SUCCESS","userData":{"applicationId":"com.test.lob_testapp_2","barcodeId":"1693820652113F736CAB","userId":"ns4943","userLoggedInState":"SUCCESS","userLoginTime":"2023-10-03 14:42.901+0530","userRole":"Warehouse "}}
</code></pre>

<hr>

<h2 id="whitelistapis" class="anchor"><a class="heading-anchor" href="#whitelistapis"><span></span></a>Whitelist APIs</h2>

<p>Identity Guardian APIs must be whitelisted within your app to enable their use.</p>

<h3 id="prerequisites" class="anchor"><a class="heading-anchor" href="#prerequisites"><span></span></a>Prerequisites</h3>

<ol>
<li><strong>Download <a href="/emdk-for-android/latest/samples/sigtools/">SigTools.jar</a>.</strong> This is used to generate the certificate to create a signature file for security purposes.</li>

<li><strong>Place your .APK app and <a href="/emdk-for-android/latest/samples/sigtools/">SigTools.jar</a> in the same folder</strong> on your host computer.</li>

<li><strong>Download <a href="/stagenow">StageNow</a>.</strong> This is used to create the profile to whitelist the APIs.</li>
</ol>

<h3 id="procedure" class="anchor"><a class="heading-anchor" href="#procedure"><span></span></a>Procedure</h3>

<p>Procedure to whitelist Identity Guardian APIs within your app using StageNow:</p>

<ol>
<li><p>From the commnd line, change the path to the location where your .APK and "SigTools.jar" is located.</p></li>

<li><p>Generate the certificate by running the following command, where "LOB_app.apk" is replaced by the name of your .APK file:</p>

<pre class="prettyprint"><code>java -jar SigTools.jar getcert -inform apk -outform der -in LOB_app.apk -outfile app.crt
</code></pre></li>

<li><p>From your host system, open StageNow and click on <strong>Create New Profile.</strong></p></li>

<li><p>Select the MX version that matches or exceeds the one on your device. Refer to the <a href="/mx/mx-version-on-device/">MX documentation</a> for guidance on how to determine the version.</p></li>

<li><p>Select <strong>Expert Mode</strong> and click <strong>Create.</strong>
<img alt="image" style="height:400px" src="sn-wizard.jpg"></p></li>

<li><p>Enter a profile name and click <strong>Start.</strong>
<img alt="image" style="height:250px" src="sn-profile-name.png"></p></li>

<li><p>Click the plus (+) sign next to <strong>AccessMgr.</strong> This adds AccessMgr to the Config tab on the right side. Click <strong>Add.</strong>
<img alt="image" style="height:450px" src="sn-accessmgr.png"></p></li>

<li><p>Enter/select the following for <strong>AccessMgr:</strong></p>

<ul>
<li><strong>Service Access Action:</strong> Allow Caller to Call Service</li>

<li><strong>Service Identifier:</strong> [Enter the API URI, see step 11. For example: <code>content://com.zebra.mdna.els.provider/lockscreenaction/startauthentication</code>]</li>

<li><strong>Caller Package Name:</strong> [Enter the package name for your .APK app file.]</li>

<li><strong>Caller Signature:</strong> [Browse to the .CRT certificate generated from step 2 above.]
<img alt="image" style="height:450px" src="sn-accessmgr-options.png"></li></ul></li>

<li><p>Click <strong>Continue.</strong></p></li>

<li><p>Click <strong>Complete Profiles.</strong></p></li>

<li><p>Repeat steps 3 to 10 for each API to whitelist in your app, replacing <strong>Service Identifier</strong> with the desired API URI:</p>

<ul>
<li><code>content://com.zebra.mdna.els.provider/lockscreenaction/startauthentication</code> (Start Authentication)</li>

<li><code>content://com.zebra.mdna.els.provider/previoussession</code> (Previous User Session)</li>

<li><code>content://com.zebra.mdna.els.provider/currentsession</code> (Current User Session)</li>

<li><code>content://com.zebra.mdna.els.provider/lockscreenaction/authenticationstatus</code> (Authentication Status)</li>

<li><code>content://com.zebra.mdna.els.provider/lockscreenaction/logout</code> (Logout)</li></ul></li>
</ol>

<p>After creating the StageNow profiles, use one of the following methods based on the desired tool for device deployment:</p>

<ul>
<li><strong>StageNow:</strong> Generate the barcode from the StageNow profile. Open StageNow client on the device and scan the barcode(s) generated from the installation, configuration and/or BLE profile.</li>

<li><strong>EMM:</strong> Export each StageNow XML file from the StageNow installation, connection and BLE profiles. <em>Do not edit the XML file</em> - it can cause unexpected behavior. Send the XML using either <a href="/oemconfig">OEMConfig</a> or <a href="/mx/overview/">MX</a> to configure the app and grant all required permissions. The installation profile and server connectivity profile XML files must be used separately.</li>
</ul>

<hr>

<h2 id="developerguide" class="anchor"><a class="heading-anchor" href="#developerguide"><span></span></a>Developer Guide</h2>

<p>For in-depth guidance on use of Identity Guardian APIs, refer to the blog post <a href="https://developer.zebra.com/blog/mastering-identity-guardians-apis">Mastering Identity Guardian APIs</a> written by a Zebra developer, along with the corresponding <a href="https://github.com/ZebraDevs/kotlin-identity-guardian-playground">sample app</a>.</p>

<hr>

<h2 id="seealso" class="anchor"><a class="heading-anchor" href="#seealso"><span></span></a>See Also</h2>

<ul>
<li><a href="../about">About Identity Guardian</a></li>

<li><a href="../licensing/">Licensing</a></li>

<li><a href="../setup">Setup</a></li>

<li><a href="../usage">User Guide</a></li>

<li><a href="../mc">Managed Configurations</a></li>
</ul><p></p>
                                        


                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div><!--/.col-sm-6-->
            </div>
            </section>
        </div>
    </section>    

<div class="modal fade" id="basicModal" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true" data-backdrop="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
					</div>
					<div class="modal-body">
						<div id="modalImg">
						
						</div>
					</div>
			</div>
		  </div>
		</div> </div>
         <footer id="footer">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-sm-10">
                        ZEBRA and the stylized Zebra head are trademarks of Zebra Technologies Corp., registered in many jurisdictions worldwide. All other trademarks are the property of their respective owners. ©2024 Zebra Technologies Corp. and/or its affiliates.<br> <a href="https://www.zebra.com/us/en/about-zebra/company-information/legal.html">Legal</a> | <a href="https://www.zebra.com/us/en/about-zebra/company-information/compliance/information-privacy/terms-of-use.html">Terms of Use</a> | <a href="https://www.zebra.com/us/en/about-zebra/company-information/legal/privacy-statement.html">Privacy Policy</a> 
                    </div>
                     <!--
                     <div class="col-sm-2">
                        <ul class="social-icons">
                            <li><a href="http://www.facebook.com/pages/Zebra-Technologies/107703715989073"><i class="fa fa-facebook"></i></a></li>
                            <li><a href="https://twitter.com/ZebraDevs"><i class="fa fa-twitter"></i></a></li>
                            <li><a href="http://www.youtube.com/zebratechnologies/"><i class="fa fa-youtube"></i></a></li>
                            <li><a href="https://www.linkedin.com/groups?home=&gid=3220074&trk=anet_ug_hm&goback=%2Egmr_3220074"><i class="fa fa-linkedin"></i></a></li>
                            <li><a href="https://github.com/developer-zebra"><i class="fa fa-github"></i></a></li>
                        </ul>
                    </div> -->
                 </div>
            </div>
        </footer>
    
    <!--/#footer 
        10/25/18 removed <footer id="footer" class="navbar-fixed-bottom">
    -->
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/owl.carousel.min.js"></script>
    <script src="/js/mousescroll.js"></script>
    <script src="/js/smoothscroll.js"></script>
    <script src="/js/jquery.prettyPhoto.js"></script>
    <script src="/js/jquery.isotope.min.js"></script>
    <script src="/js/jquery.inview.min.js"></script>
    <script src="/js/wow.min.js"></script>
    <script src="/js/bootstrap-treenav.min.js"></script>
    <script src="/js/prettify.js"></script>
    <script src="/js/zepto.js"></script>
    <script src="/js/jquery.waterfall.js"></script>   
    <script src="/js/main.js"></script>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','zRzEsAUhWTTkrdEN2YfA','2.0.0');
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-72584442-1', 'auto');
  ga('send', 'pageview');

</script> 

<script>
    ChatraID = 'QDvZ76min4DhLW5vJ';
    (function(d, w, c) {
        var n = d.getElementsByTagName('script')[0],
            s = d.createElement('script');
        w[c] = w[c] || function() {
            (w[c].q = w[c].q || []).push(arguments);
        };
        s.async = true;
        s.src = (d.location.protocol === 'https:' ? 'https:': 'http:')
            + '//call.chatra.io/chatra.js';
        n.parentNode.insertBefore(s, n);
    })(document, window, 'Chatra');
</script>         


</body></html>