
<!DOCTYPE html>
<html lang="en"><head>

    <meta charset="utf-8">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="-1">
    <meta http-equiv="CACHE-CONTROL" content="NO-CACHE">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Online Documentation for Zebra Technologies developer tools and utilties, including EMDK for Android, EMDK for Xamarin, StageNow and Enterprise Browser.">
    <meta name="author" content="Zebra Technologies">
    <meta name="google-site-verification" content="i4B78BrWnNy8ShJwe5feRW3jO3HE6gfYlYqYbxfl8yY">
    <meta name="msvalidate.01" content="6B651B00161BCE79B8950AC09D5C4C75">
    <meta title="APIs">
    <title>APIs - TechDocs</title>
    <!-- core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
<!--     
    <link href="/css/font-awesome.min.css" rel="stylesheet">
 -->    
    <link href="/css/all.css" rel="stylesheet">
    <link href="/css/v4-shims.css" rel="stylesheet">
    <link href="/css/animate.min.css" rel="stylesheet">
    <link href="/css/owl.carousel.css" rel="stylesheet">
    <link href="/css/owl.transitions.css" rel="stylesheet">
    <link href="/css/prettyPhoto.css" rel="stylesheet">
    <link href="/css/main.css" rel="stylesheet">
    <link href="/css/responsive.css" rel="stylesheet">
    <link href="/css/prettify.css" rel="stylesheet">
    <link href="/css/bootstrap-treenav.min.css" rel="stylesheet">
    <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
    <script src="js/respond.min.js"></script>
    <![endif]--> 

    <!-- 6/13/24- a "crown" icon randomly appeared in the MX matrix today. Rob said it looked like sumo. 
        <script src="//load.sumome.com/" data-sumo-site-id="699cb66cf4dc59352efb45705526d15cbe314e1cd43f7761b94d96f3cf7338e8" async="async"></script> -->
    <link rel="shortcut icon" href="/favicon.ico">
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-01QJCMQM9N"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-01QJCMQM9N');
</script><script src="/js/jquery.js"></script></head><!--/head-->

<!-- Google tag -->





<body id="home" class="homepage" data-spy="scroll" data-offset="100" data-target="#toc">

    <header id="header">
        <nav id="main-menu" class="navbar navbar-default navbar-fixed-top" role="banner">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/"><img src="/images/logo.png" alt="logo" style="max-height:66px;float: inherit;
    padding-right: 3px;"></a> 
                    
                   
                </div>
                <div class="collapse navbar-collapse navbar-left">
                    <ul class="nav navbar-nav">
                        <li class="navbar-text pull-left"><strong>TechDocs</strong></li>
                        <p class="navbar-text">
                                            Identity Guardian
                                            1.6
                        </p>

                    </ul>
                </div>
                <div class="collapse navbar-collapse navbar-right">
                    <ul class="nav navbar-nav">
                        


                        <li>
                            <a href="/identityguardian/1-6/about">
                                    About
                            </a>
                        </li>
                        <li>
                            <a href="/identityguardian/1-6/setup">
                                    Setup
                            </a>
                        </li>
                        <li>
                            <a href="/identityguardian/1-6/licensing">
                                    Licensing
                            </a>
                        </li>
                        <li>
                            <a href="/identityguardian/1-6/mc">
                                    Managed Configurations
                            </a>
                        </li>
                        <li>
                            <a href="/identityguardian/1-6/usage">
                                    User Guide
                            </a>
                        </li>
                        <li>
                            <a href="/identityguardian/1-6/api">
                                    APIs
                            </a>
                        </li>
                        <li>
                            <a href="/identityguardian/1-6/faq">
                                    FAQ
                            </a>
                        </li>
                        <li>
                            <a href="/identityguardian/1-6/search">
                                    <i class="fa fa-search"></i>
                            </a>
                        </li>
                        
                        <!-- <li ><a href="/products">SDKs</a></li>
                        <li ><a href="/samples">Samples</a></li>
                        <li ><a href="/guides">Guides</a></li>
                        <li ><a href="/tutorials">Tutorials</a></li>
                        <li ><a href="/apis">APIs</a></li> -->
                        <!-- <li><a href="#"><input type="text" class="st-default-search-input"></a></li> -->
                    </ul>
                </div>
            </div><!--/.container-->
        </nav><!--/nav-->
    </header><!--/header-->
<div class="container-fluid">
    <section id="blog">
        <div class="">
            <section class="content-with-sidebar">
            <div class="row">
                <div class="col-sm-3 hidden-sm hidden-xs" id="sidebar">
                    
                    
                    <nav id="toc" data-toggle="toc" data-spy="affix" style="height: 75%; max-width: 225px; overflow-y: auto; ">
                        
                        <ul class="nav">
                            <li><strong>APIs</strong></li>
                        </ul>
                    </nav>
                    <div class="modal fade" id="modal-smartdocs" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true" data-backdrop="true">
                    	<div class="modal-dialog">
                    		<div class="modal-content">
                    			<div class="modal-header">
                    				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
                    			</div>
                    			<div class="modal-body">
                    				<form>
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">MX Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="4.0">4.0</option>
                    					  <option value="4.1">4.1</option>
                    					  <option value="4.2">4.2</option>
                    					  <option value="4.3">4.3</option>
                    					  <option value="5.0">5.0</option>
                    					</select>
                    				  </div>						
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">OSX Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="1.0">1.0</option>
                    					  <option value="1.2">1.2</option>
                    					  <option value="1.3.4-56">1.3.4-56</option>
                    					  <option value="3.4">3.4</option>
                    					  <option value="3.5">3.5</option>
                    					  <option value="3.6">3.6</option>
                    					  <option value="4.1">4.1</option>
                    					  <option value="4.2">4.2</option>
                    					  <option value="4.3">4.3</option>
                    					  <option value="4.4">4.4</option>
                    					</select>
                    				  </div>						
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">Android Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="23">6.0 Marshmallow</option>
                    					  <option value="22">5.1 Lollipop</option>
                    					  <option value="21">5.0 Lollipop</option>
                    					  <option value="19">4.4 Kitkat</option>
                    					  <option value="18">4.3 Jellybean</option>
                    					  <option value="17">4.2.x Jellybean</option>
                    					  <option value="16">4.1.x Jellybean</option>
                    					  <option value="15">4.0.3-4.0.4 Ice Cream Sandwich</option>
                    					  <option value="14">4.0-4.0.2 Ice Cream Sandwich</option>
                    					  <option value="10">2.3.3-2.3.4 Gingerbread</option>
                    					</select>
                    				  </div>
                    				  <div class="form-group">
                    				  	<button class="primary" id="btn_SaveSmartDocOptions">Save Changes</button><button class="primary" id="btn_ClearSmartDocOptions">Clear Changes</button>
                    				  </div>
                    				</form>
                    			</div>
                    	</div>
                      </div>
                    </div>
                    
                    <script type="text/javascript">
                        $(document).ready(function() {
                        	$( "#btn_SaveSmartDocOptions" ).click(function() {
                      			console.log('Saving Options');
                      			$("#modal-smartdocs").modal({show: false});
                    		});
                        	$( "#btn_SaveSmartDocOptions" ).click(function() {
                      			console.log('Clearing Options');
                      			$("#modal-smartdocs").modal({show: false});
                    		});
                        });
                    </script><link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.3.0/dist/bootstrap-toc.min.css">
                    <script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.3.0/dist/bootstrap-toc.min.js"></script>
                    <script type="text/javascript">
                        $(document).ready(function() {
                    
                        });
                    
                    
                    </script>
                </div>                
                <div class="col-sm-9 ">
                    <div class="row">
                        <div class="col-sm-12">
                            <section id="cta" class="wow fadeIn">
                                <div class="">
                                    <h1 id="apis" class="anchor"><a class="heading-anchor" href="#apis"><span></span></a>APIs</h1>
                                    <p>
                                            Identity Guardian
                                            1.6
                                    </p>
                                </div>
                            </section>                    
                        </div>
                    </div>
                    <div id="mainContent" class="row">
                        <div class="col-sm-12">
                            <div class="blog-post blog-large wow fadeInLeft" data-wow-duration="300ms" data-wow-delay="0ms">
                            <!-- Start of guide -->
                                <div class="service-box wow fadeInRight">
                                    <div class="">

                                        <p></p><h2 id="overview" class="anchor"><a class="heading-anchor" href="#overview"><span></span></a>Overview</h2>

<p>This guide discusses the APIs provided by <strong>Identity Guardian,</strong> which uses a content provider interface to securely retrieve and share data between applications. The content provider URI is composed of four distinct parts: <code>&lt;Scheme:&gt;//&lt;Authority&gt;/&lt;API&gt;/&lt;Data&gt;</code></p>

<ul>
<li><strong>Scheme -</strong> Identifies the URI accessing a content source, typically represented as: <code>content://</code>.</li>

<li><strong>Authority -</strong> The name of the provider authority, usually in the forma <code>packagename.provider</code>.</li>

<li><strong>API -</strong> The path that differentiates the content data.</li>

<li><strong>Data -</strong> The key that points to specific data in the path.</li>
</ul>

<p>Example of content provider URI: &nbsp;&nbsp;<span style="font-family:'Courier New'">content://com.zebra.mdna.els.provider/&lt;API&gt;/&lt;data&gt;</span></p>

<p>Replace <code>&lt;API&gt;</code> and <code>&lt;data&gt;</code> with the appropriate string for specific use cases.</p>

<h3 id="apis-1" class="anchor"><a class="heading-anchor" href="#apis-1"><span></span></a>APIs</h3>

<h4 id="currentapis" class="anchor"><a class="heading-anchor" href="#currentapis"><span></span></a>Current APIs</h4>

<table class="facelift" style="width:100%" border="1" padding="5px">
  <tbody><tr bgcolor="#dce8ef">
    <th>API Name</th>
    <th>Description</th>
    <th>Usage Context</th>
  </tr>

  <tr>
       <td><a href="#registerfornotifications">Register for Notifications</a></td>
    <td>Enables applications to receive notifications of user changes.</td>
    <td>Applicable when Identity Guardian is used for user authentication at either the device or application level.</td>
  </tr>

  <tr>
       <td><a href="#getcurrentusersession">Get Current User Session</a></td>
    <td>Retrieves information about the current user session.</td>
    <td>Applicable when Identity Guardian is used for user authentication at either the device or application level.</td>
  </tr>

  <tr>
       <td><a href="#getprevioususersession">Get Previous User Session</a></td>
    <td>Retrieves information about the previous user session.</td>
    <td>Applicable when Identity Guardian is used for user authentication at either the device or application level.</td>
  </tr>

  <tr>
       <td><a href="#setcurrentusersession">Set Current User Session</a></td>
    <td>Notifies Identity Guardian of user sign-in/sign-out events when third-party apps are used to block the device screen instead of Identity Guardian. This is applicable when <a href="../usage/#proxymode">Proxy Mode</a> is enabled.</td>
    <td>Applicable for organizations using custom blocking screen apps for device access, aiming to track user activity across Zebra apps.</td>
  </tr>

  <tr>
    <td><a href="#startauthentication">Start Authentication</a></td>
    <td>Activates Identity Guardian’s user authentication screen to confirm user credentials for device access.</td>
    <td>Used when Identity Guardian is employed for application-level authentication instead of device-level.</td>
  </tr>

  <tr>
       <td><a href="#getauthenticationstatus">Get Authentication Status</a></td>
    <td>Retrieves information about the Identity Guardian lock screen state.</td>
    <td>Applicable when Identity Guardian is used for user authentication at either the device or application level.</td>
  </tr>

  <tr>
       <td><a href="#lockscreenmessage">Lock Screen Message</a></td>
    <td>Displays a message on the Identity Guardian lock screen to notify users of important information.</td>
    <td>Applicable when Identity Guardian is used for user authentication at either the device or application level.</td>
  </tr>

  <tr>
       <td><a href="#logoutuser">Logout User</a></td>
    <td>Enables applications to terminate the current user session and lock the screen.</td>
    <td>Applicable when Identity Guardian is used for user authentication at either the device or application level.</td>
  </tr>

</tbody></table>

<h4 id="legacyapis" class="anchor"><a class="heading-anchor" href="#legacyapis"><span></span></a>Legacy APIs</h4>

<table class="facelift" style="width:100%" border="1" padding="5px">
  <tbody><tr bgcolor="#dce8ef">
    <th>API Name</th>
    <th>Description</th>
    <th>Usage Context</th>
  </tr>

  <tr>
       <td><a href="#getcurrentusersessionlegacy">Get Current User Session (Legacy)</a></td>
    <td>Retrieves information about the current user session.</td>
    <td>Applicable when Identity Guardian is used for user authentication at either the device or application level.</td>
  </tr>

</tbody></table>

<hr>

<h2 id="requirements" class="anchor"><a class="heading-anchor" href="#requirements"><span></span></a>Requirements</h2>

<ul>
<li><p><strong>Modify AndroidManifest.xml:</strong> In your application's AndroidManifest.xml, include the necessary permission and the <code>&lt;queries&gt;</code> tag to specify the Identity Guardian package name:</p>

<pre class="prettyprint"><code>&lt;uses-permission android:name="com.zebra.mdna.els.permission.PROVIDER" /&gt;
&lt;queries&gt;
    &lt;package android:name="com.zebra.mdna.els" /&gt;
&lt;/queries&gt;
</code></pre></li>

<li><p><strong>Allowlist Your App:</strong> For security, your app must be on Identity Guardian's allowlist using <a href="/mx/accessmgr">AccessMgr CSP</a> from <a href="/flux/about">Zebra Device Manager (ZDM)</a>. Create a profile via <a href="/stagenow">StageNow</a> to configure your app's allowlist. Set the following parameters:</p>

<ul>
<li><strong>Operation Mode:</strong> "Single User without Whitelist"</li>

<li><strong>Service Access Action</strong>: "Allow Caller to Call Service"</li>

<li><strong>Service Identifier</strong>: &lt;delegation scope of the API category&gt;</li>

<li><strong>Specify Caller Package Name</strong>: &lt;enter app package name, e.g.: com.company.appname&gt;</li>

<li><strong>Caller Signature</strong>: &lt;select signature file that contains the app certificate&gt;</li></ul>

<p>For information on generating a signature file, see <a href="/mx/accessmgr/#caller-signature">Caller Signature</a> in the Access Mgr CSP documentation. After creating the StageNow profile, use StageNow to scan the generated barcode or deploy the XML file via Enterprise Mobility Management (EMM) software.</p></li>

<li><p><strong>Add APIs to Your App's Allowlist:</strong> Identity Guardian APIs must be added to your application's allowlist.</p>

<p><strong>Prerequisites:</strong></p>

<ul>
<li><strong>Download <a href="/emdk-for-android/latest/samples/sigtools/">SigTools.jar</a>.</strong> This is used to generate the certificate to create a signature file for security purposes.</li>

<li><strong>Place your .APK app and <a href="/emdk-for-android/latest/samples/sigtools/">SigTools.jar</a> in the same folder</strong> on your host computer.</li>

<li><strong>Download <a href="/stagenow">StageNow</a>.</strong> This is used to create the profile to allowlist the APIs.</li></ul>

<p><strong>Procedure:</strong></p>

<p>To allowlist Identity Guardian APIs in your app using StageNow:</p>

<ol>
<li><p>From the command line, navigate to the directory containing your .APK and "SigTools.jar.".</p></li>

<li><p>Generate the certificate by executing the following command, replacing "LOB_app.apk" with your .APK file's name:</p>

<pre class="prettyprint"><code>java -jar SigTools.jar getcert -inform apk -outform der -in LOB_app.apk -outfile app.crt
</code></pre></li>

<li><p>From your host system, open StageNow and click on <strong>Create New Profile.</strong></p></li>

<li><p>Select the MX version that matches or exceeds the one on your device. Refer to the <a href="/mx/mx-version-on-device/">MX documentation</a> for guidance on how to determine the version.</p></li>

<li><p>Select <strong>Expert Mode</strong> and click <strong>Create.</strong>
<img alt="image" style="height:400px" src="sn-wizard.jpg"></p></li>

<li><p>Enter a profile name and click <strong>Start.</strong>
<img alt="image" style="height:250px" src="sn-profile-name.png"></p></li>

<li><p>Click the plus (+) sign next to <strong>AccessMgr.</strong> This adds AccessMgr to the Config tab on the right side. Click <strong>Add.</strong>
<img alt="image" style="height:450px" src="sn-accessmgr.png"></p></li>

<li><p>Enter/select the following for <strong>AccessMgr:</strong></p>

<ul>
<li><strong>Service Access Action:</strong> Allow Caller to Call Service</li>

<li><strong>Service Identifier:</strong> [Enter the API URI, see step 11. For example: <code>content://com.zebra.mdna.els.provider/lockscreenaction/startauthentication</code>]</li>

<li><strong>Caller Package Name:</strong> [Enter the package name for your .APK app file.]</li>

<li><strong>Caller Signature:</strong> [Browse to the .CRT certificate generated from step 2 above.]
<img alt="image" style="height:450px" src="sn-accessmgr-options.png"></li></ul></li>

<li><p>Click <strong>Continue.</strong></p></li>

<li><p>Click <strong>Complete Profiles.</strong></p></li>

<li><p>Repeat steps 3 to 10 for each API to allowlist in your app, replacing <strong>Service Identifier</strong> with the desired API URI:</p>

<ul>
<li><span style="font-family:'Courier New'">content://com.zebra.mdna.els.provider/lockscreenaction/startauthentication</span> (Start Authentication)</li>

<li><span style="font-family:'Courier New'">content://com.zebra.mdna.els.provider/previoussession</span> (Previous User Session)</li>

<li><span style="font-family:'Courier New'">content://com.zebra.mdna.els.provider/currentsession</span> (Current User Session)</li>

<li><span style="font-family:'Courier New'">content://com.zebra.mdna.els.provider/lockscreenaction/authenticationstatus</span> (Authentication Status)</li>

<li><span style="font-family:'Courier New'">content://com.zebra.mdna.els.provider/lockscreenaction/logout</span> (Logout)</li></ul></li></ol>

<p>After creating the StageNow profiles, use one of the following methods based on the desired tool for device deployment:</p>

<ul>
<li><strong>StageNow:</strong> Generate the barcode from the StageNow profile. Open StageNow client on the device and scan the barcode(s) generated from the installation, configuration and/or BLE profile.</li>

<li><strong>EMM:</strong> Export each StageNow XML file from the StageNow installation, connection and BLE profiles. <em>Do not edit the XML file</em> - it can cause unexpected behavior. Send the XML using either <a href="/oemconfig">OEMConfig</a> or <a href="/mx/overview/">MX</a> to configure the app and grant all required permissions. The installation profile and server connectivity profile XML files must be used separately.</li></ul></li>
</ul>

<hr>

<h2 id="registerfornotifications" class="anchor"><a class="heading-anchor" href="#registerfornotifications"><span></span></a>Register for Notifications</h2>

<p><strong>Description:</strong> Register to receive notifications about the locked/unlocked status of Identity Guardian during user sign in/out events. This API should be registered in the <code>onCreate()</code> method and unregistered in the <code>onDestroy()</code> method.</p>

<p><strong>Content URI:</strong> &nbsp;&nbsp;<span style="font-family:'Courier New'">content://com.zebra.mdna.els.provider/lockscreenstatus/state</span></p>

<p><strong>Response:</strong> Returns a JSON string indicating the device's lock status:</p>

<ul>
<li><strong>HIDDEN -</strong> Indicates that the device is unlocked and a user is currently logged in.</li>

<li><strong>SHOWN -</strong> indicates that the device is locked and no user is logged in.</li>
</ul>

<h4 id="samplecode" class="anchor"><a class="heading-anchor" href="#samplecode"><span></span></a>Sample Code</h4>

<pre class="prettyprint"><code>    Uri URI_CURRENT_LOCKSCREEN_STATE = Uri.parse("content://com.zebra.mdna.els.provider/lockscreenstatus/state");
    cr.registerContentObserver(URI_CURRENT_LOCKSCREEN_STATE, false, contentObserverLockScreenState);
    contentObserverLockScreenState = new ContentObserver(new Handler(getMainLooper())) {

        @Override
        public void onChange(boolean selfChange, Uri uri) {
            super.onChange(selfChange, uri);
            Log.d(TAG, "content has changed, uri = " + uri);
            new Thread(new Runnable() {
                @Override
                public void run() {
                    getCurrentLockScreenStateOfDevice();
                }
            }).start();

        }
    };
</code></pre>

<h4 id="sampleresponse" class="anchor"><a class="heading-anchor" href="#sampleresponse"><span></span></a>Sample Response</h4>

<pre class="prettyprint"><code>    {
        state: “SHOWN”, 
        lastchangedtimestamp:”MM:DD:YY HH:MM:SS”
    }
</code></pre>

<hr>

<h2 id="getusersession" class="anchor"><a class="heading-anchor" href="#getusersession"><span></span></a>Get User Session</h2>

<p>Retrieve session data associated with the current or previous user. <em><strong>When the device is in a locked state, these APIs are functional if the lock state is activated by specific device system events,</strong> <u>not</u> by an application triggering the lock state.</em> The lock screen can be activated by the following device system events, based on <a href="../mc/#authenticationconfiguration">Authentication Configuration</a>:</p>

<ul>
<li>Unlocking the device (OnUnlock)</li>

<li>Rebooting the device (OnReboot)</li>

<li>Connecting the device to AC power (OnACPowerConnected)</li>

<li>Disconnecting the device from AC power (OnACPowerDisconnected)</li>
</ul>

<p>An application can activate the lock screen by invoking <a href="#startauthentication">Start Authentication</a>.</p>

<h3 id="getcurrentusersession" class="anchor"><a class="heading-anchor" href="#getcurrentusersession"><span></span></a>Get Current User Session</h3>

<p><strong>Description:</strong> This API uses a content URI to access data from the current user session. It retrieves the cursor’s extras and extracts the result string from the extras bundle. If the result string is not empty, it must be parsed into a JSON object since that is the expected format for the result.</p>

<blockquote>
  <p><i class="fa fa-exclamation-triangle" style="color:#FFA500;"></i> <b>Note:</b> Zebra recommends using this API instead of the <a href="#getcurrentusersessionlegacy">Get Current User Session (Legacy)</a> API.</p>
</blockquote>

<p><strong>Content URI:</strong> &nbsp;&nbsp;<span style="font-family:'Courier New'">content://com.zebra.mdna.els.provider/v2/currentsession</span></p>

<p><strong>Input Keys:</strong> None</p>

<p><strong>Response:</strong> A Cursor object in JSON string format that contains the required bundle. A null or empty cursor indicates that no user is signed into the device.</p>

<p>This table details the key/value pairs returned in the response. The "Supported Mode" depends on the <strong>Application Mode</strong> configured for the <a href="../mc/#usagemode">Usage Mode</a> under Managed Configurations.</p>

<table class="facelift" style="width:95%" border="1" padding="5px">
  <tbody><tr bgcolor="#dce8ef">
    <th>Key</th>
    <th>Type</th>
    <th>Supported Mode</th>
    <th>Description/Value (Authentication Mode)</th>
    <th>Description/Value (Proxy Mode)</th>
  </tr>

  <tr>
    <td>authenticationFactors</td>
    <td>JSON object</td>
    <td>Authentication Mode</td>
    <td>[Returns authentication factor details. See <a href="#sampleauthenticationresults">Sample Authentication Results</a> below.]</td>
    <td style="background-color:#d1cccb;">N/A</td>
  </tr>

  <tr>
    <td>adminByPassFactors</td>
    <td>Array</td>
    <td>Authentication Mode</td>
    <td>[Returns authentication factor details. See <a href="#sampleauthenticationresults">Sample Authentication Results</a> below.]</td>
    <td style="background-color:#d1cccb;">N/A</td>
  </tr>

  <tr>
    <td>alternateFactors</td>
    <td>Array</td>
    <td>Authentication Mode</td>
    <td>[Returns authentication factor details. See <a href="#sampleauthenticationresults">Sample Authentication Results</a> below.]</td>
    <td style="background-color:#d1cccb;">N/A</td>
  </tr>

  <tr>
    <td>factor</td>
    <td>String</td>
    <td>Authentication Mode</td>
    <td>Specifies the type of authentication used:<br>&nbsp;&nbsp;&nbsp;• <b>PASSCODE</b><br>&nbsp;&nbsp;&nbsp;• <b>FACE</b><br>&nbsp;&nbsp;&nbsp;• <b>SSO</b><br>&nbsp;&nbsp;&nbsp;</td>
    <td style="background-color:#d1cccb;">N/A</td>
  </tr>

  <tr>
    <td>factorType</td>
    <td>String</td>
    <td>Authentication Mode</td>
    <td>Defines the level of authentication used: <br>&nbsp;&nbsp;&nbsp;• <b>PRIMARYPRIMARYFACTOR -</b> Primary authentication<br>&nbsp;&nbsp;&nbsp;• <b>PRIMARYSECONDARYFACTOR1 -</b> Secondary authentication<br>&nbsp;&nbsp;&nbsp;• <b>FALLBACKFACTOR1 -</b>Fallback authentication</td>
    <td style="background-color:#d1cccb;">N/A</td>
  </tr>

  <tr>
    <td>status</td>
    <td>String</td>
    <td>Both</td>
    <td>Current authentication status: <br><b>&nbsp;&nbsp;&nbsp;• EXECUTED -</b>  Successful authentication<br><b>&nbsp;&nbsp;&nbsp;• EXECUTED BUT NOT CONSIDERED -</b> Primary authentication was successful but secondary authentication failed<br><b>&nbsp;&nbsp;&nbsp;• TIMEDOUT -</b> The authentication request timed out<br><b>&nbsp;&nbsp;&nbsp;• USERSKIPPED -</b>The user bypassed the SSO login prompt by pressing the back button, resulting to fallback authentication</td>
    <td>Current authentication status: <br><b>&nbsp;&nbsp;&nbsp;• SUCCESS -</b> Successful authentication<br><b>&nbsp;&nbsp;&nbsp;• FAILED -</b> Unsuccessful authentication</td>
  </tr>

  <tr>
    <td>eventType</td>
    <td>String</td>
    <td>Both</td>
    <td>Specifies the event that occurred: <br><b>&nbsp;&nbsp;&nbsp;• Login -</b> The user logged in to the device<br><b>&nbsp;&nbsp;&nbsp;• Logout -</b> The user logged out from the device</td>
    <td>Specifies the event that occurred: <br><b>&nbsp;&nbsp;&nbsp;• Login -</b> The user logged in to the device<br><b>&nbsp;&nbsp;&nbsp;• Logout -</b> The user logged out from the device</td>
  </tr>

  <tr>
    <td>isSSOInformationAvailable</td>
    <td>Boolean</td>
    <td>Both</td>
    <td>Availability of Single Sign-On (SSO) data: <b>&nbsp;&nbsp;&nbsp;• 1 -</b>  SSO information is available; <code>ssoInformation</code> can be parsed for details<br><b>&nbsp;&nbsp;&nbsp;• 0 -</b> SSO information is not available<br></td>
    <td>[Empty value returned]</td>
  </tr>

  <tr>
    <td>schemaVersion</td>
    <td>String</td>
    <td>Both</td>
    <td>[Version of the authentication factors schema]</td>
    <td>[Version of the authentication factors schema]</td>
  </tr>

  <tr>
    <td>userLoggedInState</td>
    <td>Integer</td>
    <td>Both</td>
    <td>User login status on the device: <br><b>&nbsp;&nbsp;&nbsp;• 1 -</b> The user is signed in or has checked out the device, updating the userLoginTime<br><b>&nbsp;&nbsp;&nbsp;• 0 -</b> The user is signed out or has checked in the device, updating the userLogoutTime<br></td>
    <td>User login status on the device:<br><b>&nbsp;&nbsp;&nbsp;• 1 -</b> The user is signed in or has checked out the device, updating the userLoginTime<br><b>&nbsp;&nbsp;&nbsp;• 0 -</b> The user is signed out or has checked in the device, updating the userLogoutTime<br></td>
  </tr>

  <tr>
    <td>userId</td>
    <td>String</td>
    <td>Both</td>
    <td>[Identifier for the user signed into the device, e.g., user1@zebra.com]</td>
    <td>[Identifier for the user signed into the device, e.g., user1@zebra.com]</td>
  </tr>

  <tr>
    <td>enrollmentInformation</td>
    <td>JSON object</td>
    <td>Authentication Mode</td>
    <td>[Parent key]</td>
    <td style="background-color:#d1cccb;">N/A</td>
  </tr>

  <tr>
    <td>enrollmentCreatedOn</td>
    <td>Long</td>
    <td>Authentication Mode</td>
    <td>[Timestamp when the barcode was created, in EPOCH time, e.g., 1737983880029]</td>
    <td style="background-color:#d1cccb;">N/A</td>
  </tr>

  <tr>
    <td>enrollmentCreatedOnDeviceModel</td>
    <td>String</td>
    <td>Authentication Mode</td>
    <td>[Device model on which the barcode was created, e.g., TC58]</td>
    <td style="background-color:#d1cccb;">N/A</td>
  </tr>

  <tr>
    <td>enrollmentCreatedOnDeviceSerialNo</td>
    <td>String</td>
    <td>Authentication Mode</td>
    <td>[Serial number of device where the barcode was created]</td>
    <td style="background-color:#d1cccb;">N/A</td>
  </tr>

  <tr>
    <td>enrollmentExpiryDate</td>
    <td>Long</td>
    <td>Authentication Mode</td>
    <td>[Expiration date of the barcode, in EPOCH time, e.g., 1738156680000]</td>
    <td style="background-color:#d1cccb;">N/A</td>
  </tr>

  <tr>
    <td>enrollmentId</td>
    <td>String</td>
    <td>Authentication Mode</td>
    <td>[Unique identifier for the barcode, e.g., 1237983906027D4BA34E]</td>
    <td style="background-color:#d1cccb;">N/A</td>
  </tr>

  <tr>
    <td>enrollmentType</td>
    <td>String</td>
    <td>Authentication Mode</td>
    <td>Type of enrollment: <br>&nbsp;&nbsp;&nbsp;• <b>BARCODE</b><br>&nbsp;&nbsp;&nbsp;• <b>DEVICE</b></td>
    <td style="background-color:#d1cccb;">N/A</td>
  </tr>

  <tr>
    <td>securityTypes</td>
    <td>String</td>
    <td>Authentication Mode</td>
    <td>Types of security mechanism in use: <br>&nbsp;&nbsp;&nbsp;• <b>FACE</b><br>&nbsp;&nbsp;&nbsp;• <b>PASSCODE</b><br>&nbsp;&nbsp;&nbsp;• <b>SSO</b></td>
    <td style="background-color:#d1cccb;">N/A</td>
  </tr>

  <tr>
    <td>storageType</td>
    <td>String</td>
    <td>Authentication Mode</td>
    <td>Type of storage used for authentication:<br>&nbsp;&nbsp;&nbsp;• <b>BARCODE -</b> For shared devices<br><b>&nbsp;&nbsp;&nbsp;• DEVICE -</b> For personal devices</td>
    <td style="background-color:#d1cccb;">N/A</td>
  </tr>

  <tr>
    <td>logOutInformation</td>
    <td>JSON object</td>
    <td>Both</td>
    <td>[Parent key]</td>
    <td>[Parent key - Visibly only when a user signs in under Proxy Mode]</td>
  </tr>

  <tr>
    <td>logoutReason</td>
    <td>String</td>
    <td>Authentication Mode</td>
    <td>Specifies the event that triggered the user logout: <br><b>&nbsp;&nbsp;&nbsp;• on_lock -</b> The user locked the device.<br><b>&nbsp;&nbsp;&nbsp;• manual_logout -</b> The user manually signed out using the <b>Sign out</b> button in Identity Guardian<br><b>&nbsp;&nbsp;&nbsp;• user_change -</b> The user signed out and another user signed in.<br><b>&nbsp;&nbsp;&nbsp;• onAcPowerConnect -</b>The device was connected to a power source.<br><b>&nbsp;&nbsp;&nbsp;• onACPowerDisconnect -</b>The device was disconnected from a power source.</td>
    <td style="background-color:#d1cccb;">N/A</td>
  </tr>

  <tr>
    <td>userLogoutTime</td>
    <td>String</td>
    <td>Both</td>
    <td>[Timestamp when user logged out, in EPOCH format]</td>
    <td>[Timestamp when user logged out, in EPOCH format]</td>
  </tr>

  <tr>
    <td>loginInformation</td>
    <td>JSON object</td>
    <td>Both</td>
    <td>[Parent key]</td>
    <td>[Parent key - Visibly only when a user signs in under Proxy Mode]</td>
  </tr>

  <tr>
    <td>userLoginTime</td>
    <td>String</td>
    <td>Both</td>
    <td>[Timestamp when user logged in, in EPOCH format]</td>
    <td>[Timestamp when user logged in, in EPOCH format]</td>
  </tr>

<tr>
    <td>ssoInformation</td>
    <td>JSON object</td>
    <td>Both</td>
    <td>[Parent key]</td>
    <td>[Parent key]</td>
  </tr>

  <tr>
    <td>ssoAccessToken</td>
    <td>String</td>
    <td>Authentication Mode</td>
    <td>[Access token for Single Sign-On]</td>
    <td style="background-color:#d1cccb;">N/A</td>
  </tr>

  <tr>
    <td>ssoDataReceivedFromIDP</td>
    <td>String</td>
    <td>Authentication Mode</td>
    <td>[Data received from Identity Provider]</td>
    <td style="background-color:#d1cccb;">N/A</td>
  </tr>

  <tr>
    <td>ssoIDToken</td>
    <td>String</td>
    <td>Authentication Mode</td>
    <td>[Single Sign-On ID token]</td>
    <td style="background-color:#d1cccb;">N/A</td>
  </tr>

  <tr>
    <td>ssoProvider</td>
    <td>string</td>
    <td>Authentication Mode</td>
    <td>Single Sign-On provider in use: <br><b>&nbsp;&nbsp;&nbsp;• PingId</b><br><b>&nbsp;&nbsp;&nbsp;• Microsoft</b><br><b>&nbsp;&nbsp;&nbsp;• OKTA</b></td>
    <td style="background-color:#d1cccb;">N/A</td>
  </tr>

  <tr>
    <td>status</td>
    <td>String</td>
    <td>Both</td>
    <td>Indicates the API response outcome: <br><b>&nbsp;&nbsp;&nbsp;• SUCCESS</b><br><b>&nbsp;&nbsp;&nbsp;• FAILED</b></td>
    <td>Indicates the API response outcome: <br><b>&nbsp;&nbsp;&nbsp;• SUCCESS</b><br><b>&nbsp;&nbsp;&nbsp;• FAILED</b></td>
  </tr>

  <tr>
    <td>userInformation</td>
    <td>JSON object</td>
    <td>Both</td>
    <td>[Parent key]</td>
    <td>[Parent key with empty object]</td>
  </tr>

  <tr>
    <td>userId</td>
    <td>String</td>
    <td>Both</td>
    <td>Identifier for the user signed into the device, e.g., user1@zebra.com</td>
    <td>Identifier for the user signed into the device, e.g., user1@zebra.com</td>
  </tr>

  <tr>
    <td>userRole</td>
    <td>String</td>
    <td>Authentication Mode</td>
    <td>[Role identifier based on data from the SSO provider]</td>
    <td style="background-color:#d1cccb;">N/A</td>
  </tr>

  <tr>
    <td>errorCode</td>
    <td>Integer</td>
    <td>Both</td>
    <td>0</td>
    <td>0</td>
  </tr>

</tbody></table>

<p><strong>Note:</strong> The following keys are returned in EPOCH date/time format: enrollmentCreatedOn, enrollmentExpiryDate and userLoginTime. </p>

<!-- 
Example response for a user logged into the device:

        {
            "authenticationFactors":{
                "factors":[
                    {
                        "factor":"PASSCODE",
                        "factorType":"PRIMARYPRIMARYFACTOR",
                        "status":"EXECUTED"
                    },
                    {
                        "factor":"SSO",
                        "factorType":"PRIMARYSECONDARYFACTOR1",
                        "status":"EXECUTED"
                    }
                ],
                "schemaVersion":"1.0"
            },
            "enrollmentInformation":{
                "enrollmentCreatedOn":"1737983880029",
                "enrollmentCreatedOnDeviceModel":"TC58",
                "enrollmentCreatedOnDeviceSerialNo":"",
                "enrollmentExpiryDate":"1738156680000",
                "enrollmentId":"1737983906027D4BA34E",
                "enrollmentType":"BARCODE",
                "securityTypes":"PASSCODE",
                "storageType":"BARCODE"
            },
            "errorCode":0,
            "eventType":"Login",
            "lockScreenEventType":””
            "isSSOInformationAvailable":1,
            "logOutInformation":{
                "logoutReason ":""
                "userLogoutTime":""
            },
            "loginInformation":{
                "userLoginTime":"1738247487590"
            },
            "schemaVersion":"2.0",
            "ssoInformation":{
                "ssoAccessToken":"",
                "ssoDataReceivedFromIDP:"",
                "ssoIDToken":"",
                "ssoProvider":"Microsoft"
            },
            "status":"SUCCESS",
            "userInformation":{
                "userId":"user1@zebra.com",
                "userRole":""
            },
            "userLoggedInState":"1"
        }
-->

<p><strong>Exceptions:</strong></p>

<ul>
<li><strong>NullPointerException –</strong> Returned if the URI or method is null</li>

<li><strong>IllegalArgumentException –</strong> Returned if the URI is not known</li>
</ul>

<h4 id="samplecode-1" class="anchor"><a class="heading-anchor" href="#samplecode-1"><span></span></a>Sample Code</h4>

<p>To retrieve current user session data, follow the example below:</p>

<p><strong>URI Declaration:</strong> The <code>URI_USER_CURRENT_SESSION_V2</code> is a static final URI that interacts with a content provider managing the current user session data. It is used to query the content provider for the current session data associated with the user.</p>

<pre class="prettyprint"><code>    public static final Uri URI_USER_CURRENT_SESSION_V2 = Uri.parse("content://com.zebra.mdna.els.provider/v2/currentsession");
</code></pre>

<p><strong>Method to Get Current Session Data:</strong> This method demonstrates how to fetch current user session data from the content provider and parse it into a JSON object.</p>

<pre class="prettyprint"><code>    public void fetchCurrentUserSessionDataV2() {
        ContentResolver cr = getContentResolver(); // Get the content resolver to query the provider
        Cursor cursor = cr.query(URI_USER_CURRENT_SESSION_V2, null, null, null, null); // Query the provider using the V2 URI
        try {
            if (cursor != null) { // Check if the cursor is not null
                Log.i(TAG, "Cursor info" + cursor.getExtras()); // Log cursor information
                Bundle extras = cursor.getExtras(); // Get any extras data from the cursor
                if (extras != null) {
                    String result = extras.getString("RESULT", ""); // Retrieve the "RESULT" data from the extras
                    Log.i(TAG, "getDataForCurrentUser: key is " + result); // Log the result string

                    if (!result.isEmpty()) { // Proceed if the result is not empty
                        try {
                            JSONObject resultObject = new JSONObject(result); // Parse the result string into a JSON object
                            Log.i(TAG, "Json Result : " + resultObject.toString(1)); // Log the formatted JSON result
                        } catch (Exception e) { // Catch any exceptions during JSON parsing
                            Log.i(TAG, "Exception in parsing  " + e.getMessage()); // Log any parsing errors
                        }
                    }
                }
            }
        } catch (Exception e) { // Catch any other exceptions during the query process
            Log.e(TAG, "Exception in getDataForCurrentUser  " + e.getMessage()); // Log the exception
        } finally {
            if (cursor != null) { // Ensure that the cursor is closed to prevent memory leaks
                cursor.close();
            }
        }
    }
</code></pre>

<h4 id="exampleresponse" class="anchor"><a class="heading-anchor" href="#exampleresponse"><span></span></a>Example Response</h4>

<p>Sample response after a user authenticates and logs in to Identity Guardian in authentication mode:</p>

<pre class="prettyprint"><code>    {
        "authenticationFactors":{   
            "adminByPassFactors": [],
            "alternateFactors": [],
            "factors":[
                {
                    "factor":"PASSCODE",
                    "factorType":"PRIMARYPRIMARYFACTOR",
                    "status":"EXECUTED"
                },
                {
                    "factor":"SSO",
                    "factorType":"PRIMARYSECONDARYFACTOR1",
                    "status":"EXECUTED"
                }
            ],
            "schemaVersion":"1.0"
        },
        "enrollmentInformation":{
            "enrollmentCreatedOn":"1737983880029",
            "enrollmentCreatedOnDeviceModel":"TC58",
            "enrollmentCreatedOnDeviceSerialNo":"",
            "enrollmentExpiryDate":"1738156680000",
            "enrollmentId":"1737983906027D4BA34E",
            "enrollmentType":"BARCODE",
            "securityTypes":"PASSCODE",
            "storageType":"BARCODE"
        },
        "errorCode":0,
        "eventType":"Login",
        "lockScreenEventType":””
        "isSSOInformationAvailable":1,
        "logOutInformation":{
            " logoutReason ":""
            "userLogoutTime":""

        },
        "loginInformation":{
            "userLoginTime":"1738247487590"
        },
        "schemaVersion":"2.0",
        "ssoInformation":{
            "ssoAccessToken":"",
            "ssoDataReceivedFromIDP:"",
            "ssoIDToken":"",
            "ssoProvider":"Microsoft"
        },
        "status":"SUCCESS",
        "userInformation":{
            "userId":"user1@zebra.com",
            "userRole":""
        },
        "userLoggedInState":"1"
    }
</code></pre>

<h4 id="sampleauthenticationresults" class="anchor"><a class="heading-anchor" href="#sampleauthenticationresults"><span></span></a>Sample Authentication Results</h4>

<p>Examples of <u>authentication results,</u> demonstrating the success or failure of primary, secondary, and fallback methods, illustrating various scenarios and their outcomes:</p>

<ul>
<li><p><strong>Primary and Secondary Authentication Successful:</strong></p>

<pre class="prettyprint"><code>"factors": [
    {
        "FactorType": "PRIMARYPRIMARYFACTOR",
        "Status": "EXECUTED"
    },
    {
        "FactorType": "PRIMARYSECONDARYFACTOR1",
        "Status": "EXECUTED"
    }
],
</code></pre></li>

<li><p><strong>Primary Authentication Timed Out, Fallback Authentication Successful:</strong></p>

<pre class="prettyprint"><code>"factors": [
    {
        "FactorType": "PRIMARYPRIMARYFACTOR",
        "Status": "TIMEDOUT"
    },
    {
        "FactorType": "FALLBACKFACTOR1",
        "Status": "EXECUTED"
    }
],
</code></pre></li>

<li><p><strong>Primary Authentication Successful, Secondary and Fallback Authentication Timed Out:</strong></p>

<pre class="prettyprint"><code>"factors": [
    {
        "FactorType": "PRIMARYPRIMARYFACTOR",
        "Status": "EXECUTED BUT NOT CONSIDERED"
    },
    {
        "Factor":"PASSCODE"
        "FactorType": "PRIMARYSECONDARYFACTOR1",
        "Status": "TIMEDOUT"
    },
    {
        "FactorType": "FALLBACKFACTOR1",
        "Status": "EXECUTED"
    }
],
</code></pre></li>

<li><p><strong>Primary Authentication Successful for SSO, Secondary Skipped by User, Fallback Authentication Successful:</strong></p>

<pre class="prettyprint"><code>"factors": [
    {
        "FactorType": "PRIMARYPRIMARYFACTOR",
        "Factor":"SSO",
        "Status": "EXECUTED BUT NOT CONSIDERED"
    },
    {
        "FactorType": "PRIMARYSECONDARYFACTOR1",
        "Status": "USERSKIPPED"
    },
    {
        "FactorType": "FALLBACKFACTOR1",
        "Status": "EXECUTED"
    }
],
</code></pre></li>
</ul>

<h3 id="getcurrentusersessionlegacy" class="anchor"><a class="heading-anchor" href="#getcurrentusersessionlegacy"><span></span></a>Get Current User Session (Legacy)</h3>

<p><strong>Description:</strong> This API uses a content URI to access data from the current user session. It retrieves the cursor’s extras and extracts the result string from the extras bundle. If the result string is not empty, it must be parsed into a JSON object since that is the expected format for the result.</p>

<blockquote>
  <p><i class="fa fa-exclamation-triangle" style="color:#FFA500;"></i> <b>Warning:</b> This API is deprecated and will be removed in a future release. Zebra recommends to use the <a href="#getcurrentusersession">Get Current User Session</a> API instead.</p>
</blockquote>

<p><strong>Content URI:</strong> &nbsp;&nbsp;<span style="font-family:'Courier New'">content://com.zebra.mdna.els.provider/currentsession</span></p>

<p><strong>Input Keys:</strong> None</p>

<p><strong>Response:</strong> A Cursor object in JSON string format that contains the required bundle. A null or empty cursor indicates that no user is signed into the device.</p>

<table class="facelift" style="width:95%" border="1" padding="5px">
  <tbody><tr bgcolor="#dce8ef">
    <th>Key</th>
    <th>Type</th>
    <th>Description/Value</th>
  </tr>

  <tr>
       <td>code</td>
    <td>integer</td>
    <td>Status code indicating success or failure: <br><b>0 -</b> Success<br><b>1 -</b> Failure</td>
  </tr>

  <tr>
       <td>status</td>
    <td>string</td>
    <td>Indicates the API response outcome: <br><b>SUCCESS</b><br><b>FAILED</b></td>
  </tr>

  <tr>
       <td>schemaVersion</td>
    <td>string</td>
    <td>[Returns the version of the authentication factors schema]</td>
  </tr>

  <tr>
       <td>authenticationFactors</td>
    <td>JSON object</td>
    <td>[Returns authentication factor details. <a href="#sampleauthenticationresults">Sample Authentication Results</a> below.]</td>
  </tr>

  <tr>
       <td>factor</td>
    <td>string</td>
    <td>Specifies the type of authentication used:<br>&nbsp;&nbsp;&nbsp;• <b>PASSCODE</b><br>&nbsp;&nbsp;&nbsp;• <b>FACE</b><br>&nbsp;&nbsp;&nbsp;• <b>SSO</b><br>&nbsp;&nbsp;&nbsp;• <b>ADMINBYPASS</b><br>&nbsp;&nbsp;&nbsp;• <b>NONE -</b> Applies to "PRIMARYSECONDARYFACTOR1" and "FALLBACKFACTOR1" FactorType<br>&nbsp;&nbsp;&nbsp;• <b>NO_COMPARISON - Applies to "PRIMARYPRIMARYFACTOR" FactorType</b></td>
  </tr>

  <tr>
       <td>factorType</td>
    <td>String</td>
    <td>Defines the level of authentication used: <br>&nbsp;&nbsp;&nbsp;• <b>PRIMARYPRIMARYFACTOR -</b> Primary authentication<br>&nbsp;&nbsp;&nbsp;• <b>PRIMARYSECONDARYFACTOR1 -</b> Secondary authentication<br>&nbsp;&nbsp;&nbsp;• <b>FALLBACKFACTOR1 -</b>Fallback authentication</td>
  </tr>

  <tr>
       <td>status</td>
    <td>string</td>
    <td>Current authentication status: <br><b>&nbsp;&nbsp;&nbsp;• EXECUTED -</b>  Successful authentication<br><b>&nbsp;&nbsp;&nbsp;• EXECUTED BUT NOT CONSIDERED -</b> Primary authentication was successful but secondary authentication failed<br><b>&nbsp;&nbsp;&nbsp;• TIMEDOUT -</b> The authentication request timed out<br><b>&nbsp;&nbsp;&nbsp;• USERSKIPPED -</b>The user bypassed the SSO login prompt by pressing the back button, resulting to fallback authentication</td>
  </tr>

  <tr>
       <td>eventType</td>
    <td>string</td>
    <td>Specifies the event that occurred: <br><b>&nbsp;&nbsp;&nbsp;• Login</b><br><b>&nbsp;&nbsp;&nbsp;• Logout</b></td>
  </tr>

  <tr>
       <td>lockScreenEventType</td>
    <td>string</td>
    <td>Specifies the event that triggered the lock screen: <br><b>&nbsp;&nbsp;&nbsp;• on_lock -</b> The user locked the device.<br><b>&nbsp;&nbsp;&nbsp;• manual_logout -</b> The user manually signed out using the <b>Sign out</b> button in Identity Guardian<br><b>&nbsp;&nbsp;&nbsp;• user_change -</b> The user signed out and another user signed in.<br><b>&nbsp;&nbsp;&nbsp;• onAcPowerConnect -</b>The device was connected to a power source.<br><b>&nbsp;&nbsp;&nbsp;• onACPowerDisconnect -</b>The device was disconnected from a power source.</td>
  </tr>

  <tr>
       <td>authenticationScheme</td>
    <td>string</td>
    <td>The authentication scheme used: <br><b>&nbsp;&nbsp;&nbsp;• authenticationScheme1</b><br><b>&nbsp;&nbsp;&nbsp;• authenticationScheme2</b><br><b>&nbsp;&nbsp;&nbsp;• authenticationScheme3</b><br><b>&nbsp;&nbsp;&nbsp;• authenticationScheme4</b></td>
  </tr>

  <tr>
       <td>barcodeAuthenticatedOnDeviceSerialNo</td>
    <td>string</td>
    <td>[Serial number of device where barcode authentication occurred]</td>
  </tr>

  <tr>
       <td>barcodeCreatedOn</td>
    <td>string</td>
    <td>[Timestamp when the barcode was created, in format yyyy-MM-dd HH:mm.sss+SSSZ, e.g., 2025-01-27 18:48.029+0530]</td>
  </tr>

  <tr>
       <td>barcodeCreatedOnDeviceModel</td>
    <td>string</td>
    <td>[Device model where the barcode was created, e.g., TC58]</td>
  </tr>

  <tr>
       <td>barcodeCreatedOnDeviceSerialNo</td>
    <td>string</td>
    <td>[Serial number of device where the barcode was created]</td>
  </tr>

  <tr>
       <td>barcodeExpiryDate</td>
    <td>string</td>
    <td>[Expiration date of the barcode, in format yyyy-MM-dd HH:mm, e.g., 29-01-2025 18:48]</td>
  </tr>

  <tr>
       <td>barcodeId</td>
    <td>string</td>
    <td>[Unique identifier for the barcode, e.g., 1737983906027D4BA34E]</td>
  </tr>

  <tr>
       <td>deviceModel</td>
    <td>string</td>
    <td>[Device model in use, e.g., TC58]</td>
  </tr>

  <tr>
    <td>securityTypes</td>
    <td>string</td>
    <td>Type of security mechanism in use: <br>&nbsp;&nbsp;&nbsp;• <b>FACE</b><br>&nbsp;&nbsp;&nbsp;• <b>PASSCODE</b><br>&nbsp;&nbsp;&nbsp;• <b>SSO</b></td>
  </tr>

  <tr>
    <td>ssoAccessToken</td>
    <td>string</td>
    <td>[Access token for Single Sign-On]</td>
  </tr>

  <tr>
    <td>ssoData</td>
    <td>string</td>
    <td>[Data related to SSO]</td>
  </tr>

  <tr>
    <td>ssoProvider</td>
    <td>string</td>
    <td>Single Sign-On provider in use: <br><b>&nbsp;&nbsp;&nbsp;• PingId</b><br><b>&nbsp;&nbsp;&nbsp;• Microsoft</b><br><b>&nbsp;&nbsp;&nbsp;• OKTA</b></td>
  </tr>

  <tr>
       <td>storageType</td>
    <td>string</td>
    <td>Type of storage used for authentication:<br>&nbsp;&nbsp;&nbsp;• <b>BARCODE -</b> For shared devices<br><b>&nbsp;&nbsp;&nbsp;• DEVICE -</b> For personal devices</td>
  </tr>

  <tr>
    <td>userId</td>
    <td>string</td>
    <td>Identifier for the user signed into the device, e.g., user1@zebra.com</td>
  </tr>

  <tr>
    <td>userLoggedInState</td>
    <td>string</td>
    <td>Represents the user's login status on the device: <br><b>&nbsp;&nbsp;&nbsp;• 1 -</b> The user is signed in or has checked out the device, updating the userLoginTime <br><b>&nbsp;&nbsp;&nbsp;• 0 -</b> The user is signed out or has checked in the device, updating the userLogoutTime</td>
  </tr>

  <tr>
    <td>userLoginTime</td>
    <td>string</td>
    <td>[Timestamp when user signed in, formatted as yyyy-MM-dd HH:mm.sss+SSSZ, e.g. 2025-01-30 20:01.590+0530]</td>
  </tr>

  <tr>
    <td>userLogoutTime</td>
    <td>string</td>
    <td>[Timestamp when user signed in, formatted as yyyy-MM-dd HH:mm.sss+SSSZ]</td>
  </tr>

  <tr>
    <td>logoutReason</td>
    <td>string</td>
    <td>Specifies the event that triggered the user logout: <br><b>&nbsp;&nbsp;&nbsp;• on_lock -</b> The user locked the device.<br><b>&nbsp;&nbsp;&nbsp;• manual_logout -</b> The user manually signed out using the <b>Sign out</b> button in Identity Guardian<br><b>&nbsp;&nbsp;&nbsp;• user_change -</b> The user signed out and another user signed in.<br><b>&nbsp;&nbsp;&nbsp;• onAcPowerConnect -</b>The device was connected to a power source.<br><b>&nbsp;&nbsp;&nbsp;• onACPowerDisconnect -</b>The device was disconnected from a power source.</td>
  </tr>

  <tr>
    <td>userRole</td>
    <td>string</td>
    <td>[Role identifier based on data from the SSO provider]</td>
  </tr>

</tbody></table>

<p><strong>Note:</strong> The following keys are returned in date/time format as "yyyy-MM-dd HH:mm.sss": userLoginTime, userLogoutTime, and barcodeCreatedOn. </p>

<p>Example response when a user logs into the device in authentication mode:</p>

<pre class="prettyprint"><code>    {
        "code": 0,
        "status": "SUCCESS",
        "userData": {
            "authenticationFactors": {
                "schemaVersion": "1.0",
                "factors": [
                    {
                    "factor": "PASSCODE",
                    "factorType": "PRIMARYPRIMARYFACTOR",
                    "status": "EXECUTED"
                    },
                    {
                    "factor": "SSO",
                    "factorType": "PRIMARYSECONDARYFACTOR1",
                    "status": "EXECUTED"
                    }
                ],
                "eventType": "CurrentUser"
                "lockScreenEventType":””
            },
            "authenticationScheme": "authenticationScheme1",
            "barcodeAuthenticatedOnDeviceSerialNo": "",
            "barcodeCreatedOn": "2025-01-27 18:48.029+0530",
            "barcodeCreatedOnDeviceModel": "TC58",
            "barcodeCreatedOnDeviceSerialNo": "",
            "barcodeExpiryDate": "29-01-2025 18:48",
            "barcodeId": "1737983906027D4BA34E",
            "deviceModel": "TC58",
            "securityTypes": "PASSCODE",
            "ssoAccessToken": ".",
            "ssoData": "",
            "ssoProvider": "Microsoft",
            "storageType": "BARCODE",
            "userId": "user1@zebra.com",
            "userLoggedInState": "1",
            "userLoginTime": "2025-01-30 20:01.590+0530",
            "userLogoutTime": "",
            "logoutReason ":""
            "userRole": ""
        }
    }
</code></pre>

<!--
**The `cursor` result is returned as a JSON string format.** If the `cursor` is null or empty, no user is signed into the device. The result includes an **authentication factors** section, detailing the multifactor authentication factors, each represented as an object. 

**`Cursor` model:** This outlines keys with their possible values (values are separated by '/' and custom values enclosed in '[ ]'):

        {
            "schemaVersion": "2.0",
            "status": "SUCCESS",
            "errorcode": 0,
            "userLoggedInState": "1", 
            "eventType":"Login/Logout",
            "isSSOInformationAvailable":"1",  
            "loginInformation":
            {
                "userLoginTime":"[EPOC time]",
            },

            "logOutInformation":
            {
                "userLogoutTime":"[EPOC time]",
                "logoutReason":"on_lock/manual_logout/user_change/onAcPowerConnect/onACPowerDisconnect" 
            },

            "userInformation": 
            {
                "userId": "test_user",
                "userRole": "test_group"
            },

            "authenticationFactors": 
            {                   
                {
                    "schemaVersion":"2.0",    "factors": 
                    [
                        {
                            "factorType": "PRIMARYPRIMARYFACTOR",
                            "factor": "FACE",
                            "status": "EXECUTED/TIMEDOUT/USERSKIPPED"
                        },
                        {
                           "factorType":"PRIMARYSECONDARYFACTOR1",
                           "factor": "PASSCODE/SSO/FACE",
                           "status": "EXECUTED/TIMEDOUT/USERSKIPPED "
                        }

                        {
                            "factorType": "FALLBACKFACTOR1",
                            "factor": "PASSCODE/FACE/SSO/ADMINBYPASS/NONE",
                            "status": "EXECUTED/TIMEDOUT/USERSKIPPED"
                        },

                        "eventType":"CurrentUser",
                        "lockScreenEventType":"on_unlock/manual_logout/user_change/onAcPowerConnect/onACPowerDisconnect"
                    ]        
                }
            },

            "ssoInformation": 
            {
                "ssoProvider": "PingId/Microsoft/OKTA",
                "ssoAccessToken": "[string]",
                "ssoIDToken":"",
                "ssoDataReceivedFromIDP": 
                {

                    "sub": "[user@company.com]",
                    "aud": "[test123_new_test_none]",
                    "jti": "[54321edcba]",
                    "iss": "[https://test.test.com]",
                    "iat": [1727352498],
                    "exp": [1727352647],
                    "AdminJobID": "[test-group]",
                    "location": "[NY]",
                    "JobId": "[testuser]",
                    "GroupID": "[test-Group]",
                    "pi.sri": "[46tGa230SsfoUoasdfJFzUTE.dXMtZWFzdC0y]",
                    "sid": "[46tGa230SsfoUasdfAJFzUTE.dXMtZWFzdC0y]",
                    "nonce": "[-W3pLAleOnWdfd8wqOW3pg]"
                }
            },

            "enrollmentInformation":
            {
                "enrollmentType":"Barcode",
                "enrollmentId": "[string]",
                "securityTypes":"FACE/PASSCODE/SSO",
                "validThrough":"[EPOC time]",
                "storageType": "Barcode/Device",
                "enrollmentExpiryDate":"[EPOC time]",
                "enrollmentCreatedOn":"[EPOC time]",
                "enrollmentCreatedOnDeviceModel":"[TC57]",
                "enrollmentCreatedOnDeviceSerialNo":"[string]"
            }
        }

**Important properties of the `cursor` result (not exhaustive):**

- **status -** Indicates the API response outcome:
  - **SUCCESS**
  - **FAILED**
- **userLoggedInState -** User's login status on the device:
  - **1 -** User is signed in or has checked out the device, updating the `userLoginTime`.
  - **0 -** User is signed out or has checked in the device, updating the `userLogoutTime`.
- **eventType -** Specifies the event that occurred:
  - **Login**
  - **Logout**
- **isSSOInformationAvailable -** Availability of single sign-on (SSO) data:
  - **1 -** SSO information is available; `ssoInformation` can be parsed for details.
  - **0 -** SSO information is not available.
- **userLoginTime -** Timestamp in EPOCH format when user signed in.
- **userLogoutTime -** Timestamp in EPOCH format when user signed out.
- **logoutReason -** Event during user logout:
  - **on_lock -** User locked the device.
  - **manual_logout -** User signed out manually via the **Sign out** button in Identity Guardian
  - **user_change -** User signed out and another user signed into the device.
  - **onAcPowerConnect -** Device connected to power.
  - **onACPowerDisconnect -** Device disconnected from power.
- **user_id -** Identifier for the user signing into the device. In [Proxy Mode](../usage/#proxymode), it appears in the user name field of the Zebra app receiving user session information. For example, in Device Tracker, this name is shown in the Checked-Out field.
- **userRole -** Role identifier based on data from the SSO provider.
- **Factor -** Type of authentication:
  - **PASSCODE**
  - **FACE**
  - **SSO**
  - **ADMINBYPASS**
  - **NONE -** Applies to "PRIMARYSECONDARYFACTOR1" and "FALLBACKFACTOR1" FactorType
  - **NO_COMPARISON -** Applies to "PRIMARYPRIMARYFACTOR" FactorType
- **FactorType -** The level of authentication:
  - **PRIMARYPRIMARYFACTOR -** Primary authentication.
  - **PRIMARYSECONDARYFACTOR1 -** Secondary authentication.
  - **FALLBACKFACTOR1 -** Fallback authentication.
- **Status -** Current authentication status:
  - **EXECUTED -** Successful authentication.
  - **EXECUTED BUT NOT CONSIDERED -** Primary authentication was successful but secondary authentication failed.
  - **TIMEDOUT -** The authentication request timed out.
  - **USERSKIPPED -** User bypassed the SSO login prompt by pressing the back button, resulting to fallback authentication.
- **eventType -** Specifies authentication user, useful for tracking sessions or determining access rights:
  - **PreviousUser**
  - **CurrentUser**
- **lockScreenEventType -** Trigger for lock screen:
  - **on_unlock -** User unlocked the device.
  - **manual_logout -** User signed out manually through the **Sign out** button in Identity Guardian.
  - **user_change -** User signed out and another user signed into the device.
  - **onAcPowerConnect -** Device connected to power.
  - **onACPowerDisconnect -** Device disconnected from power.
- **ssoProvider -** SSO provider in use:
  - **PingId**
  - **Microsoft**
  - **OKTA**
- **securityTypes -** Authentication method for device checkout:
  - **FACE**
  - **PASSCODE**
  - **SSO**
- **validThrough -** Date until the user barcode is valid, in EPOCH time, set by the administrator.
- **storageType -** User data storage location:
  - **Barcode -** For shared devices.
  - **Device -** For personal devices.
- **enrollmentExpiryDate -** Barcode expiration date in EPOC time.
- **enrollmentCreatedOn -** Barcode creation date in EPOC time.
- **enrollmentCreatedOnDeviceModel -** Model of device used for barcode creation.
- **enrollmentCreatedOnDeviceSerialNo -** Serial number of device used for barcode creation.
-->

<!-- 
- **signed_in_state -** Indicates a user's sign-in status on the device. This is mandatory.
  - **1 -** User is signed in or has checked out the device, updating the **signin_time**.
  - **0 -** User is signed out or checked in the device, updating the **signout_time**.
- **signin_time -** Timestamp formatted as a string (“yyyy-dd-MM HH:mm:ss.SSSZ”), applicable without Proxy Mode.
- **signout_time -** Timestamp formatted as a string (“yyyy-dd-MM HH:mm:ss.SSSZ”), applicable without Proxy Mode.
- **enrollmentInformation -** (Optional) Details about user enrollment, including enrollment type, security type, device model, etc.
-->

<!-- 
The Response is received by the caller application in the form of a bundle:
* **RESULT:**
    * If successful: `{ "status":"SUCCESS","message":"successfully executed" }`    
    * If failed: `{ "status":"FAILURE","message":"[error description]" }`, where the "error description" is based on the type of error encountered. 
-->

<p><strong>Exceptions:</strong></p>

<ul>
<li><strong>NullPointerException –</strong> Returned if the URI or method is null</li>

<li><strong>IllegalArgumentException –</strong> Returned if the URI is not known</li>
</ul>

<h4 id="sampleauthenticationresults-1" class="anchor"><a class="heading-anchor" href="#sampleauthenticationresults-1"><span></span></a>Sample Authentication Results</h4>

<p>Examples of <u>authentication results,</u> demonstrating the success or failure of primary, secondary, and fallback methods, illustrating various scenarios and their outcomes:</p>

<ul>
<li><p><strong>Primary and Secondary Authentication Successful:</strong></p>

<pre class="prettyprint"><code>"factors": [
    {
        "FactorType": "PRIMARYPRIMARYFACTOR",
        "Status": "EXECUTED"
    },
    {
        "FactorType": "PRIMARYSECONDARYFACTOR1",
        "Status": "EXECUTED"
    }
],
</code></pre></li>

<li><p><strong>Primary Authentication Timed Out, Fallback Authentication Successful:</strong></p>

<pre class="prettyprint"><code>"factors": [
    {
        "FactorType": "PRIMARYPRIMARYFACTOR",
        "Status": "TIMEDOUT"
    },
    {
        "FactorType": "FALLBACKFACTOR1",
        "Status": "EXECUTED"
    }
],
</code></pre></li>

<li><p><strong>Primary Authentication Successful, Secondary and Fallback Authentication Timed Out:</strong></p>

<pre class="prettyprint"><code>"factors": [
    {
        "FactorType": "PRIMARYPRIMARYFACTOR",
        "Status": "EXECUTED BUT NOT CONSIDERED"
    },
    {
        "Factor":"PASSCODE"
        "FactorType": "PRIMARYSECONDARYFACTOR1",
        "Status": "TIMEDOUT"
    },
    {
        "FactorType": "FALLBACKFACTOR1",
        "Status": "EXECUTED"
    }
],
</code></pre></li>

<li><p><strong>Primary Authentication Successful for SSO, Secondary Skipped by User, Fallback Authentication Successful:</strong></p>

<pre class="prettyprint"><code>"factors": [
    {
        "FactorType": "PRIMARYPRIMARYFACTOR",
        "Factor":"SSO",
        "Status": "EXECUTED BUT NOT CONSIDERED"
    },
    {
        "FactorType": "PRIMARYSECONDARYFACTOR1",
        "Status": "USERSKIPPED"
    },
    {
        "FactorType": "FALLBACKFACTOR1",
        "Status": "EXECUTED"
    }
],
</code></pre></li>
</ul>

<h4 id="samplecode-2" class="anchor"><a class="heading-anchor" href="#samplecode-2"><span></span></a>Sample Code</h4>

<p>To retrieve current user session data, follow the example below:</p>

<p><strong>URI Declaration:</strong> The <code>URI_USER_CURRENT_SESSION</code> is a static final URI that interacts with a content provider managing the current user session data. It is used to query the content provider for the current session data associated with the user.</p>

<pre class="prettyprint"><code>    public static final Uri URI_USER_CURRENT_SESSION = Uri.parse("content://com.zebra.mdna.els.provider/currentsession");
</code></pre>

<p><strong>Method to Get Current Session Data:</strong> This method demonstrates how to fetch current user session data from the content provider and parse it into a JSON object.</p>

<pre class="prettyprint"><code>    public void fetchCurrentUserSessionData() {
        ContentResolver cr = getContentResolver(); // Get the content resolver to query the provider
        Cursor cursor = cr.query(URI_USER_CURRENT_SESSION, null, null, null, null); // Query the provider using the URI
        try {
            if (cursor != null) { // Check if cursor is not null
                Log.i(TAG, "Cursor info" + cursor.getExtras()); // Log cursor information
                Bundle extras = cursor.getExtras(); // Get any extras data from the cursor
                if (extras != null) {
                    String result = extras.getString("RESULT", ""); // Retrieve the "RESULT" data from the extras
                    Log.i(TAG, "getDataForCurrentUser: key is " + result); // Log the result string

                    if (!result.isEmpty()) { // Proceed if the result is not empty
                        try {
                            JSONObject resultObject = new JSONObject(result); // Parse the result string into a JSON object
                            Log.i(TAG, "Json Result : " + resultObject.toString(1)); // Log the formatted JSON result
                        } catch (Exception e) { // Catch any exceptions that occur during JSON parsing
                            Log.i(TAG, "Exception in parsing  " + e.getMessage()); // Log parsing exceptions
                        }
                    }
                }
            }
        } catch (Exception e) { // Catch any other exceptions during the query process
            Log.e(TAG, "Exception in getDataForCurrentUser  " + e.getMessage()); // Log the exception
        } finally {
            if (cursor != null) { // Ensure the cursor is closed to avoid memory leaks
                cursor.close();
            }
        }
    }
</code></pre>

<!-- 
#### Sample Results

**Sample return results for `cursor`:** 

        {
            "schemaVersion": "2.0",
            "status": "SUCCESS",
            "errorcode": 0,
            "userLoggedInState": "1", 
            "eventType":"Login",
            "isSSOInformationAvailable":"1",  
            "loginInformation":
            {
                "userLoginTime":"1729232875461",
            },

            "logOutInformation":
            {
                "userLogoutTime":"1729232899461",
                "logoutReason":"on_lock" 
            },

            "userInformation": 
            {
                "userId": "user@company.com",
                "userRole": "test_group"
            },

            "authenticationFactors": 
            {                   
                {
                    "schemaVersion":"1.0",    "factors": 
                    [
                        {
                            "factor": "FACE",
                            "factorType": "PRIMARYPRIMARYFACTOR",
                            "status": "EXECUTED"
                        },

                        {
                            "factor":"PASSCODE",
                            "factorType":"PRIMARYSECONDARYFACTOR1",
                            "status":"EXECUTED"
                        }
                    ],

                    "eventType":"CurrentUser",
                    "lockScreenEventType":"on_unlock"                            
                }
            },

            "ssoInformation": 
            {
                "ssoProvider": "PingId",
                "ssoAccessToken": "12345abcde",
                "ssoIDToken":"",
                "ssoDataReceivedFromIDP": 
                {

                    "sub": "user@company.com",
                    "aud": "test123_new_test_none",
                    "jti": "54321edcba",
                    "iss": "https://test.zebra.com",
                    "iat": 1727352498,
                    "exp": 1727352647,
                    "AdminJobID": "test-group",
                    "location": "NY",
                    "JobId": "testuser",
                    "GroupID": "test-Group",
                    "pi.sri": "46tGa230SsfoUoasdfJFzUTE.dXMtZWFzdC0y",
                    "sid": "46tGa230SsfoUasdfAJFzUTE.dXMtZWFzdC0y",
                    "nonce": "-W3pLAleOnWdfd8wqOW3pg"
                }
            },

            "enrollmentInformation":
            {
                "enrollmentType":"Barcode",
                "enrollmentId": "172208771078F577",
                "securityTypes":"FACE,PASSCODE",
                "validThrough":"1729436343123",
                "storageType": "Barcode",
                "enrollmentExpiryDate":"1729436343123",
                "enrollmentCreatedOn":"1729232812461",
                "enrollmentCreatedOnDeviceModel":"TC57",
                "enrollmentCreatedOnDeviceSerialNo":"1234567890"
            }
        }
-->

<h3 id="getprevioususersession" class="anchor"><a class="heading-anchor" href="#getprevioususersession"><span></span></a>Get Previous User Session</h3>

<p><strong>Description:</strong> This API uses a content URI to access data from the previous user session. It retrieves the cursor’s extras and extracts the result string from the extras bundle. If the result string is not empty, it must be parsed into a JSON object since that is the expected format for the result.</p>

<p><strong>Content URI:</strong> &nbsp;&nbsp;<span style="font-family:'Courier New'">content://com.zebra.mdna.els.provider/previoussession</span></p>

<p><strong>Input Keys:</strong> None</p>

<p><strong>Response:</strong> A Cursor object in JSON string format that contains the required bundle. A null or empty cursor indicates that no user is signed into the device.</p>

<table class="facelift" style="width:95%" border="1" padding="5px">
  <tbody><tr bgcolor="#dce8ef">
    <th>Key</th>
    <th>Type</th>
    <th>Description/Value</th>
  </tr>

  <tr>
       <td>code</td>
    <td>integer</td>
    <td>Status code indicating success or failure: <br><b>0 -</b> Success<br><b>1 -</b> Failure</td>
  </tr>

  <tr>
       <td>status</td>
    <td>string</td>
    <td>Indicates the API response outcome: <br><b>SUCCESS</b><br><b>FAILED</b></td>
  </tr>

  <tr>
       <td>authenticationFactors.schemaVersion</td>
    <td>JSON object</td>
    <td>[Returns authentication factor details. <a href="#sampleauthenticationresults">Sample Authentication Results</a> below.]</td>
  </tr>

  <tr>
       <td>schemaVersion</td>
    <td>string</td>
    <td>[Returns the version of the authentication factors schema]</td>
  </tr>

  <tr>
       <td>factor</td>
    <td>string</td>
    <td>Specifies the type of authentication used:<br>&nbsp;&nbsp;&nbsp;• <b>PASSCODE</b><br>&nbsp;&nbsp;&nbsp;• <b>FACE</b><br>&nbsp;&nbsp;&nbsp;• <b>SSO</b><br>&nbsp;&nbsp;&nbsp;• <b>ADMINBYPASS</b><br>&nbsp;&nbsp;&nbsp;• <b>NONE -</b> Applies to "PRIMARYSECONDARYFACTOR1" and "FALLBACKFACTOR1" FactorType<br>&nbsp;&nbsp;&nbsp;• <b>NO_COMPARISON - Applies to "PRIMARYPRIMARYFACTOR" FactorType</b></td>
  </tr>

  <tr>
       <td>Factor Type</td>
    <td>String</td>
    <td>Defines the level of authentication used: <br>&nbsp;&nbsp;&nbsp;• <b>PRIMARYPRIMARYFACTOR -</b> Primary authentication<br>&nbsp;&nbsp;&nbsp;• <b>PRIMARYSECONDARYFACTOR1 -</b> Secondary authentication<br>&nbsp;&nbsp;&nbsp;• <b>FALLBACKFACTOR1 -</b>Fallback authentication</td>
  </tr>

  <tr>
       <td>status</td>
    <td>string</td>
    <td>Current authentication status: <br><b>&nbsp;&nbsp;&nbsp;• EXECUTED -</b> Successful authentication<br><b>&nbsp;&nbsp;&nbsp;• EXECUTED BUT NOT CONSIDERED -</b> Primary authentication was successful but secondary authentication failed<br><b>&nbsp;&nbsp;&nbsp;• TIMEDOUT -</b> The authentication request timed out<br><b>&nbsp;&nbsp;&nbsp;• USERSKIPPED -</b>The user bypassed the SSO login prompt by pressing the back button, resulting to fallback authentication</td>
  </tr>

  <tr>
       <td>eventType</td>
    <td>string</td>
    <td>Identifies the user who was authenticated: <br><b>&nbsp;&nbsp;&nbsp;• PreviousUser -</b> The user from the previous session.<br><b>&nbsp;&nbsp;&nbsp;• CurrentUser -</b> The user from the current session.</td>
  </tr>

<!-- 
  <tr>
       <td>authenticationScheme</td>
    <td>string</td>
    <td>The authentication scheme used: <br /><b>&nbsp;&nbsp;&nbsp;• authenticationScheme1</b><br /><b>&nbsp;&nbsp;&nbsp;• authenticationScheme2</b><br /><b>&nbsp;&nbsp;&nbsp;• authenticationScheme3</b><br /><b>&nbsp;&nbsp;&nbsp;• authenticationScheme4</b></td>
  </tr>-->

  <tr>
       <td>barcodeAuthenticatedOnDeviceSerialNo</td>
    <td>string</td>
    <td>[Serial number of device where barcode authentication occurred]</td>
  </tr>

  <tr>
       <td>barcodeCreatedOn</td>
    <td>string</td>
    <td>[Timestamp when the barcode was created, in format yyyy-MM-dd HH:mm.sss+SSSZ, e.g., 2025-01-27 18:48.029+0530]</td>
  </tr>

  <tr>
       <td>barcodeCreatedOnDeviceModel</td>
    <td>string</td>
    <td>[Device model where the barcode was created, e.g., TC58]</td>
  </tr>

  <tr>
       <td>barcodeCreatedOnDeviceSerialNo</td>
    <td>string</td>
    <td>[Serial number of device where the barcode was created]</td>
  </tr>

  <tr>
       <td>barcodeExpiryDate</td>
    <td>string</td>
    <td>[Expiration date of the barcode, in format yyyy-MM-dd HH:mm, e.g., 29-01-2025 18:48]</td>
  </tr>

  <tr>
       <td>barcodeId</td>
    <td>string</td>
    <td>[Unique identifier for the barcode, e.g., 1737983906027D4BA34E]</td>
  </tr>

  <tr>
       <td>deviceModel</td>
    <td>string</td>
    <td>[Device model in use, e.g., TC58]</td>
  </tr>

  <tr>
    <td>logoutReason</td>
    <td>string</td>
    <td>Specifies the event that triggered the user logout: <br><b>&nbsp;&nbsp;&nbsp;• on_lock -</b> The user locked the device.<br><b>&nbsp;&nbsp;&nbsp;• manual_logout -</b> The user manually signed out using the <b>Sign out</b> button in Identity Guardian<br><b>&nbsp;&nbsp;&nbsp;• user_change -</b> The user signed out and another user signed in.<br><b>&nbsp;&nbsp;&nbsp;• onAcPowerConnect -</b>The device connected to a power source.<br><b>&nbsp;&nbsp;&nbsp;• onACPowerDisconnect -</b>The device disconnected from a power source.</td>
  </tr>

  <tr>
    <td>securityTypes</td>
    <td>string</td>
    <td>Type of security mechanism in use: <br>&nbsp;&nbsp;&nbsp;• <b>FACE</b><br>&nbsp;&nbsp;&nbsp;• <b>PASSCODE</b><br>&nbsp;&nbsp;&nbsp;• <b>SSO</b></td>
  </tr>

  <tr>
    <td>ssoAccessToken</td>
    <td>string</td>
    <td>[Access token for Single Sign-On]</td>
  </tr>

  <tr>
    <td>ssoData</td>
    <td>string</td>
    <td>[Data related to SSO]</td>
  </tr>

  <tr>
    <td>ssoProvider</td>
    <td>string</td>
    <td>Single Sign-On provider in use: <br><b>&nbsp;&nbsp;&nbsp;• PingId</b><br><b>&nbsp;&nbsp;&nbsp;• Microsoft</b><br><b>&nbsp;&nbsp;&nbsp;• OKTA</b></td>
  </tr>

  <tr>
       <td>storageType</td>
    <td>string</td>
    <td>Type of storage used for authentication:<br>&nbsp;&nbsp;&nbsp;• <b>BARCODE -</b> For shared devices<br><b>&nbsp;&nbsp;&nbsp;• DEVICE -</b> For personal devices</td>
  </tr>

  <tr>
    <td>userId</td>
    <td>string</td>
    <td>Identifier for the user signed into the device, e.g., user1@zebra.com</td>
  </tr>

  <tr>
    <td>userLoggedInState</td>
    <td>string</td>
    <td>Represents the user's login status on the device: <br><b>&nbsp;&nbsp;&nbsp;• 1 -</b> The user is signed in or has checked out the device, updating the userLoginTime <br><b>&nbsp;&nbsp;&nbsp;• 0 -</b> The user is signed out or has checked in the device, updating the userLogoutTime</td>
  </tr>

  <tr>
    <td>userLoginTime</td>
    <td>string</td>
    <td>[Timestamp when user signed in format yyyy-MM-dd HH:mm.sss+SSSZ, e.g. 2025-01-30 20:01.590+0530]</td>
  </tr>

  <tr>
    <td>userLogoutTime</td>
    <td>string</td>
    <td>[Timestamp when user signed in format yyyy-MM-dd HH:mm.sss+SSSZ]</td>
  </tr>

  <tr>
    <td>userRole</td>
    <td>string</td>
    <td>[Role identifier based on data from the SSO provider]</td>
  </tr>

</tbody></table>

<p>Example response when a user logs into the device in authentication mode:</p>

<pre class="prettyprint"><code>    {
        "code":0,
        "status":"SUCCESS",
        "userData":{
            "authenticationFactors":"{\"schemaVersion\":\"1.0\",\"factors\":[{\"factor\":\"PASSCODE\",\"factorType\":\"PRIMARYPRIMARYFACTOR\",\"status\":\"EXECUTED\"},{\"factor\":\"SSO\",\"factorType\":\"PRIMARYSECONDARYFACTOR1\",\"status\":\"EXECUTED\"}],\"eventType\":\"PreviousUser\"}",
            "barcodeAuthenticatedOnDeviceSerialNo":"",
            "barcodeCreatedOn":"2025-01-27 18:48.029+0530",
            "barcodeCreatedOnDeviceModel":"TC58",
            "barcodeCreatedOnDeviceSerialNo":"",
            "barcodeExpiryDate":"29-01-2025 18:48",
            "barcodeId":"1737983906027D4BA34E",
            "deviceModel":"TC58",
            "logoutReason":"on_device_manual_checkin",
            "securityTypes":"PASSCODE",
            "ssoAccessToken":"abcde12345",
            "ssoData":"{\"aud\":\"f46bf88f-e5a7-441d-bc19-096b2dacdde2\",\"iss\":\"https:\/\/login.microsoftonline.com\/fcefc790-f4eb-456b-86fa-0e8153bac15c\/v2.0\",\"iat\":1738296787,\"nbf\":1738296787,\"exp\":1738300687,\"aio\":\"AWQAm\/8ZAAAAmCTlSl+wuMlynM47fKj7nL1+7BZSgS0pxjxHji+gi4gL3xbx3mPoK2VQ7UzPwLhZgSzetL8cWPT48HIT85s5wSmLWHt6hLuGKzw9JQdnRkYlKezBcT5IGiF3717ocYRE\",\"name\":\"test.user\",\"oid\":\"d2da2d27-ae35-43eb-b3a2-b398890b50d9\",\"preferred_username\":\"test.user@zebra.com\",\"rh\":\"1.Ab4AkMfv_Ov0a0WG-g6BU7rBXI_4a_Sn5R1EvBkJay2s3eK-AL--AA.\",\"sid\":\"0013de09-e09d-39a2-c5ef-060305d43ea1\",\"sub\":\"E7p4Dj1EjzcGFiSF327esrZZBs66CRR45Lr-qH9tcAw\",\"tid\":\"fcefc790-f4eb-456b-86fa-0e8153bac15c\",\"uti\":\"MypFFrvIQEajJLVv3TKCAA\",\"ver\":\"2.0\"}",
            "ssoProvider":"Microsoft",
            "storageType":"BARCODE",
            "userId":"test.user@zebra.com",
            "userLoggedInState":"0",
            "userLoginTime":"2025-01-31 09:48.446+0530",
            "userLogoutTime":"2025-01-31 09:48.934+0530",
            "userRole":""
        }
    }
</code></pre>

<h4 id="samplecode-3" class="anchor"><a class="heading-anchor" href="#samplecode-3"><span></span></a>Sample Code</h4>

<p>To retrieve previous user session data, follow the example below:</p>

<p><strong>URI Declaration:</strong> The <code>URI_PREVIOUS_USER_SESSION</code> is a static final URI that interacts with a content provider managing the previous user session data. It is used to query the content provider for the previous session data associated with the user.</p>

<pre class="prettyprint"><code>    public static final Uri URI_PREVIOUS_USER_SESSION = Uri.parse("content://com.zebra.mdna.els.provider/previoussession");
</code></pre>

<p><strong>Method to Get Current Session Data:</strong> This method demonstrates how to fetch previous user session data from the content provider and parse it into a JSON object.</p>

<pre class="prettyprint"><code>    public void fetchPreviousUserSessionData() {
        ContentResolver cr = getContentResolver();
        Cursor cursor = cr.query(URI_PREVIOUS_USER_SESSION, null, null, null, null);
        try {
            if (cursor != null) {
                Log.i(TAG, "Previous user Cursor info" + cursor.getExtras());
                Bundle extras = cursor.getExtras();
                if (extras != null) {
                    String result = extras.getString("RESULT", "");
                    Log.i(TAG, "getDataForPreviousUser: key is " + result);
                    if (!result.isEmpty()) {
                        try {
                            JSONObject resultObject = new JSONObject(result);
                            Log.i(TAG, "Json Result : " + resultObject.toString(1));
                        } catch (Exception e) {
                            Log.i(TAG, "Exception in parsing  " + e.getMessage());
                        }
                    }
                }
            }
        } catch (Exception e) {
            Log.e(TAG, "Exception in getDataForPreviousUser  " + e.getMessage());
        } finally {
            if (cursor != null) {
                cursor.close();
            }
        }
    }
</code></pre>

<!-- 
Sample code:

        Uri URI_PREVIOUS_USER_SESSION = Uri.parse("content://com.zebra.mdna.els.provider/previoussession");
        Cursor cursor = cr.query(URI_PREVIOUS_USER_SESSION , null, null, null, null);

The `cursor` is given in JSON format where each key is accompanied by a series of possible values separated by '/' and custom values enclosed in '[ ]' in the key-value pair:

        {
            "signin_time": "[time stamp]",
            "user_role":"[string]",
            "user_id":"[string]",
            "signout_time":"[time stamp]",
            "authenticationFactors": {
                "SchemaVersion": "1.0"
                "factors":
                [
                    {
                        "FactorType": "PRIMARYPRIMARYFACTOR",
                        "Factor": "PASSCODE/FACE/SSO/NO_COMPARISON",
                        "Status": "EXECUTED/EXECUTED BUT NOT CONSIDERED/TIMEDOUT"
                    },
                    {
                        "FactorType": "PRIMARYSECONDARYFACTOR1",
                        "Factor": "PASSCODE/FACE/SSO/NONE",
                        "Status": "TIMEDOUT/USERSKIPPED/EXECUTED"
                    },
                    {
                        "FactorType": "FALLBACKFACTOR1",
                        "Factor": "PASSCODE/FACE/SSO/ADMINBYPASS/NONE",
                        "Status": "EXECUTED/TIMEDOUT/USERSKIPPED"
                    }
                ]
                "EventType": "PreviousUser/CurrentUser",
                "lockScreenEventType": "on_reboot/on_unlock/on_user_change/ac_power_connected/ac_power_disconnected/on_devicemanual_checkin/on_forcelock"
            }
            "barcode_id":"[string]",
            "signed_in_state":"1/0"
        }

**The result from `cursor` includes an authentication factors section,** which encapsulates an array of authentication factors used in multifactor authentication with each factor represented as an object.

**The properties returned in the `cursor` result are:**

- **FactorType -** Specifies the level of authentication:
  - **PRIMARYPRIMARYFACTOR -** Primary authentication
  - **PRIMARYSECONDARYFACTOR1 -** Secondary authentication
  - **FALLBACKFACTOR1 -** Fallback authentication
- **Factor -** Describes the type of authentication:
  - **PASSCODE**
  - **FACE**
  - **SSO**
  - **NO_COMPARISON -** Applies to "PRIMARYPRIMARYFACTOR" FactorType
  - **NONE -** Applies to "PRIMARYSECONDARYFACTOR1" and "FALLBACKFACTOR1" FactorType
- **Status -** Indicates the current status of authentication:
  - **EXECUTED -** Authentication is successful.
  - **EXECUTED BUT NOT CONSIDERED -** Primary authentication was successful but secondary authentication failed.
  - **TIMEDOUT -** The authentication request exceeded the time limit.
  - **USERSKIPPED -** The user opted for fallback authentication, bypassing the SSO login prompt by pressing the back button.
- **EventType -** Indicates whether the authentication is for a previous user or the current user. This could be relevant for tracking user sessions or determining access rights:
  - **PreviousUser**
  - **CurrentUser**
- **lockScreenEventType -** Specifies the event that triggered the lock screen to appear:
  - **on_reboot -** Device rebooted
  - **on_unlock -** User unlocked device
  - **on_user_change -** User signed out and another user signed into the device
  - **ac_power_connected -** Device connected to power
  - **ac_power_disconnected -** Device disconnected from power
  - **on_devicemanual_checkin -** User manually signed out of the device through the "Sign out" button in Identity Guardian (applies to Shared Devices only).
  - **on_forcelock -** Device automatically locked after reaching the specified timeout period.
- **signed_in_state -** Specifies whether a user has signed into the device.
  - **1 -** A user is signed into the device.
  - **0 -** No user is signed into the device.

**Sample return value in JSON string format for `cursor`.** If `cursor` is null or empty, that indicates no user has signed in:

        {
            "signin_time":"2023-10-04 11:19.338+0530",
            "user_role":"Warehouse",
            "user_id":"John Doe",
            "signout_time":"2023-10-04 11:19.068+0530",
            "authenticatedFactors":
            {
                "schemaVersion":"1.0",
                "factors":
                [
                    {
                        "factor":"FACE",
                        "factorType":"PRIMARYPRIMARYFACTORY",
                        "status":"EXECUTED",
                    }
                    {
                        "factor":"PASSCODE",
                        "factorType":"PRIMARYSECONDARYFACTOR1",
                        "status":"EXECUTED"
                    }
                ]
                "eventType":"CurrentUser",
                "lockScreenEventType":"on_unlock"
            }
            "barcode_id":"1693820652113F736CAB",
            "signed_in_state":"0"
        }

-->

<h4 id="sampleauthenticationresults-2" class="anchor"><a class="heading-anchor" href="#sampleauthenticationresults-2"><span></span></a>Sample Authentication Results</h4>

<p>Examples of <u>authentication results,</u> demonstrating the success or failure of primary, secondary, and fallback methods, illustrating various scenarios and their outcomes:</p>

<ul>
<li><p><strong>Primary and Secondary Authentication Successful:</strong></p>

<pre class="prettyprint"><code>"factors": [
    {
        "FactorType": "PRIMARYPRIMARYFACTOR",
        "Status": "EXECUTED"
    },
    {
        "FactorType": "PRIMARYSECONDARYFACTOR1",
        "Status": "EXECUTED"
    }
],
</code></pre></li>

<li><p><strong>Primary Authentication Timed Out, Fallback Authentication Successful:</strong></p>

<pre class="prettyprint"><code>"factors": [
    {
        "FactorType": "PRIMARYPRIMARYFACTOR",
        "Status": "TIMEDOUT"
    },
    {
        "FactorType": "FALLBACKFACTOR1",
        "Status": "EXECUTED"
    }
],
</code></pre></li>

<li><p><strong>Primary Authentication Successful, Secondary and Fallback Authentication Timed Out:</strong></p>

<pre class="prettyprint"><code>"factors": [
    {
        "FactorType": "PRIMARYPRIMARYFACTOR",
        "Status": "EXECUTED BUT NOT CONSIDERED"
    },
    {
        "Factor":"PASSCODE"
        "FactorType": "PRIMARYSECONDARYFACTOR1",
        "Status": "TIMEDOUT"
    },
    {
        "FactorType": "FALLBACKFACTOR1",
        "Status": "EXECUTED"
    }
],
</code></pre></li>

<li><p><strong>Primary Authentication Successful for SSO, Secondary Skipped by User, Fallback Authentication Successful:</strong></p>

<pre class="prettyprint"><code>"factors": [
    {
        "FactorType": "PRIMARYPRIMARYFACTOR",
        "Factor":"SSO",
        "Status": "EXECUTED BUT NOT CONSIDERED"
    },
    {
        "FactorType": "PRIMARYSECONDARYFACTOR1",
        "Status": "USERSKIPPED"
    },
    {
        "FactorType": "FALLBACKFACTOR1",
        "Status": "EXECUTED"
    }
],
</code></pre></li>
</ul>

<hr>

<h2 id="setcurrentusersession" class="anchor"><a class="heading-anchor" href="#setcurrentusersession"><span></span></a>Set Current User Session</h2>

<p><strong>Description:</strong> When third-party apps are used to block the device screen instead of Identity Guardian, the app informs Identity Guardian by invoking <strong>Session Sign-In State</strong> when a user signs in, or <strong>Session Sign-Out State</strong> when a user signs out. To function in this mode, Identity Guardian must be configured to <a href="../usage/#proxymode">Proxy Mode</a> by setting the <a href="../mc/#usagemode">Application Mode</a> to "Proxy.”</p>

<h3 id="setsessionsigninstate" class="anchor"><a class="heading-anchor" href="#setsessionsigninstate"><span></span></a>Set Session Sign-In State</h3>

<p><strong>Description:</strong> This API uses a content URI to notify Identity Guardian when a user signs in through a third-party app that blocks the device screen in place of Identity Guardian. It informs Identity Guardian that a user session has started, ensuring user authentication and access control are effectively handled in Proxy Mode. The API returns a result string from the bundle and if the result string is not empty, it should be parsed as a JSON object.</p>

<p><strong>Content URI:</strong> &nbsp;&nbsp;<span style="font-family:'Courier New'">content://com.zebra.mdna.els.provider/currentsession</span></p>

<p><strong>Input Keys:</strong> </p>

<table class="facelift" style="width:100%" border="1" padding="5px">
  <tbody><tr bgcolor="#dce8ef">
    <th>Key</th>
    <th>Value Type</th>
    <th>Description</th>
    <th>Requirement</th>
  </tr>

  <tr>
       <td>user_id</td>
    <td>[string]</td>
    <td>The email address of the user signing in.</td>
    <td>Mandatory</td>
  </tr>

  <tr>
       <td>signed_in_state</td>
    <td>boolean</td>
    <td>Indicates whether the user is signed in. Default = true.</td>
    <td>Mandatory</td>
  </tr>
  <tr>
       <td>signin_time</td>
    <td>string</td>
    <td>The date and time of sign-in, obtained using <code>getCurrentDateAndTimeFormat
    (System.currentTimeMillis())</code>.
    </td>
    <td>Mandatory</td>
  </tr>
  <tr>
       <td>signout_time</td>
    <td>[string]</td>
    <td>The sign-out time, initially empty.</td>
    <td>Optional</td>
  </tr>
  <tr>
       <td>METHOD_NAME</td>
    <td>[string]</td>
    <td>The name of the method being called on the ContentResolver. Default = "currentsession".</td>
    <td>Mandatory</td>
  </tr>

</tbody></table>

<p><strong>Response:</strong> The response returns a Cursor object that contains the required bundle.</p>

<h4 id="samplecode-4" class="anchor"><a class="heading-anchor" href="#samplecode-4"><span></span></a>Sample Code</h4>

<p>To set the current user session sign-in state:</p>

<pre class="prettyprint"><code>    public void setSessionSignInState() {
        ContentResolver contentResolver = getContentResolver();
        Uri uri = Uri.parse("content://com.zebra.mdna.els.provider/");
        String METHOD_NAME = "currentsession";

        // Creating a bundle to pass user session information
        Bundle bundle = new Bundle();
        bundle.putString("user_id", "user1@zebra.com");
        bundle.putBoolean("signed_in_state", true);
        bundle.putString("signin_time", getCurrentDateAndTimeFormat(System.currentTimeMillis()));
        bundle.putString("signout_time", ""); // Sign-out time is initially empty

        // Calling the content resolver to get the current session data
        Bundle response = contentResolver.call(uri, METHOD_NAME, null, bundle);

        // Checking if the response is not null and contains the "RESULT" key
        if (response != null &amp;&amp; response.containsKey("RESULT")) {
            // Logging the proxy result
            Log.i(TAG, response.getString("RESULT"));
        }
    }
</code></pre>

<h4 id="sampleresponse-1" class="anchor"><a class="heading-anchor" href="#sampleresponse-1"><span></span></a>Sample Response</h4>

<pre class="prettyprint"><code>    {
        "status": "SUCCESS",
        "message": "successfully executed"
    }
</code></pre>

<h3 id="setsessionsignoutstate" class="anchor"><a class="heading-anchor" href="#setsessionsignoutstate"><span></span></a>Set Session Sign-Out State</h3>

<p><strong>Description:</strong> This API uses a content URI to notify Identity Guardian when a user signs out through a third-party app that blocks the device screen in place of Identity Guardian. It informs Identity Guardian that a user session has ended, ensuring user authentication and access control are effectively handled in Proxy Mode. The API returns a result string from the bundle and if the result string is not empty, it should be parsed as a JSON object.</p>

<p><strong>Content URI:</strong> &nbsp;&nbsp;<span style="font-family:'Courier New'">content://com.zebra.mdna.els.provider/currentsession</span></p>

<p><strong>Input Keys:</strong> </p>

<table class="facelift" style="width:100%" border="1" padding="5px">
  <tbody><tr bgcolor="#dce8ef">
    <th>Key</th>
    <th>Value Type</th>
    <th>Description</th>
    <th>Requirement</th>
  </tr>

  <tr>
       <td>user_id</td>
    <td>[string]</td>
    <td>The email address of the user signing in.</td>
    <td>Mandatory</td>
  </tr>

  <tr>
       <td>signed_out_state</td>
    <td>boolean</td>
    <td>Indicates whether the user is signed out. Default = false.</td>
    <td>Mandatory</td>
  </tr>
  <tr>
       <td>signin_time</td>
    <td>string</td>
    <td>The sign-in time. Default = (null)  </td>
    <td>Optional</td>
  </tr>
  <tr>
       <td>signout_time</td>
    <td>[string]</td>
    <td>The date and time of sign-out, obtained using <code>getCurrentDateAndTimeFormat
    (System.currentTimeMillis())</code>.</td>
    <td>Mandatory</td>
  </tr>
  <tr>
       <td>METHOD_NAME</td>
    <td>[string]</td>
    <td>The name of the method being called on the ContentResolver. Default = "currentsession".</td>
    <td>Mandatory</td>
  </tr>

</tbody></table>

<p><strong>Response:</strong> The response returns a Cursor object that contains the required bundle.</p>

<h4 id="samplecode-5" class="anchor"><a class="heading-anchor" href="#samplecode-5"><span></span></a>Sample Code</h4>

<p>To set the current user session sign-out state:</p>

<pre class="prettyprint"><code>    public void setSessionSignOutState() {
        ContentResolver contentResolver = getContentResolver();
        Uri uri = Uri.parse("content://com.zebra.mdna.els.provider/");
        String METHOD_NAME = "currentsession";

        // Creating a bundle to pass user session information
        Bundle bundle = new Bundle();
        bundle.putString("user_id", "user1@zebra.com");
        bundle.putBoolean("signed_in_state", false);
        bundle.putString("signin_time", ""); // Sign-in time is left empty for sign-out state
        bundle.putString("signout_time", getCurrentDateAndTimeFormat(System.currentTimeMillis())); // Setting the current sign-out time


        // Calling the content resolver to update the current session data
        Bundle response = contentResolver.call(uri, METHOD_NAME, null, bundle);

        // Checking if the response is not null and contains the "RESULT" key
        if (response != null &amp;&amp; response.containsKey("RESULT")) {

            Log.i(TAG, response.getString("RESULT"));
        }
    }
</code></pre>

<h4 id="sampleresponse-2" class="anchor"><a class="heading-anchor" href="#sampleresponse-2"><span></span></a>Sample Response</h4>

<pre class="prettyprint"><code>    {
        "status": "SUCCESS",
        "message": "successfully executed"
    }
</code></pre>

<!-- 
**General Sample code:**

        Uri URI_USER_CURRENT_SESSION = Uri.parse("content://com.zebra.mdna.els.provider/currentsession");
        Cursor cursor = cr.query(URI_USER_CURRENT_SESSION, null, null, null, null);

**Sample code for using [Proxy Mode](../usage/#proxymode) to send sign-in and sign-out notifications to Identity Guardian:**

        public void setCurrentUserDetailsForProxy() {
            ContentResolver contentResolver = getContentResolver();
            Uri uri = Uri.parse("content://com.zebra.mdna.els.provider/");
            String METHOD_NAME = "currentsession";

            // Create a bundle to pass user session information
            Bundle bundle = new Bundle();
            bundle.putString("user_id", "user1@zebra.com");
            bundle.putBoolean("signed_in_state", true);
            bundle.putString("signin_time", getCurrentDateAndTimeFormat(System.currentTimeMillis()));
            bundle.putString("signout_time", ""); // Sign-out time is initially empty

            // Call the content resolver to get the current session data
            Bundle response = contentResolver.call(uri, METHOD_NAME, null, bundle);

            // Check if the response is not null and contains the "RESULT" key
            if (response != null && response.containsKey("RESULT")) {
                // Log the proxy result
                Log.i(TAG, response.getString("RESULT"));
            }
        }

        private String getCurrentDateAndTimeFormat(long currentTimeMillis) {
            SimpleDateFormat sdf = new SimpleDateFormat("yyyy-dd-MM HH:mm:ss.SSSZ", Locale.getDefault());
            return sdf.format(new Date(currentTimeMillis));
        }

-->

<hr>

<h2 id="startauthentication" class="anchor"><a class="heading-anchor" href="#startauthentication"><span></span></a>Start Authentication</h2>

<p><strong>Description:</strong> This API uses a content URI to launch Identity Guardian and display its lock screen, restricting device access until the user successfully signs in and authenticates.</p>

<p><strong>Content URI:</strong> &nbsp;&nbsp;<span style="font-family:'Courier New'">content://com.zebra.mdna.els.provider/lockscreenaction/startauthentication</span></p>

<p><strong>Input Keys:</strong></p>

<table class="facelift" style="width:70%" border="1" padding="5px">
  <tbody><tr bgcolor="#dce8ef">
    <th>Key</th>
    <th>Description/Value</th>
  </tr>

  <tr>
       <td>user_verification</td>
    <td>Specifies the authentication scheme to apply for the user:<br><b>&nbsp;&nbsp;&nbsp;• authenticationScheme1</b><br><b>&nbsp;&nbsp;&nbsp;• authenticationScheme2</b><br><b>&nbsp;&nbsp;&nbsp;• authenticationScheme3</b><br><b>&nbsp;&nbsp;&nbsp;• authenticationScheme4</b></td>
  </tr>

  <tr>
    <td>launchflag</td>
    <td>Determines the accessibility of certain device features: <br><b>&nbsp;&nbsp;&nbsp;• blocking -</b> The notification bar, system bar, home button and recent button are disabled, preventing user access to these features. <br><b>&nbsp;&nbsp;&nbsp;• unblocking -</b> Allows standard device operations with normal access to the notification bar, system bar, home button and recent button.</td>
  </tr>

</tbody></table>

<p><strong>Return RESULT for authState:</strong></p>

<ul>
<li><strong>IN_PROGRESS -</strong> The device screen is in the process of being locked by Identity Guardian.</li>

<li><strong>BUSY -</strong> The device screen is already locked by another application.</li>

<li><strong>SUCCESS -</strong> The device screen is successfully locked by Identity Guardian.</li>

<li><strong>ERROR -</strong> An exception has occurred.</li>
</ul>

<p><strong>Response:</strong> None</p>

<h4 id="samplecode-6" class="anchor"><a class="heading-anchor" href="#samplecode-6"><span></span></a>Sample Code</h4>

<pre class="prettyprint"><code>    String BASE_URI = "content://com.zebra.mdna.els.provider/";
    private final String USER_VERIFICATION = "user_verification";
    private final String LAUNCH_FLAG = "launchflag";
    Uri uri = Uri.parse(BASE_URI);

    String METHOD_NAME = "lockscreenaction";
    String API_NAME = "startauthentication";
    ContentResolver cr = getContentResolver();
    Bundle bundle = new Bundle();
    bundle.putString(USER_VERIFICATION, "authenticationScheme1");
    bundle.putString(LAUNCH_FLAG, "blocking");

    Bundle response = cr.call(uri, METHOD_NAME, API_NAME, bundle);
    if (response != null &amp;&amp; response.containsKey("RESULT")) {
        Log.i(TAG, response.getString("RESULT"));
    }
</code></pre>

<hr>

<h2 id="getauthenticationstatus" class="anchor"><a class="heading-anchor" href="#getauthenticationstatus"><span></span></a>Get Authentication Status</h2>

<p><strong>Description:</strong> After invoking <a href="#startauthentication">Start Authentication</a>, monitor the Identity Guardian status of screen lock state and user sign in/out by registering for notifications for these state changes. For example, if Identity Guardian launched successfully, is about to launch or is launched by another application, listen for these notifications to determine if further action is needed.</p>

<p><strong>Content URI:</strong> &nbsp;&nbsp;<span style="font-family:'Courier New'">content://com.zebra.mdna.els.provider/lockscreenaction/authenticationstatus</span></p>

<p><strong>Return RESULT for authState:</strong></p>

<ul>
<li><strong>IN_PROGRESS -</strong> The device screen is in the process of being locked by Identity Guardian.</li>

<li><strong>BUSY -</strong> The device screen is already locked by another application.</li>

<li><strong>SUCCESS -</strong> The device screen is successfully locked by Identity Guardian.</li>

<li><strong>ERROR -</strong> An exception has occurred.</li>
</ul>

<p>To register for application state changes (sign-in/out, screen lock status):</p>

<pre class="prettyprint"><code>    Uri URI_AUTHENTICATION_STATUS = Uri.parse("content://com.zebra.mdna.els.provider/lockscreenaction/authenticationstatus");
    cr.registerContentObserver(URI_AUTHENTICATION_STATUS,false,contentObserverAuthenticationStatus);
    contentObserverAuthenticationStatus = new ContentObserver(new Handler(getMainLooper())) {

        @Override
        public void onChange(boolean selfChange, Uri uri) {
            super.onChange(selfChange, uri);
            Log.d(TAG, "content has changed, uri = " + uri);
        }
    }
</code></pre>

<h4 id="samplecode-7" class="anchor"><a class="heading-anchor" href="#samplecode-7"><span></span></a>Sample Code</h4>

<pre class="prettyprint"><code>    Uri uri = Uri.parse(BASE_URI + "lockscreenaction/authenticationstatus");
    ContentResolver cr = getContentResolver();
    Cursor cursor = cr.query(uri, null, null, null, null);

    if (cursor != null){
        Bundle bundle = cursor.getExtras();
        if (bundle != null &amp;&amp; bundle.containsKey("RESULT")) {
            String valueFromBundle = bundle.getString("RESULT");
            Log.i("TAG", "" + valueFromBundle);

        }
    }
</code></pre>

<h4 id="sampleresponse-3" class="anchor"><a class="heading-anchor" href="#sampleresponse-3"><span></span></a>Sample Response</h4>

<pre class="prettyprint"><code>    {
        "code":0,
        "message":"Authenticated user",
        "status":"SUCCESS",
        "userData":{
            "applicationId":"com.test.lob_testapp_2",
            "authenticationFactors":"{\"schemaVersion\":\"1.0\",\"factors\":[{\"factor\":\"FACE\",\"factorType\":\"PRIMARYPRIMARYFACTOR\",\"status\":\"EXECUTED\"},{\"factor\":\"SSO\",\"factorType\":\"PRIMARYSECONDARYFACTOR1\",\"status\":\"EXECUTED\"}],\"eventType\":\"CurrentUser\",\"lockScreenEventType\":\"\"}",
            "barcodeId":"1739865839261241C0FF",
            "securityTypes":"PASSCODE,FACE",
            "ssoAccessToken":"abcde12345",
            "ssoData":"{\"aud\":\"f46bf88f-e5a7-441d-bc19-096b2dacdde2\",\"iss\":\"https://login.microsoftonline.com/fcefc790-f4eb-456b-86fa-0e8153bac15c/v2.0\",\"iat\":1739987646,\"nbf\":1739987646,\"exp\":1739991546,\"aio\":\"AWQAm/8ZAAAARnEq5w9eYS5XuZD3mLC0Oj3ZEk7B5P2S1tHqMTir3iOzFsJesfokcttY3J0NJyzDA3nrILT4LnebsK74zA4zSrPP2Zt4MhivOClX+RtNiqwy7dHVDRes8Zuhef2CQw2Y\",\"name\":\"sujith.chakka\",\"oid\":\"d2da2d27-ae35-43eb-b3a2-b398890b50d9\",\"preferred_username\":\"sujith.chakka@zebrablr.onmicrosoft.com\",\"rh\":\"1.Ab4AkMfv_Ov0a0WG-g6BU7rBXI_4a_Sn5R1EvBkJay2s3eK-AL--AA.\",\"sid\":\"00217299-9dc2-713f-e49f-65fceaf50e08\",\"sub\":\"E7p4Dj1EjzcGFiSF327esrZZBs66CRR45Lr-qH9tcAw\",\"tid\":\"fcefc790-f4eb-456b-86fa-0e8153bac15c\",\"uti\":\"Gb8Qwz5knUatbiriY7ejAA\",\"ver\":\"2.0\"}",
            "ssoProvider":"Microsoft",
            "storageType":"BARCODE",
            "userId":"sujith.chakka@zebrablr.onmicrosoft.com",
            "userLoggedInState":"SUCCESS",
            "userLoginTime":"1739987947747",
            "userRole":"",
            "validThrough":"1740124980000"
        }
    }
</code></pre>

<hr>

<h2 id="logoutuser" class="anchor"><a class="heading-anchor" href="#logoutuser"><span></span></a>Logout User</h2>

<p><strong>Description:</strong> This API uses a content URI to log out the user who has authenticated on the device. It interacts with a content provider to execute the logout and returns a response from the provider. This is applicable when <a href="../usage/#proxymode">Proxy Mode</a> is not active.</p>

<p><strong>Content URI:</strong> &nbsp;&nbsp;<span style="font-family:'Courier New'">content://com.zebra.mdna.els.provider/currentsession</span></p>

<p><strong>Input Keys:</strong> None</p>

<p><strong>Response:</strong> The response returns a Cursor object that contains the required bundle.</p>

<h4 id="samplecode-8" class="anchor"><a class="heading-anchor" href="#samplecode-8"><span></span></a>Sample Code</h4>

<pre class="prettyprint"><code>    public void userSessionLogout() {
        Uri uri = Uri.parse(BASE_URI); // Content provider URI
        String METHOD_NAME = "lockscreenaction"; // Method name for lock screen actions
        String API_NAME = "logout"; // API name for logout operation

        ContentResolver cr = getContentResolver(); // Get content resolver to interact with the provider
        Bundle response = cr.call(uri, METHOD_NAME, API_NAME, null); // Send logout request to content provider

        if (response != null &amp;&amp; response.containsKey("RESULT")) {
            // Check if response is valid and contains the expected RESULT key
            provider_response.setText(response.getString("RESULT")); // Update UI with the response message
            Log.i(TAG, "ZBA_LOCK STATE: " + response.getString("RESULT")); // Log the result 
        }
    }
</code></pre>

<h4 id="sampleresponse-4" class="anchor"><a class="heading-anchor" href="#sampleresponse-4"><span></span></a>Sample Response</h4>

<p>Sample response for a user that successfully logs out:</p>

<pre class="prettyprint"><code>    {
        "status": "SUCCESS",
    }
</code></pre>

<hr>

<h2 id="lockscreenmessage" class="anchor"><a class="heading-anchor" href="#lockscreenmessage"><span></span></a>Lock Screen Message</h2>

<p><strong>Description:</strong> This API allows messages to be displayed on the Identity Guardian lock screen of a device, enabling communication of important information to users even when their devices are locked. Applications can create custom messages with specified titles, descriptions and severity types, and also configure the message's timeout duration and dismissibility. </p>

<p><strong>Input Parameters:</strong> </p>

<table class="facelift" style="width:100%" border="1" padding="5px">
  <tbody><tr bgcolor="#dce8ef">
    <th>Parameter</th>
    <th>Value Type</th>
    <th>Description</th>
  </tr>

  <tr>
       <td>BASE_URI</td>
    <td>[string]</td>
    <td>The base URI for the content provider: <code>content://com.zebra.mdna.els.provider/</code></td>
  </tr>

  <tr>
    <td>METHOD_NAME</td>
    <td>[string]</td>
    <td>The method name for the lock screen action: lockscreenaction</td>
  </tr>

  <tr>
    <td>API_NAME</td>
    <td>[string]</td>
    <td>The API name for showing the message: showmessage </td>
  </tr>

  <tr>
    <td rowspan="5">Bundle Parameters</td>
    <td>(varies, see description)</td>
    <td><table>
        <tbody><tr>
            <td><b>Title</b></td>
            <td>([string]) The title of the message to be displayed.</td>
        </tr>
        <tr>
            <td><b>Message</b></td>
            <td>([string]) The description or body of the message.</td>
        </tr>
        <tr>
            <td><b>Type</b></td>
            <td>([string]) The category or significance level of the message (e.g., critical, error, etc.).</td>
        </tr>
        <tr>
            <td><b>Timeout</b></td>
            <td>(integer) The duration, in seconds, after which the message will automatically disappear.</td>
        </tr>
        <tr>
            <td><b>Dismissible</b></td>
            <td>(boolean) A boolean value (true or false) that indicates whether the user can dismiss the message.</td>
        </tr>
        </tbody></table>
    </td>
  </tr>

</tbody></table>

<p><strong>Response:</strong> None</p>

<h4 id="samplecode-9" class="anchor"><a class="heading-anchor" href="#samplecode-9"><span></span></a>Sample Code</h4>

<p>Sample code demonstrating how to display a lock screen message:</p>

<pre class="prettyprint"><code>    public static final String BASE_URI = "content://com.zebra.mdna.els.provider/";

    public void executeLockScreenAction() {
        // Retrieving input values from the UI components
        EditText title = findViewById(R.id.title);
        EditText msg = findViewById(R.id.message);
        EditText timeout = findViewById(R.id.timeout);
        EditText type = findViewById(R.id.messagetype);
        CheckBox dismiss = findViewById(R.id.checkbox_dismiss);

        // Parsing the base URI
        Uri uri = Uri.parse(BASE_URI);
        String METHOD_NAME = "lockscreenaction";
        String API_NAME = "showmessage";

        // Creating a ContentResolver instance
        ContentResolver cr = getContentResolver();

        // Creating a bundle to pass the message parameters
        Bundle bundle = new Bundle();
        bundle.putString("Title", title.getText().toString().trim()); // Title of the message
        bundle.putString("Message", msg.getText().toString().trim()); // Message description
        bundle.putString("Type", type.getText().toString().trim()); // Type of the message (e.g., critical, error, etc.)

        try {
            // Setting the timeout duration
            bundle.putInt("Timeout", Integer.parseInt(timeout.getText().toString()));
        } catch (Exception e) {
            bundle.putInt("Timeout", 0); // Default timeout value if parsing fails
        }

        // Setting the dismissibility of the message
        bundle.putBoolean("Dismissible", dismiss.isChecked());

        // Calling the content provider to display the message
        Bundle response = cr.call(uri, METHOD_NAME, API_NAME, bundle);

        // Handling the response from the content provider
        if (response != null &amp;&amp; response.containsKey("RESULT")) {
            Log.i(TAG, response.getString("RESULT"));
            if (response.getString("RESULT").equals("SUCCESS")) {
                if (response.containsKey("DATA")) {
                    Log.i(TAG, "Data received: " + response.getString("RESULT") + " " + response.getString("DATA"));
                    provider_response.setText(response.getString("RESULT") + " " + response.getString("DATA"));
                }
            } else {
                Log.i(TAG, "Result received: " + response.getString("RESULT"));
                provider_response.setText(response.getString("RESULT"));
            }
        }
    }
</code></pre>

<hr>

<h2 id="developerguide" class="anchor"><a class="heading-anchor" href="#developerguide"><span></span></a>Developer Guide</h2>

<p>For in-depth guidance on use of Identity Guardian APIs, refer to the blog post <a href="https://developer.zebra.com/blog/mastering-identity-guardians-apis">Mastering Identity Guardian APIs</a> written by a Zebra developer, along with the corresponding <a href="https://github.com/ZebraDevs/kotlin-identity-guardian-playground">sample app</a>.</p>

<hr>

<h2 id="seealso" class="anchor"><a class="heading-anchor" href="#seealso"><span></span></a>See Also</h2>

<ul>
<li><a href="../about">About Identity Guardian</a></li>

<li><a href="../licensing/">Licensing</a></li>

<li><a href="../setup">Setup</a></li>

<li><a href="../usage">User Guide</a></li>

<li><a href="../mc">Managed Configurations</a></li>

<li><a href="../faq/">FAQ</a></li>
</ul><p></p>
                                        


                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div><!--/.col-sm-6-->
            </div>
            </section>
        </div>
    </section>    

<div class="modal fade" id="basicModal" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true" data-backdrop="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
					</div>
					<div class="modal-body">
						<div id="modalImg">
						
						</div>
					</div>
			</div>
		  </div>
		</div> </div>
         <footer id="footer">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-sm-10">
                        ZEBRA and the stylized Zebra head are trademarks of Zebra Technologies Corp., registered in many jurisdictions worldwide. All other trademarks are the property of their respective owners. ©2025 Zebra Technologies Corp. and/or its affiliates.<br> <a href="https://www.zebra.com/us/en/about-zebra/company-information/legal.html">Legal</a> | <a href="https://www.zebra.com/us/en/about-zebra/company-information/compliance/information-privacy/terms-of-use.html">Terms of Use</a> | <a href="https://www.zebra.com/us/en/about-zebra/company-information/legal/privacy-statement.html">Privacy Policy</a> 
                    </div>
                     <!--
                     <div class="col-sm-2">
                        <ul class="social-icons">
                            <li><a href="http://www.facebook.com/pages/Zebra-Technologies/107703715989073"><i class="fa fa-facebook"></i></a></li>
                            <li><a href="https://twitter.com/ZebraDevs"><i class="fa fa-twitter"></i></a></li>
                            <li><a href="http://www.youtube.com/zebratechnologies/"><i class="fa fa-youtube"></i></a></li>
                            <li><a href="https://www.linkedin.com/groups?home=&gid=3220074&trk=anet_ug_hm&goback=%2Egmr_3220074"><i class="fa fa-linkedin"></i></a></li>
                            <li><a href="https://github.com/developer-zebra"><i class="fa fa-github"></i></a></li>
                        </ul>
                    </div> -->
                 </div>
            </div>
        </footer>
    
    <!--/#footer 
        10/25/18 removed <footer id="footer" class="navbar-fixed-bottom">
    -->
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/owl.carousel.min.js"></script>
    <script src="/js/mousescroll.js"></script>
    <script src="/js/smoothscroll.js"></script>
    <script src="/js/jquery.prettyPhoto.js"></script>
    <script src="/js/jquery.isotope.min.js"></script>
    <script src="/js/jquery.inview.min.js"></script>
    <script src="/js/wow.min.js"></script>
    <script src="/js/bootstrap-treenav.min.js"></script>
    <script src="/js/prettify.js"></script>
    <script src="/js/zepto.js"></script>
    <script src="/js/jquery.waterfall.js"></script>   
    <script src="/js/main.js"></script>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','zRzEsAUhWTTkrdEN2YfA','2.0.0');
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-72584442-1', 'auto');
  ga('send', 'pageview');

</script> 

<script>
    ChatraID = 'QDvZ76min4DhLW5vJ';
    (function(d, w, c) {
        var n = d.getElementsByTagName('script')[0],
            s = d.createElement('script');
        w[c] = w[c] || function() {
            (w[c].q = w[c].q || []).push(arguments);
        };
        s.async = true;
        s.src = (d.location.protocol === 'https:' ? 'https:': 'http:')
            + '//call.chatra.io/chatra.js';
        n.parentNode.insertBefore(s, n);
    })(document, window, 'Chatra');
</script>         


</body></html>