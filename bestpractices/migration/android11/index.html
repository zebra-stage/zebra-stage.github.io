
<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="-1">
    <meta http-equiv="CACHE-CONTROL" content="NO-CACHE">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Online Documentation for Zebra Technologies developer tools and utiltiescomp including EMDK for Android, EMDK for Xamarin, StageNow, Enterprise Browser.">
    <meta name="author" content="Zebra Technologies">
    <meta name="google-site-verification" content="i4B78BrWnNy8ShJwe5feRW3jO3HE6gfYlYqYbxfl8yY">
    <meta name="msvalidate.01" content="6B651B00161BCE79B8950AC09D5C4C75">
    <meta title="Android 11 - Its Impact on Zebra Developers">
    <title>Android 11 - Its Impact on Zebra Developers - Zebra Technologies TechDocs</title>
    <!-- core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    <link href="/css/animate.min.css" rel="stylesheet">
    <link href="/css/owl.carousel.css" rel="stylesheet">
    <link href="/css/owl.transitions.css" rel="stylesheet">
    <link href="/css/prettyPhoto.css" rel="stylesheet">
    <link href="/css/main.css?version=3.2" rel="stylesheet">
    <link href="/css/responsive.css" rel="stylesheet">
    <link href="/css/prettify.css" rel="stylesheet">
    <link href="/css/bootstrap-treenav.min.css" rel="stylesheet">
    <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
    <script src="js/respond.min.js"></script>
    <![endif]--> 

  <!-- 3/1/19 - comment out per Rob  
      <script src="//load.sumome.com/" data-sumo-site-id="699cb66cf4dc59352efb45705526d15cbe314e1cd43f7761b94d96f3cf7338e8" async="async"></script> 
    -->
    <link rel="shortcut icon" href="/favicon.ico">
<script src="/js/jquery.js"></script></head><!--/head-->


<body id="home" class="homepage" data-spy="scroll" data-offset="100" data-target="#toc">

    <header id="header">
        <nav id="main-menu" class="navbar navbar-default navbar-fixed-top" role="banner">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/"><img src="/images/logo.png" alt="logo" style="max-height:66px;float: inherit;
    padding-right: 3px;"></a> 
                    
                   
                </div>
                <div class="collapse navbar-collapse navbar-left">
                    <ul class="nav navbar-nav">
                        <li class="navbar-text pull-left"><strong>TechDocs</strong></li>
                        <p class="navbar-text">
                                            Best Practices
                        </p>

                    </ul>
                </div>
                <div class="collapse navbar-collapse navbar-right">
                    <ul class="nav navbar-nav">
                        
                    </ul>
                </div>
            </div><!--/.container-->
        </nav><!--/nav-->
    </header><!--/header-->
<div class="container-fluid">
    <section id="blog">
        <div class="">
            <section class="content-with-sidebar">
            <div class="row">
                <div class="col-sm-3 hidden-sm hidden-xs" id="sidebar">
                    
                    
                    <nav id="toc" data-toggle="toc" data-spy="affix" style="height: 75%; max-width: 225px; overflow-y: auto; ">
                        
                        <ul class="nav">
                            <li><strong>Android 11 - Its Impact on Zebra Developers</strong></li>
                        </ul>
                    </nav>
                    <div class="modal fade" id="modal-smartdocs" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true" data-backdrop="true">
                    	<div class="modal-dialog">
                    		<div class="modal-content">
                    			<div class="modal-header">
                    				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
                    			</div>
                    			<div class="modal-body">
                    				<form>
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">MX Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="4.0">4.0</option>
                    					  <option value="4.1">4.1</option>
                    					  <option value="4.2">4.2</option>
                    					  <option value="4.3">4.3</option>
                    					  <option value="5.0">5.0</option>
                    					</select>
                    				  </div>						
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">OSX Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="1.0">1.0</option>
                    					  <option value="1.2">1.2</option>
                    					  <option value="1.3.4-56">1.3.4-56</option>
                    					  <option value="3.4">3.4</option>
                    					  <option value="3.5">3.5</option>
                    					  <option value="3.6">3.6</option>
                    					  <option value="4.1">4.1</option>
                    					  <option value="4.2">4.2</option>
                    					  <option value="4.3">4.3</option>
                    					  <option value="4.4">4.4</option>
                    					</select>
                    				  </div>						
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">Android Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="23">6.0 Marshmallow</option>
                    					  <option value="22">5.1 Lollipop</option>
                    					  <option value="21">5.0 Lollipop</option>
                    					  <option value="19">4.4 Kitkat</option>
                    					  <option value="18">4.3 Jellybean</option>
                    					  <option value="17">4.2.x Jellybean</option>
                    					  <option value="16">4.1.x Jellybean</option>
                    					  <option value="15">4.0.3-4.0.4 Ice Cream Sandwich</option>
                    					  <option value="14">4.0-4.0.2 Ice Cream Sandwich</option>
                    					  <option value="10">2.3.3-2.3.4 Gingerbread</option>
                    					</select>
                    				  </div>
                    				  <div class="form-group">
                    				  	<button class="primary" id="btn_SaveSmartDocOptions">Save Changes</button><button class="primary" id="btn_ClearSmartDocOptions">Clear Changes</button>
                    				  </div>
                    				</form>
                    			</div>
                    	</div>
                      </div>
                    </div>
                    
                    <script type="text/javascript">
                        $(document).ready(function() {
                        	$( "#btn_SaveSmartDocOptions" ).click(function() {
                      			console.log('Saving Options');
                      			$("#modal-smartdocs").modal({show: false});
                    		});
                        	$( "#btn_SaveSmartDocOptions" ).click(function() {
                      			console.log('Clearing Options');
                      			$("#modal-smartdocs").modal({show: false});
                    		});
                        });
                    </script><link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.3.0/dist/bootstrap-toc.min.css">
                    <script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.3.0/dist/bootstrap-toc.min.js"></script>
                    <script type="text/javascript">
                        $(document).ready(function() {
                    
                        });
                    
                    
                    </script>
                </div>                
                <div class="col-sm-9 ">
                    <div class="row">
                        <div class="col-sm-12">
                            <section id="cta" class="wow fadeIn">
                                <div class="">
                                    <h1 id="android-11---its-impact-on-zebra-developers" class="anchor"><a class="heading-anchor" href="#android-11---its-impact-on-zebra-developers"><span></span></a>Android 11 - Its Impact on Zebra Developers</h1>
                                    <p>
                                            Best Practices
                                    </p>
                                </div>
                            </section>                    
                        </div>
                    </div>
                    <div id="mainContent" class="row">
                        <div class="col-sm-12">
                            <div class="blog-post blog-large wow fadeInLeft" data-wow-duration="300ms" data-wow-delay="0ms">
                            <!-- Start of guide -->
                                <div class="service-box wow fadeInRight">
                                    <div class="">

                                        <p></p><p><em>By Darryn Campbell, Software Architect</em></p>

<p>This document details the developer impact of moving to Zebra devices running <a href="https://developer.android.com/about/versions/11">Android 11</a> (API level 30) and is a follow-up to my previous posts about what’s new for enterprise developers in Android <a href="https://developer.zebra.com/blog/what%E2%80%99s-new-android-10-and-impact-zebra-developers">10</a>, <a href="https://developer.zebra.com/blog/what%E2%80%99s-new-android-pie-and-impact-zebra-developers">Pie</a>, <a href="https://developer.zebra.com/blog/what%E2%80%99s-new-android-oreo-and-impact-zebra-developers">Oreo</a>, <a href="https://developer.zebra.com/blog/what%E2%80%99s-new-android-%E2%80%98n%E2%80%99-and-impact-zebra-developers">Nougat</a> and <a href="https://developer.zebra.com/blog/what%25E2%2580%2599s-new-android-%25E2%2580%2598m%25E2%2580%2599-and-impact-zebra-developers">Marshmallow</a>.  If you are moving from an earlier version of Android directly to 11, I recommend that you read the documents in sequence since all the earlier information is pertinent to subsequent releases.</p>

<p>Please also refer to the <a href="/bestpractices/migration">Android Version Migration</a> page on Zebra TechDocs.</p>

<hr>

<h2 id="overview" class="anchor"><a class="heading-anchor" href="#overview"><span></span></a>Overview</h2>

<p>Google emphasises a continued focus on user privacy in Android 11 which does not always translate to an enterprise environment with shared devices and “corporate owned” task-specific devices. The purpose of this document is to highlight those Android 11 changes of relevance to Zebra enterprise devices.</p>

<p>Google has published highlights of the Android 11 changes on its developer portal and has broken down the changes as follows:</p>

<ul>
<li><a href="https://developer.android.com/about/versions/11/privacy">Privacy</a></li>

<li><a href="https://developer.android.com/about/versions/11/features">New features &amp; APIs</a></li>

<li><a href="https://developer.android.com/about/versions/11/behavior-changes-all">Behaviour changes</a></li>
</ul>

<p>Google also has published information about <a href="https://developer.android.com/work/versions/android-11">changes to Android enterprise features in 11</a>, but those are applicable only to EMM developers.</p>

<p><strong>This document does not replace recommendations from Google; it is designed to supplement those recommendations for enterprise use cases.</strong></p>

<hr>

<h2 id="audienceforthisdocument" class="anchor"><a class="heading-anchor" href="#audienceforthisdocument"><span></span></a>Audience for This Document</h2>

<p>Many Zebra devices will either receive or be shipped with an upgrade to Android 11. Please refer to your device’s specification sheet and consult your local Zebra representative for more authoritative information. Any developers targeting deployments featuring at least one Android 11 device or devices that will be updated to 11 should be aware of the changes detailed here.</p>

<p>This document covers the Android platform changes introduced in A11 and their impact on Zebra developers. It does not attempt to cover new device features introduced by Zebra unless there is overlap.</p>

<hr>

<h2 id="privacyupdates" class="anchor"><a class="heading-anchor" href="#privacyupdates"><span></span></a>Privacy Updates</h2>

<h3 id="scopedstorageupdates" class="anchor"><a class="heading-anchor" href="#scopedstorageupdates"><span></span></a>Scoped Storage Updates</h3>

<p><a href="https://developer.android.com/training/data-storage#scoped-storage">Scoped Storage</a> was first introduced in Android 10 and by default, restricted the access to mass storage that was available to an application. An application configured for scoped storage is only able to access a sandboxed environment in external storage (what used to be the SD card) meaning it cannot share files with other apps unless under specific scenarios such as sharing media or using the storage access framework, which requires the end-user to manually select the desired file.</p>

<p>For more information on Scoped Storage please refer to the <a href="https://developer.android.com/training/data-storage#scoped-storage">Android documentation</a> or the previous article, <a href="https://developer.zebra.com/blog/what%E2%80%99s-new-android-10-and-impact-zebra-developers">“What’s new in Android 10 for Zebra developers”</a>.</p>

<p>The recommendation in Android 10 was for enterprise applications to opt-out of scoped storage using the <em>requestLegacyExternalStorage</em> flag, as doing so would require only a minor change and external storage would work as it did on Pie and earlier.</p>

<p>Android 11 <strong>removes</strong> support for the <em>requestLegacyExternalStorage</em> flag for applications that target Android 11 (API level 30). For apps that target Android 10 (API level 29), regardless of which version of Android they are running on, the recommendation is to continue using the <em>requestLegacyExternalStorage</em> flag.</p>

<p>For apps targeting Android 11 (API level 30) the <em>requestLegacyExternalStorage</em> flag is ignored by Android therefore the recommendation is to either:</p>

<ul>
<li>Make use of Zebra’s new Secure Storage Manager (SSM).</li>

<li>Re-architect your application in line with <a href="https://developer.android.com/training/data-storage/use-cases">Google’s recommendations for best practices</a> which might include use of the <a href="https://developer.android.com/training/data-storage/manage-all-files">MANAGE_EXTERNAL_STORAGE</a> permission.</li>
</ul>

<p>There is also the concept of “data migration”, which covers the use case where an application exists on a device and is not using the scoped storage model. When that application updates its target SDK to 30, it can set the <em>preserveLegacyExternalStorage</em> flag to continue using the ‘legacy’ storage model and have access to the files it previously created. This is not a work-around to avoid scoped storage however, as the <em>preserveLegacyExternalStorage</em> flag has no effect if the application was not previously installed on a device.</p>

<p>Another change to the Android storage model is the introduction of <a href="https://developer.android.com/about/versions/11/privacy/storage#all-files-access">‘All files access’</a>, which allows an application access to all files in external storage and is not subject to scoped storage. The caveat is that all such applications need to adhere to these <a href="https://developer.android.com/about/versions/11/privacy/storage#all-files-access">additional Play Store policies</a> - unless they meet this specific criteria, they cannot be published in the Play Store.</p>

<p>More details on how Scoped Storage was updated on Android 11 can be found in the <a href="https://developer.android.com/about/versions/11/privacy/storage">Android documentation</a>.</p>

<h3 id="permissions" class="anchor"><a class="heading-anchor" href="#permissions"><span></span></a>Permissions</h3>

<p>There have been several changes to how runtime permissions work in Android 11:</p>

<ul>
<li><strong>One-time permissions</strong> allow the user to grant permission to an application a single time. The user is prompted again to grant the permission the next time the app is launched.</li>

<li><strong>Permissions auto-reset</strong> causes permission granted previously to be revoked by Android if an app is not launched for "a few months." The user is prompted to grant these permissions again when the app is relaunched.</li>

<li><strong>A user denying a permission more than once</strong> is interpreted as “don’t ask again.” In Android 10, “deny” and “don’t ask again” were separate options. In Android 11, these have been combined.</li>
</ul>

<p>Permissions auto-reset affects only applications whose target SDK is 30 (Android 11). The other permissions changes affect any app running on Android 11.</p>

<table class="facelift" align="center" style="width:80%" border="1" padding="5px">
  <tbody><tr>
   <td align="center">
        <img style="height:350px" src="launch-camera-a10.png">
   </td> 
   <td align="center">
        <img style="height:350px" src="launch-camera-a11.png">
   </td>
  </tr>
  <tr>
    <td><i>Launching the camera app on Android 10, note the separate “Deny” and “Deny &amp; don’t ask again” options.</i>
    </td>
    <td><i>Launching the camera app on Android 11, note the one-time permission of “Only this time.”</i>
    </td>
  </tr>
</tbody></table>

<p>The <a href="https://developer.android.com/about/versions/11/privacy/permissions">Android documentation</a> for <a href="https://developer.android.com/about/versions/11/privacy/permissions#one-time">one-time permissions</a>, <a href="https://developer.android.com/guide/topics/permissions/overview#auto-reset-permissions-unused-apps">auto-reset permissions</a> and <a href="https://developer.android.com/about/versions/11/privacy/permissions#dialog-visibility">permission dialog visibility</a> goes into a lot more detail on these features but the <strong>majority of enterprise developers will be unaffected by these changes.</strong> Applications deployed in an enterprise environment will typically either be deployed by an Enterprise Mobility Management system (EMM) or deployed using <a href="/stagenow">Zebra’s StageNow utility.</a></p>

<p>EMMs offer an option to automatically grant runtime permissions and it is always best practice to enable this option to ensure the end-user cannot break the workflow of your app by denying runtime permissions. Zebra’s StageNow utility automatically grants runtime permissions when an app is installed using the <a href="/stagenow/latest/csp/app/">App Manager</a> feature.</p>

<p><strong>Applications whose permissions have been automatically granted by either an EMM or StageNow will not be subject to one-time permissions or auto-reset permissions and apps will continue to work on Android 11 without issue.</strong>  </p>

<p>Even if users have access to the Settings panel, they will not be able to enable auto-reset permissions:</p>

<table class="facelift" align="center" style="width:80%" border="1" padding="5px">
  <tbody><tr>
   <td align="center">
        <img style="height:400px" src="auto-grant.png">
   </td> 
   <td align="center">
        <img style="height:400px" src="not-auto-grant.png">
   </td>
  </tr>
  <tr>
    <td><i>Application whose permissions <b>have</b> been automatically granted.</i>
    </td>
    <td><i>Application whose permissions have <b>not</b> been automatically granted. Note the additional ‘Remove permissions…’ option.</i>
    </td>
  </tr>
</tbody></table>

<p>Another best practice is to prevent your end users from accessing device settings to ensure they do not revoke permissions. The settings screen can be blocked in numerous ways. For example, your EMM will have an option for this or you can use the <a href="/stagenow/latest/csp/access/">Access Manager</a> or Zebra’s <a href="/ehs">Enterprise Home Screen</a> utility.</p>

<h3 id="location" class="anchor"><a class="heading-anchor" href="#location"><span></span></a>Location</h3>

<p>Getting a device’s location is a very common use case in the enterprise and Android 11 has made some slight changes to how an application can request location permission. Remember that since Android changes are cumulative, your app will still be subject to the <a href="https://developer.android.com/about/versions/oreo/background-location-limits">“Background Location Limits”</a> introduced in Android Oreo, as well as the need to <a href="https://developer.android.com/about/versions/10/privacy/changes#app-access-device-location">separately request access to background location</a> introduced in Android 10.</p>

<p>The two <a href="https://developer.android.com/about/versions/11/privacy/location">location changes for Android 11</a>:</p>

<ul>
<li>Location is a runtime permission and is therefore subject to the one-time permission changes discussed earlier, whereby a user is given the option to grant the permission “only this time.”</li>

<li>Applications requiring location in the background <strong>must request this permission separately</strong> from the foreground permission.</li>
</ul>

<p>To understand the changes between Android Oreo, 10 and 11 it is probably best shown graphically:</p>

<ul>
<li>Android 10:</li>
</ul>

<table class="facelift" align="center" style="width:80%" border="1" padding="5px">
  <tbody><tr>
   <td align="center">
        <img style="height:350px" src="location-fine-a10-sdk26.jpg">
   </td> 
   <td align="center">
        <img style="height:350px" src="location-fine-a10-sdk29.jpg">
   </td>
   <td align="center">
        <img style="height:350px" src="location-fine-background-a10-sdk29.jpg">
   </td>
  </tr>
  <tr>
    <td><i>Target SDK = 26<br>Requested: ACCESS_FINE_LOCATION only</i></td>
    <td><i>Target SDK = 29<br>Requested: ACCESS_FINE_LOCATION only</i></td>
    <td><i>Target SDK = 29<br>Requested: ACCESS_FINE_LOCATION and ACCESS_BACKGROUND_LOCATION
</i></td>
  </tr>
</tbody></table>

<ul>
<li>Android 11: </li>
</ul>

<table class="facelift" align="center" style="width:60%" border="1" padding="5px">
  <tbody><tr>
   <td align="center">
        <img style="height:400px" src="location-fine-a11-sdk29.jpg">
   </td> 
   <td align="center">
        <img style="height:400px" src="location-fine-background-a11-sdk29.jpg">
   </td>
  </tr>
  <tr>
    <td><i>Target SDK = 29<br>Requested: ACCESS_FINE_LOCATION only</i></td>
    <td><i>Target SDK = 29<br>Requested: ACCESS_FINE_LOCATION and ACCESS_BACKGROUND_LOCATION</i></td>

  </tr>
</tbody></table>

<table class="facelift" align="center" style="width:60%" border="1" padding="5px">
  <tbody><tr>
   <td align="center">
        <img style="height:400px" src="location-fine-a11-sdk30.jpg">
   </td> 
   <td><b><i>All permissions are automatically denied without prompting the user</i></b>
   </td>
  </tr>
  <tr>
    <td><i>Target SDK = 30<br>Requested: ACCESS_FINE_LOCATION only</i></td>
    <td><i>Target SDK = 30<br>Requested: ACCESS_FINE_LOCATION and ACCESS_BACKGROUND_LOCATION</i></td>

  </tr>
</tbody></table>

<p>Some notes on the above:</p>

<ul>
<li>The behaviour of your application running on Android 11 will change regardless of whether you modify your target SDK level.</li>

<li>Requesting both location and background location in the same request on Android 11 is not allowed, regardless of your target SDK.</li>
</ul>

<p>Google has introduced a process for manually approving applications in the Google Play store which <a href="https://support.google.com/googleplay/android-developer/answer/9799150">accesses your location in the background</a>. The reasoning for this was discussed in <a href="https://android-developers.googleblog.com/2020/02/safer-location-access.html">this blog</a>. If you do not comply with Google’s approval process, which involves providing a short video demonstration of how a user is presented the location runtime permission, then your app is subject to removal from Google Play Store. To follow this process, even an app designed to always run with permissions automatically granted must allow for the condition of permissions manually approved by the user. </p>

<p><strong>Notes:</strong> </p>

<ul>
<li>Manual approval of apps on the Google Play store which accesses your location in the background <em>does not apply</em> to <strong>private apps.</strong> </li>

<li>If you are distributing your application outside of Google Play and are automatically granting the location runtime permission (e.g. through StageNow), then your application will not be subject to the changes in location permission between Android 10 and 11.</li>
</ul>

<p>It is always best practice to follow <a href="https://developer.android.com/training/location/permissions#request-location-access-runtime">Google’s guidelines for requesting location access at runtime</a> where the app may find itself running on a device not configured to automatically grant runtime permissions, this is especially important for background location access from Android 11 onwards.</p>

<h3 id="packagevisibility" class="anchor"><a class="heading-anchor" href="#packagevisibility"><span></span></a>Package Visibility</h3>

<p>Applications that target API level 30 (Android 11) are subject to new package visibility changes.  These changes are documented on the <a href="https://developer.android.com/training/package-visibility">Android developer portal</a>. In summary, an application’s ability to query which other applications are installed on the same device is being restricted.  </p>

<p>The Android documentation references several <a href="https://developer.android.com/training/package-visibility/use-cases">use cases</a> such as checking if a browser is available on the device or preventing the disambiguation dialog from being shown. Zebra devices in particular have an important consideration as any API exposed through a Content Provider, such as Zebra’s <a href="/oeminfo">OEMInfo</a> (used to obtain the device serial number, IMEI and BT MAC address) are subject to this restriction. </p>

<p>For OEMInfo, applications wishing to take advantage of the content providers it exposes must specify the following in their application manifest:</p>

<pre class="prettyprint"><code>&lt;queries&gt;
    &lt;package android:name="com.zebra.zebracontentprovider" /&gt;
&lt;/queries&gt;
</code></pre>

<p>Any application using Zebra's <a href="/emdk-for-android">EMDK development tools for Android</a> or <a href="/emdk-for-android">Xamarin</a> must make a similar change to their application manifest:</p>

<pre class="prettyprint"><code>&lt;queries&gt;
    &lt;package android:name="com.symbol.emdk.emdkservice" /&gt;
&lt;/queries&gt;
</code></pre>

<p>Along the same lines, any application using the new Secure Storage Manager must declare access as follows:</p>

<pre class="prettyprint"><code>&lt;queries&gt;
    &lt;provider android:authorities="com.zebra.securestoragemanager.securecontentprovider" /&gt;
&lt;/queries&gt;
</code></pre>

<hr>

<h2 id="otherbehaviouralchanges" class="anchor"><a class="heading-anchor" href="#otherbehaviouralchanges"><span></span></a>Other Behavioural Changes</h2>

<h3 id="wakelocks" class="anchor"><a class="heading-anchor" href="#wakelocks"><span></span></a>Wake Locks</h3>

<p>Battery swap is a feature of many Zebra mobile devices enabling you to replace the battery without fully shutting down the device. Customer applications which hold a wake lock will prevent battery swap from working, therefore wake locks should be cleared when not needed. Android 10 and earlier automatically cleared any wake locks before battery swap proceeded but this behaviour has changed in Android 11.</p>

<h3 id="permissions-1" class="anchor"><a class="heading-anchor" href="#permissions-1"><span></span></a>Permissions</h3>

<p>Android 11 has introduced changes to how the <a href="https://developer.android.com/about/versions/11/privacy/permissions#system-alert">System Alert Window</a> permission is handled as well as when the <a href="https://developer.android.com/about/versions/11/behavior-changes-all#app-usage-stats">App Usage Stats</a> are available regardless of the target API level of the app. Both of these permissions (<a href="https://developer.android.com/reference/android/Manifest.permission#SYSTEM_ALERT_WINDOW">SYSTEM_ALERT_WINDOW</a> and <a href="https://developer.android.com/reference/android/Manifest.permission#PACKAGE_USAGE_STATS">PACKAGE_USAGE_STATS</a> respectively) can be automatically granted via the MX AccessManager’s <a href="https://techdocs.zebra.com/mx/accessmgr/#permission-access-action">Permission Access Action</a> feature and specifying the appropriate <a href="https://techdocs.zebra.com/mx/accessmgr/#permission-access-feature-name">feature name</a>.</p>

<p>These are not standard runtime permissions and must therefore be granted access via MX or via your EMM through <a href="/oemconfig">OEMConfig</a> where supported.</p>

<p>If the System Alert Window permission has been granted in this manner, you will see no behaviour change when moving to Android 11. But applications making use of <a href="https://developer.android.com/about/versions/11/behavior-changes-all#app-usage-stats">App Usage Stats</a> must still follow Google’s guidance when used in a multi-user or keyguard (lock screen) scenario.</p>

<h3 id="mapsv1sharedlibrary" class="anchor"><a class="heading-anchor" href="#mapsv1sharedlibrary"><span></span></a>Maps v1 Shared Library</h3>

<p>Applications still using the Maps v1 shared library should have already transitioned to the <a href="https://developers.google.com/maps/documentation/android-sdk/overview">Maps SDK for Android</a>. This transition is mandated in Android 11 as the old library has been removed.</p>

<h3 id="foregroundservicechanges" class="anchor"><a class="heading-anchor" href="#foregroundservicechanges"><span></span></a>Foreground Service Changes</h3>

<p>Android 11 introduces two new <a href="https://developer.android.com/guide/components/foreground-services#types">foreground service types</a> ‘camera’ and ‘microphone’ to add to the ‘location’ service type introduced in Android 10. Foreground services accessing any of these features must be assigned the appropriate type(s) in order to work. This allows Android to correctly manage what these services are allowed to do. For example, foreground services launched from a background app are not allowed to access the microphone.</p>

<h3 id="macaddressupdates" class="anchor"><a class="heading-anchor" href="#macaddressupdates"><span></span></a>MAC Address Updates</h3>

<p>Android Marshmallow prevented users from accessing the Wi-Fi MAC address of the device programmatically through <em>WifiInfo.getMacAddress()</em>, and it just returned the fixed string “02:00:00:00:00:00”. This led to developers trying to find workarounds to circumvent the restriction with different APIs. This <a href="https://stackoverflow.com/questions/59373452/how-to-get-mac-address-from-an-android-device">StackOverflow post</a> is a good example.</p>

<p>Android 11 introduces restrictions on additional APIs, preventing these workarounds from working. More information on exactly which APIs are changed in more detail is given in the <a href="https://developer.android.com/training/articles/user-data-ids#mac-addresses">Android documentation</a> but the previous advice that Wi-Fi MAC address should not be used as a hardware identifier remains true.</p>

<h3 id="nonsdkinterfacerestrictions" class="anchor"><a class="heading-anchor" href="#nonsdkinterfacerestrictions"><span></span></a>Non-SDK Interface Restrictions</h3>

<p>Restrictions on non-SDK interfaces (i.e. non-public APIs) have been around since Android Pie. Google’s goal is to cut down on an application’s ability to call non-SDK methods via reflection or the JNI while providing a path forward for those apps such as by making additional APIs public.</p>

<p>Google offers <a href="https://developer.android.com/distribute/best-practices/develop/restrictions-non-sdk-interfaces">dedicated documentation</a> for this. Also see my article on how <a href="https://developer.zebra.com/blog/restrictions-non-sdk-interfaces-android-pie">non-SDK interface restrictions affect Zebra developers</a>. The nomenclature has changed a couple of times since the introduction of this feature in Pie; in Android 11 there are still 4 categories but the naming convention has moved away from assigning colour to the lists, they are now ‘blocklist (disallowed)’, ‘conditionally blocked’, ‘unsupported’ and ‘sdk (allowed)’. For more detail on the list changes specifically for Android 11, I recommend <a href="https://developer.android.com/about/versions/11/non-sdk-11">Google’s documentation on the deltas</a>.</p>

<h3 id="changestotheplaystorerequirements" class="anchor"><a class="heading-anchor" href="#changestotheplaystorerequirements"><span></span></a>Changes to the Play Store Requirements</h3>

<p>In 2018, Google began requiring that applications posted to the Google Play store target a recent Android API level. The target SDK level has been updated annually and it is expected that this trend will continue, with announcements made every February. The latest requirements are detailed on the <a href="https://support.google.com/googleplay/android-developer/answer/113469#targetsdk">Android developer support page</a>, but in summary:</p>

<ul>
<li>August 2, 2021: New applications added to Google Play must target API level 30 (Android 11) or higher.</li>

<li>November 1, 2021: Updates to existing applications must target API level 30 (Android 11) or higher.</li>
</ul>

<p>These rules affect only the <strong>target SDK</strong>; you can still assign any minimum SDK level. Google provides <a href="https://developer.android.com/distribute/best-practices/develop/target-sdk">additional documentation</a> for developers whose applications will run on devices with earlier versions of Android than the target SDK.</p>

<p>From August 2021, all new apps will be required to publish with the Android app bundle format. More information is available at this <a href="https://android-developers.googleblog.com/2020/11/new-android-app-bundle-and-target-api.html">Google blog</a> on the topic but please be aware that this restriction does not apply to <a href="https://support.google.com/googleplay/work/answer/6145139">private enterprise apps</a>, which can still be distributed as APKs.</p>

<p>This change to app bundles should only affect a minority of enterprise developers, specifically those distributing to the public play store. But if you do fall into this category, please be aware that any MX feature you use that requires an application signature must be provided with the <strong>app signing certificate for the Google app signing key</strong>, not your upload key. See <a href="https://developer.zebra.com/blog/deploying-your-apps-android-application-bundles-aab">Deploying Your Apps with Android Application Bundles</a> for more information. </p>

<p><img style="height:120px" src="app-signing.png">
<em>App signing for Google Play store</em></p>

<hr>

<h2 id="newfeaturesinandroid11" class="anchor"><a class="heading-anchor" href="#newfeaturesinandroid11"><span></span></a>New Features in Android 11</h2>

<p>Some of the most notable feature updates to Android 11 from the consumer perspective are the introduction of <a href="https://developer.android.com/guide/topics/ui/device-control">IOT device control</a> from the power menu and improvements to how <a href="https://developer.android.com/guide/topics/ui/conversations">conversations</a> are handled with chat bubble support for messaging applications. Neither of these features really fits into the enterprise.</p>

<p>Zebra’s IOT offering from an enterprise perspective is known as <a href="https://www.zebra.com/gb/en/solutions/intelligent-edge-solutions/savanna.html">Savanna</a>. Anyone who has IOT use cases should explore what Savanna has to offer.</p>

<p>We do not see many third-party conversation-style applications written for Zebra enterprise devices. Instead, messaging apps tend to focus on groups and Push-to-Talk functionality. Zebra’s <a href="https://www.zebra.com/gb/en/products/software/mobile-computers/workforce-connect.html">Workforce Connect</a> application is used extensively for this purpose.</p>

<h3 id="captiveportalapisupport" class="anchor"><a class="heading-anchor" href="#captiveportalapisupport"><span></span></a>Captive Portal API Support</h3>

<p>Although captive portal support has been present in Android since Lollipop, Android 11 introduces support for DHCP option 114, which offers far more accurate detection and other new features. For more information, see the Android documentation on <a href="https://developer.android.com/about/versions/11/features/captive-portal">captive portal changes</a>.</p>

<p><img style="height:350px" src="screen-recording.png">
<em>Screen recording</em></p>

<p>Screen recording and optional audio recording is built into Android 11 by default and can be enabled and controlled from the Quick Settings pull-down. Prior to Android 11, screen recording required a third-party application that had to be granted permission to record the screen, something potentially undesirable depending on the sensitivity of information being displayed on the device.</p>

<p>Screen recording can be used for a variety of diagnostic purposes in the enterprise, particularly in offline scenarios where remote display is not available. If your users experience trouble with their device or an application on the device, they can use screen capture to make a short video demonstrating the issue.</p>

<p>Since it is common for the administrator to restrict access to the Quick Settings menu (which also contains Wi-Fi settings, Bluetooth settings, do not disturb etc.), one downside is that this feature may not be available to your end-users since it can be accessed only via this menu.</p>

<h3 id="wirelessdebugging" class="anchor"><a class="heading-anchor" href="#wirelessdebugging"><span></span></a>Wireless Debugging</h3>

<p>Android 11 supports deployment and debugging of applications wirelessly via adb and this works with Zebra devices. Although wireless debugging was possible on earlier versions of Android, it is now possible to configure the feature <strong>without first</strong> connecting the device via a cable.</p>

<p>For full setup instructions, follow the Google <a href="https://developer.android.com/about/versions/11/features#wireless-adb">guide for wireless debugging</a>. The process essentially involves enabling the option on your device, pairing using a pairing code and executing the equivalent adb command from the host machine. The process is quick once you get used to it.</p>

<p>Many Zebra devices require accessories such as cradles or cups to connect via USB. Wireless debugging can be used as an alternative for developers who only have access to the “charging only” variants of these accessories.</p>

<h3 id="dataaccessauditing" class="anchor"><a class="heading-anchor" href="#dataaccessauditing"><span></span></a>Data Access Auditing</h3>

<p>Data access auditing is a new feature available on all devices running Android 11 that ensures your app or its dependant SDKs are not unexpectedly accessing private user data.
Although accessing private user data is uncommon on devices that are typically shared, applications that find themselves needing access data such as the contact list can make use of access auditing to validate there is no unexpected access.</p>

<p>More information and examples are available from <a href="https://developer.android.com/about/versions/11/privacy/data-access-auditing">Android’s documentation</a> on the subject.</p>

<h3 id="androidintheenterprise" class="anchor"><a class="heading-anchor" href="#androidintheenterprise"><span></span></a>Android in the Enterprise</h3>

<p>Google publishes dedicated documentation for <a href="https://developer.android.com/work/versions/android-11">“What’s new for enterprise in Android 11”</a> but that title can be slightly misleading for Zebra developers as most of the features Google has added affect the work profile and company-owned, personally enabled devices.</p>

<p>There are a couple of new APIs worth highlighting that are available to the Device Owner but bear in mind these will need to be exposed by your EMM (or Device Owner) to be available in your deployment:</p>

<ul>
<li>The ability to <a href="https://developer.android.com/reference/android/app/admin/DevicePolicyManager#getFactoryResetProtectionPolicy(android.content.ComponentName)">check</a> or <a href="https://developer.android.com/reference/android/app/admin/DevicePolicyManager#setFactoryResetProtectionPolicy(android.content.ComponentName,%20android.app.admin.FactoryResetProtectionPolicy)">set</a> the <strong>Factory Rest Protection (FRP) policy</strong>. This has been a common request among Zebra customers, particularly the ability to clear FRP which is possible by creating a policy with <a href="https://developer.android.com/reference/android/app/admin/FactoryResetProtectionPolicy.Builder#setFactoryResetProtectionEnabled(boolean)">FRP disabled</a>. For more information, please see my 2018 post on Factory Reset Protection.</li>

<li>The ability to <a href="https://developer.android.com/reference/android/app/admin/DevicePolicyManager#getUserControlDisabledPackages(android.content.ComponentName)">check</a> or <a href="https://developer.android.com/reference/android/app/admin/DevicePolicyManager#setUserControlDisabledPackages(android.content.ComponentName,%20java.util.List%3Cjava.lang.String%3E)">set</a> the <strong>“protected packages”</strong> on a fully managed device. A “protected package” is defined as a package where the user is not able to clear the app data or force-stop it. Zebra’s MX <a href="/mx/accessmgr/">AccessManager</a> can clear the application cache and user data but it is not recommended to clear the app data of a “protected package.”</li>
</ul>

<h3 id="commoncriteria" class="anchor"><a class="heading-anchor" href="#commoncriteria"><span></span></a>Common Criteria</h3>

<p>Zebra devices support <a href="https://www.zebra.com/gb/en/blog/posts/2021/zebra-android-10-devices-receive-common-criteria-certification.html">Common Criteria</a>. For the latest information related to Common Criteria and Android 11 please refer to the <a href="https://www.zebra.com/us/en/support-downloads/security-certification.html">Common Criteria download packages</a>.</p>

<hr>

<h2 id="apichanges" class="anchor"><a class="heading-anchor" href="#apichanges"><span></span></a>API Changes</h2>

<h3 id="toastapi" class="anchor"><a class="heading-anchor" href="#toastapi"><span></span></a>Toast API</h3>

<p>There have been several changes to the Toast mechanism in Android 11:</p>

<ol>
<li><p>Standard, simple toasts are unchanged. If your application is using a simple toast from either the foreground or background, there are <strong>no changes in Android 11.</strong>
<img style="height:60px" src="toast-helloworld.png">
<em>Simple toast</em></p></li>

<li><p>Custom toast views are deprecated. These were any Toasts that called <a href="https://developer.android.com/reference/kotlin/android/widget/Toast#setview">setView()</a>. 
<img style="height:50px" src="toast-custom.png"></p>

<p><em>Custom toast</em></p>

<p>This has two implications for Android 11:</p>

<ul>
<li>Applications attempting to launch a custom toast from the background will not succeed and will generate the following error message in logcat: “W/NotificationService: Blocking custom toast from package <package> due to package not in the foreground.”</package></li>

<li>The <a href="https://developer.android.com/reference/android/widget/Toast#setView(android.view.View)">setView()</a> and <a href="https://developer.android.com/reference/android/widget/Toast#getView()">getView()</a> methods are deprecated and developers are instead encouraged to use a <a href="https://developer.android.com/reference/com/google/android/material/snackbar/Snackbar">SnackBar</a> to display short messages when in the foreground.</li></ul></li>

<li><p>Several of the Toast APIs will no longer return the correct values when the app targets Android 11 including setHorizontalMargin() and setGravity(). See the <a href="https://developer.android.com/about/versions/11/behavior-changes-11#text-toast-api-changes">Toast API changes</a> documentation from Google for the complete list.</p></li>
</ol>

<h3 id="testappcompatibility" class="anchor"><a class="heading-anchor" href="#testappcompatibility"><span></span></a>Test App Compatibility</h3>

<p>As with any new version of Android, it is incumbent on the developer to update and test their application to ensure it works well with the new version. Android has <a href="https://developer.android.com/about/versions/11/migration">summarized the process for app migration</a> for Android 11 which remains consistent with what developers have done for every other Android release (namely testing their app against the newly introduced behavioural and functional changes).</p>

<p>Android 11 has taken this compatibility testing a step further by introducing a new compatibility framework that enables a developer to selectively turn features on and off to isolate changes and update their app to accommodate these features one step at a time. These are exposed through the Android developer options, so is not designed to ‘opt out’ of behavioural changes. The test framework is explained in full detail in the <a href="https://developer.android.com/about/versions/11/test-changes">Android documentation</a>.</p>

<table>
  <tbody><tr>
   <td>
        <img style="height:400px" src="app-compatibility-changes-1.jpg">
   </td> 
   <td>   </td>
   <td>
        <img style="height:400px" src="app-compatibility-changes-2.jpg">
   </td>
  </tr>
</tbody></table>

<p><em>App compatibility changes</em></p>

<p>Although a good step in the right direction, you can test compatibility changes only between Android 10 and Android 11 for now. The ‘location’ foreground service type was introduced in Android 10, but Android 11 introduced the camera/microphone types which are represented by CAMERA_MICROPHONE_CAPABILITY_CHANGE_ID in the second image above; that option is grayed-out because my test app did not have that type of service.</p>

<hr>

<h2 id="conclusion" class="anchor"><a class="heading-anchor" href="#conclusion"><span></span></a>Conclusion</h2>

<p>The biggest changes in Android 11 relate to how permission requests are presented to end users and the mandatory adoption of scoped storage for applications targeting API level 30. The changes to permission requests will only affect a minority of enterprise deployments and the changes to scoped storage were discussed earlier in this post.</p><p></p>
                                        


                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div><!--/.col-sm-6-->
            </div>
            </section>
        </div>
    </section>    

<div class="modal fade" id="basicModal" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true" data-backdrop="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
					</div>
					<div class="modal-body">
						<div id="modalImg">
						
						</div>
					</div>
			</div>
		  </div>
		</div> </div>
         <footer id="footer">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-sm-10">
                        ZEBRA and the stylized Zebra head are trademarks of Zebra Technologies Corp., registered in many jurisdictions worldwide. All other trademarks are the property of their respective owners. ©2020 Zebra Technologies Corp. and/or its affiliates.<br><a href="https://www.zebra.com/us/en/about-zebra/company-information/legal.html">Legal</a> | <a href="https://www.zebra.com/us/en/about-zebra/company-information/legal/terms-of-use.html">Terms of Use</a> | <a href="https://www.zebra.com/us/en/about-zebra/company-information/legal/privacy-statement.html">Privacy Policy</a> 
                    </div>
                    <div class="col-sm-2">
                        <!--
                        <ul class="social-icons">
                            <li><a href="http://www.facebook.com/pages/Zebra-Technologies/107703715989073"><i class="fa fa-facebook"></i></a></li>
                            <li><a href="https://twitter.com/ZebraDevs"><i class="fa fa-twitter"></i></a></li>
                            <li><a href="http://www.youtube.com/zebratechnologies/"><i class="fa fa-youtube"></i></a></li>
                            <li><a href="https://www.linkedin.com/groups?home=&gid=3220074&trk=anet_ug_hm&goback=%2Egmr_3220074"><i class="fa fa-linkedin"></i></a></li>
                            <li><a href="https://github.com/developer-zebra"><i class="fa fa-github"></i></a></li>
                        </ul>
                        -->
                    </div>
                </div>
            </div>
        </footer><!--/#footer-->
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/owl.carousel.min.js"></script>
    <script src="/js/mousescroll.js"></script>
    <script src="/js/smoothscroll.js"></script>
    <script src="/js/jquery.prettyPhoto.js"></script>
    <script src="/js/jquery.isotope.min.js"></script>
    <script src="/js/jquery.inview.min.js"></script>
    <script src="/js/wow.min.js"></script>
    <script src="/js/bootstrap-treenav.min.js"></script>
    <script src="/js/prettify.js"></script>
    <script src="/js/zepto.js"></script>
    <script src="/js/jquery.waterfall.js"></script>   
    <script src="/js/main.js"></script>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','zRzEsAUhWTTkrdEN2YfA','2.0.0');
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-72584442-1', 'auto');
  ga('send', 'pageview');

</script> 

<!-- 3/1/19 - comment out per Rob
<script>
    ChatraID = 'QDvZ76min4DhLW5vJ';
    (function(d, w, c) {
        var n = d.getElementsByTagName('script')[0],
            s = d.createElement('script');
        w[c] = w[c] || function() {
            (w[c].q = w[c].q || []).push(arguments);
        };
        s.async = true;
        s.src = (d.location.protocol === 'https:' ? 'https:': 'http:')
            + '//call.chatra.io/chatra.js';
        n.parentNode.insertBefore(s, n);
    })(document, window, 'Chatra');
</script>         
-->


</body></html>