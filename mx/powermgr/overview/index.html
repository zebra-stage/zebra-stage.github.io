

        <p>The Power Manager (PowerMgr) allows an app to perform certain OS- and power-related actions on the device. These include rebooting or performing an OS update, resetting the device to a factory-fresh state or putting the device into Sleep mode. On some devices, such as the VC8x vehicle-mounted computer and similarly equipped Zebra devices, PowerMgr also can control device heaters and perform actions based on ignition status of the vehicle. PowerMgr performs only actions; it currently supports no queries other than to determine the version of the CSP that implements PowerMgr itself.</p>

<p><strong>It's important to note that PowerMgr actions such as Reboot and Reset, once executed, prevent the execution of subsequent actions submitted by the Request XML document</strong>, including the submission of a Result XML to the application sending the original Request. Zebra therefore recommends using <a href="/mx/conditionmgr">Condition Manager</a> in conjunction with PowerMgr to ensure that appropriate conditions exist on a device before attempting to perform "risky" operations such as OS updates, the failure of which can render a device unusable, severely limited or otherwise in need of service.</p>

<h3 id="mainfunctionality" class="anchor"><a class="heading-anchor" href="#mainfunctionality"><span></span></a>Main Functionality</h3>

<ul>
<li>Turn off device power</li>

<li>Protect Recovery Mode from actions that could change device behavior  </li>

<li>Reboot a device</li>

<li>Update, upgrade or downgrade the OS on a device</li>

<li>Suppress reboot following an OS upgrade or downgrade</li>

<li>Put a device into Sleep Mode</li>

<li>Perform an Enterprise Reset on a device</li>

<li>Bypass the Android Setup Wizard (GMS Welcome Screen)</li>

<li>Perform a Factory Reset on a device</li>

<li>Wipe a device (erase all storage) </li>

<li>Verify an OS update</li>

<li>Perform multiple updates in a single step</li>

<li>Upload/Download an OS Update from a streaming server</li>

<li>Set Authorization Type for Upgrade/Downgrade Streaming</li>

<li>Enter user name and password for server connections</li>

<li>Download a <code>.zip</code> file from a URL</li>

<li>Set Battery Saver Mode Automatic/Manual </li>

<li>Set battery charge percentage threshold to activate Battery Saver Mode</li>

<li>Enable/disable: 


<ul>
<li>Doze Mode</li>

<li>Battery Saver Mode</li>

<li>Wake-up methods (hardware or software)</li>

<li>Wake-up sources (device buttons)</li>

<li>Wake on touch of the device screen</li>

<li>Individual buttons to wake device  </li>

<li>Keyboard heater on VC8300 devices</li>

<li>Scanner-window heater on MC93 devices</li>

<li>Allocation of device storage as RAM (see RAM Optimization)</li></ul>
</li>

<li><strong>On the VC8x vehicle-mounted computer and similarly equipped Zebra devices</strong>: 


<ul>
<li>Turn power to specific serial and USB ports on and off</li>

<li>Control heaters for touch panel and battery, and on serial and USB ports</li>

<li>Set temperature thresholds (in degrees Celsius) for turning heaters on and off</li>

<li>Set the device to automatically turn on and/or off vehicle-mounted computers along with vehicle ignition switch</li>

<li>Set a delay (in minutes) for device auto-off</li></ul>
</li>
</ul>

<h3 id="sleepmode" class="anchor"><a class="heading-anchor" href="#sleepmode"><span></span></a>Sleep Mode</h3>

<p>On Android devices, Sleep mode turns off the device display screen and places some subsystems into low-power states. Depending on device configuration settings, certain apps and/or subsystems such as Wi-Fi and Cellular might remain active.</p>

<h3 id="reboot" class="anchor"><a class="heading-anchor" href="#reboot"><span></span></a>Reboot</h3>

<p>Rebooting an Android device generally causes only volatile information such as application state and transient data to be lost. Non-volatile data such as device settings and stored apps and data are preserved. A Reboot is sometimes referred to as a "Reset" or "Normal Reset," but is not to be confused with an Enterprise Reset or Factory Reset (explained below).</p>

<p><strong><u>IMPORTANT</u></strong>: The Reboot Action causes the device to immediately restart, which <strong>prevents any subsequent Actions from executing</strong>, including the submission of a Result XML to the application sending the original request. </p>

<h3 id="enterprisereset" class="anchor"><a class="heading-anchor" href="#enterprisereset"><span></span></a>Enterprise Reset</h3>

<p>Enterprise Reset is intended to return the device to an enterprise-defined default state, generally as determined by the contents of the <code>/enterprise</code> partition. On Zebra devices running Android, an Enterprise Reset is the same as a Factory Reset <em><u>except</u></em> that the <code>/enterprise</code> partition is preserved. <strong>This action is supported only on Zebra devices running Android 4.4 KitKat and later</strong>. On Zebra Android devices running Android Jelly Bean or earlier, the same action could be performed using the "OS Update" action if a suitable OS Update .zip file was used. </p>

<p><strong>Note: The Enterprise Reset Action causes the device to Reboot (into Recovery Mode), preventing any subsequent Actions from executing</strong>, including the submission of a Result XML to the application sending the original request. </p>

<p><strong><u>BEST PRACTICE</u></strong>: Enterprise Reset should be triggered <u>only</u> through Power Manager and <u>only</u> with the Setup Wizard Bypass flag set to "true." Manually triggering Enterprise Reset without setting the bypass flag could leave the device in an unexpected state.</p>

<h3 id="factoryreset" class="anchor"><a class="heading-anchor" href="#factoryreset"><span></span></a>Factory Reset</h3>

<p>The Factory Reset is intended to return the device to its factory-fresh condition with the exception of certain conditions related to its internal storage card(s) (see below). On Zebra devices running Android, a Factory Reset erases all key partitions and storage cards containing <code>/data</code>, <code>/cache</code>, and <code>/enterprise</code> partitions. <strong>This action is supported only on Zebra devices running Android 4.4 KitKat and later</strong>. On Zebra Android devices running Android Jelly Bean or earlier, the same action could be performed using the "OS Update" Action if a suitable OS Update .zip file was used.</p>

<blockquote>
  <p><i class="fa fa-exclamation-triangle" style="color:#FFA500;"></i> <strong>The Factory Reset Action causes the device to Reboot into Recovery Mode, which prevents any subsequent Actions from executing</strong>, including the submission of a Result XML to the application sending the original request. </p>
</blockquote>

<h4 id="resettingstoragecards" class="anchor"><a class="heading-anchor" href="#resettingstoragecards"><span></span></a>Resetting Storage Cards</h4>

<p>A Factory Reset <strong><u>will erase</u> a storage card if</strong>: </p>

<ul>
<li>The card was implemented within the <code>/data</code> or <code>/enterprise</code> partitions</li>
</ul>

<p>A Factory Reset <strong><u>will NOT erase</u> a storage card if</strong>: </p>

<ul>
<li>The card was implemented with its own dedicated partition</li>

<li>The card is physically removable</li>
</ul>

<h3 id="fulldevicewipe" class="anchor"><a class="heading-anchor" href="#fulldevicewipe"><span></span></a>Full Device Wipe</h3>

<p>The Full Device Wipe is intended to return the device to its condition as it would have shipped from the factory <strong>with its current OS <u>plus any subsequent OS update(s)</u></strong>. On Zebra Android devices, a Full Device Wipe is the same as a Factory Reset <strong>plus the unconditional erasure of all storage cards</strong>. <strong>This action is supported only on Zebra devices running Android 4.4 KitKat and later</strong>. On Zebra Android devices running Android Jelly Bean or lower, the same action could be performed using the "OS Update" Action if a suitable OS Update .zip file was used.</p>

<p><strong><u>Note</u></strong>: This Action causes the device to Reboot (into Recovery Mode), which <strong>prevents any subsequent Actions from executing</strong>, including the submission of a Result XML to the application sending the original request. </p>

<h3 id="osupdate" class="anchor"><a class="heading-anchor" href="#osupdate"><span></span></a>OS Update</h3>

<p>The OS Update allows the device operating system to be replaced or patched using a specified OS Update Zip File or a text file containing a list of OS updates and/or patches. Depending on the contents of the file(s), this process also can be used to perform an OS Downgrade (on devices some), Enterprise Reset, Factory Reset or Full Device Wipe to facilitate the installation of the update or patch contained in the file(s). </p>

<blockquote>
  <p><strong>Devices running Android 7.x Nougat and below</strong> support OS Update only.
  <strong>Devices with Android 8.x Oreo and later</strong> support Upgrade and Downgrade Actions and the Suppress Reboot parameter. </p>
</blockquote>

<h4 id="unotesu" class="anchor"><a class="heading-anchor" href="#unotesu"><span></span></a><u>NOTES</u>:</h4>

<ul>
<li><strong>The OS Update Action causes the device to Reboot (into Recovery Mode), <u>which prevents execution of any subsequent Actions</u></strong>, including the submission of a Result XML to the application sending the original request. </li>

<li><strong>OS Update can be used to upgrade or downgrade Android 7.x Nougat and older</strong>. </li>

<li><strong>On devices running Android 8.x Oreo or later</strong>, the OS Update Action can only <strong><u>upgrade</u></strong>. </li>
</ul>

<h3 id="osupgradedowngrade" class="anchor"><a class="heading-anchor" href="#osupgradedowngrade"><span></span></a>OS Upgrade/Downgrade</h3>

<h4 id="osupgradeandroid80only" class="anchor"><a class="heading-anchor" href="#osupgradeandroid80only"><span></span></a>OS Upgrade (Android 8.0+ only)</h4>

<p>Use the following basic steps to perform an OS Upgrade on devices running Android 8.x Oreo or later. Steps might vary slightly depending on the device(s), the environment or other factors. </p>

<p><strong>To perform an OS Upgrade</strong>:</p>

<ol>
<li>Create a StageNow Profile with PowerMgr settings.</li>

<li>Push upgrade <code>.zip</code> file to internal storage (<code>/storage/sdcard0</code>) of the unit under test (UUT).</li>

<li>Set PowerMgr ResetAction as "10" (OS Upgrade) to perform an update of the UUT. </li>

<li>Enter "file-details" characteristic with location of the <code>.zip</code> file in UUT (see sample XML below).</li>

<li>Optionally, set SuppressReboot as False (unchecked). <br>
This step is optional because the OS Update Action automatically triggers a device reboot.</li>

<li><strong>StageNow only</strong>: Generate a barcode that contains the Profile with these settings.</li>

<li><strong>StageNow only</strong>: Launch StageNow and scan the barcode.</li>

<li>Verify that the UUT starts an update process and reboots after a successful OS Update (and Enterprise Reset if security patch is different).</li>
</ol>

<h4 id="xmlforupgrade" class="anchor"><a class="heading-anchor" href="#xmlforupgrade"><span></span></a>XML for Upgrade</h4>

<pre class="prettyprint"><code>
&lt;wap-provisioningdoc&gt;
    &lt;characteristic type="PowerMgr" version="8.1" &gt;
            &lt;parm name="ResetAction" value="10"/&gt;
        &lt;characteristic type="file-details"&gt;
            &lt;parm name="ZipFile" value="/storage/sdcard0/name_of_upgrade_file.zip"/&gt; // &lt;-- upgrade .zip file
        &lt;/characteristic&gt;
            &lt;parm name="SuppressReboot" value="2"/&gt;
    &lt;/characteristic&gt;
&lt;/wap-provisioningdoc&gt;
</code></pre>

<h4 id="osdowngradeandroid80only" class="anchor"><a class="heading-anchor" href="#osdowngradeandroid80only"><span></span></a>OS Downgrade (Android 8.0+ only)</h4>

<p>Use the following basic steps to perform an <strong>OS Downgrade</strong> on devices running Android 8.x Oreo or later. Steps might vary slightly depending on the device(s), the environment or other factors. </p>

<blockquote>
  <p><strong>NOTE: Downgrades are supported ONLY when moving from one Android version to another</strong>. Downgrades within the same Android version (for example to move to an earlier patch level) are NOT supported using this function. </p>
</blockquote>

<p><strong>To perform an OS Downgrade</strong>:</p>

<ol>
<li><strong>StageNow only</strong>: Create a StageNow Profile with PowerMgr Settings.</li>

<li>Push downgrade <code>.zip</code> file to internal storage (<code>/storage/sdcard0</code>) of the UUT.</li>

<li>Set PowerMgr ResetAction as "11" (OS Downgrade) to perform a downgrade of the UUT. </li>

<li>Enter the "file-details" characteristic with the location of the <code>.zip</code> file in UUT (see sample XML below).</li>

<li><strong>StageNow only</strong>: Generate a barcode that contains the Profile with these settings.</li>

<li><strong>StageNow only</strong>: Launch StageNow and scan the barcode.</li>

<li>Verify that the UUT starts an update process and reboots after a successful OS Downgrade (and Enterprise Reset if security patch is different).</li>
</ol>

<h4 id="xmlfordowngrade" class="anchor"><a class="heading-anchor" href="#xmlfordowngrade"><span></span></a>XML for Downgrade</h4>

<pre class="prettyprint"><code>
&lt;wap-provisioningdoc&gt;
    &lt;characteristic type="PowerMgr" version="8.1" &gt;
            &lt;parm name="ResetAction" value="11"/&gt;
        &lt;characteristic type="file-details"&gt;
            &lt;parm name="ZipFile" value="/storage/sdcard0/name_of_downgrade_file.zip"/&gt; // &lt;-- downgrade .zip file
        &lt;/characteristic&gt;
    &lt;/characteristic&gt;
&lt;/wap-provisioningdoc&gt;
</code></pre>

<hr>


