
<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="-1">
    <meta http-equiv="CACHE-CONTROL" content="NO-CACHE">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Online Documentation for Zebra Technologies developer tools and utilties, including EMDK for Android, EMDK for Xamarin, StageNow and Enterprise Browser.">
    <meta name="author" content="Zebra Technologies">
    <meta name="google-site-verification" content="i4B78BrWnNy8ShJwe5feRW3jO3HE6gfYlYqYbxfl8yY">
    <meta name="msvalidate.01" content="6B651B00161BCE79B8950AC09D5C4C75">
    <meta title="Data Sharing">
    <title>Data Sharing - TechDocs</title>
    <!-- core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
<!--     
    <link href="/css/font-awesome.min.css" rel="stylesheet">
 -->    
    <link href="/css/all.css" rel="stylesheet">
    <link href="/css/v4-shims.css" rel="stylesheet">
    <link href="/css/animate.min.css" rel="stylesheet">
    <link href="/css/owl.carousel.css" rel="stylesheet">
    <link href="/css/owl.transitions.css" rel="stylesheet">
    <link href="/css/prettyPhoto.css" rel="stylesheet">
    <link href="/css/main.css" rel="stylesheet">
    <link href="/css/responsive.css" rel="stylesheet">
    <link href="/css/prettify.css" rel="stylesheet">
    <link href="/css/bootstrap-treenav.min.css" rel="stylesheet">
    <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
    <script src="js/respond.min.js"></script>
    <![endif]--> 

    <script src="//load.sumome.com/" data-sumo-site-id="699cb66cf4dc59352efb45705526d15cbe314e1cd43f7761b94d96f3cf7338e8" async="async"></script>
    <link rel="shortcut icon" href="/favicon.ico">
<script src="/js/jquery.js"></script></head><!--/head-->


<body id="home" class="homepage" data-spy="scroll" data-offset="100" data-target="#toc">

    <header id="header">
        <nav id="main-menu" class="navbar navbar-default navbar-fixed-top" role="banner">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/"><img src="/images/logo.png" alt="logo" style="max-height:66px;float: inherit;
    padding-right: 3px;"></a> 
                    
                   
                </div>
                <div class="collapse navbar-collapse navbar-left">
                    <ul class="nav navbar-nav">
                        <li class="navbar-text pull-left"><strong>TechDocs</strong></li>
                        <p class="navbar-text">
                                            Secure Storage Manager
                                            1.1
                        </p>

                    </ul>
                </div>
                <div class="collapse navbar-collapse navbar-right">
                    <ul class="nav navbar-nav">
                        


                        <li>
                            <a href="/ssm/1-1/guide/about">
                                    About
                            </a>
                        </li>
                        <li>
                            <a href="/ssm/1-1/guide/share-data">
                                    Data Sharing
                            </a>
                        </li>
                        <li>
                            <a href="/ssm/1-1/guide/share-files">
                                    File Sharing
                            </a>
                        </li>
                        <li>
                            <a href="/ssm/1-1/search">
                                    <i class="fa fa-search"></i>
                            </a>
                        </li>
                        
                        <!-- <li ><a href="/products">SDKs</a></li>
                        <li ><a href="/samples">Samples</a></li>
                        <li ><a href="/guides">Guides</a></li>
                        <li ><a href="/tutorials">Tutorials</a></li>
                        <li ><a href="/apis">APIs</a></li> -->
                        <!-- <li><a href="#"><input type="text" class="st-default-search-input"></a></li> -->
                    </ul>
                </div>
            </div><!--/.container-->
        </nav><!--/nav-->
    </header><!--/header-->
<div class="container-fluid">
    <section id="blog">
        <div class="">
            <section class="content-with-sidebar">
            <div class="row">
                <div class="col-sm-3 hidden-sm hidden-xs" id="sidebar">
                    
                    
                    <nav id="toc" data-toggle="toc" data-spy="affix" style="height: 75%; max-width: 225px; overflow-y: auto; ">
                        
                        <ul class="nav">
                            <li><strong>Data Sharing</strong></li>
                        </ul>
                    </nav>
                    <div class="modal fade" id="modal-smartdocs" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true" data-backdrop="true">
                    	<div class="modal-dialog">
                    		<div class="modal-content">
                    			<div class="modal-header">
                    				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
                    			</div>
                    			<div class="modal-body">
                    				<form>
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">MX Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="4.0">4.0</option>
                    					  <option value="4.1">4.1</option>
                    					  <option value="4.2">4.2</option>
                    					  <option value="4.3">4.3</option>
                    					  <option value="5.0">5.0</option>
                    					</select>
                    				  </div>						
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">OSX Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="1.0">1.0</option>
                    					  <option value="1.2">1.2</option>
                    					  <option value="1.3.4-56">1.3.4-56</option>
                    					  <option value="3.4">3.4</option>
                    					  <option value="3.5">3.5</option>
                    					  <option value="3.6">3.6</option>
                    					  <option value="4.1">4.1</option>
                    					  <option value="4.2">4.2</option>
                    					  <option value="4.3">4.3</option>
                    					  <option value="4.4">4.4</option>
                    					</select>
                    				  </div>						
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">Android Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="23">6.0 Marshmallow</option>
                    					  <option value="22">5.1 Lollipop</option>
                    					  <option value="21">5.0 Lollipop</option>
                    					  <option value="19">4.4 Kitkat</option>
                    					  <option value="18">4.3 Jellybean</option>
                    					  <option value="17">4.2.x Jellybean</option>
                    					  <option value="16">4.1.x Jellybean</option>
                    					  <option value="15">4.0.3-4.0.4 Ice Cream Sandwich</option>
                    					  <option value="14">4.0-4.0.2 Ice Cream Sandwich</option>
                    					  <option value="10">2.3.3-2.3.4 Gingerbread</option>
                    					</select>
                    				  </div>
                    				  <div class="form-group">
                    				  	<button class="primary" id="btn_SaveSmartDocOptions">Save Changes</button><button class="primary" id="btn_ClearSmartDocOptions">Clear Changes</button>
                    				  </div>
                    				</form>
                    			</div>
                    	</div>
                      </div>
                    </div>
                    
                    <script type="text/javascript">
                        $(document).ready(function() {
                        	$( "#btn_SaveSmartDocOptions" ).click(function() {
                      			console.log('Saving Options');
                      			$("#modal-smartdocs").modal({show: false});
                    		});
                        	$( "#btn_SaveSmartDocOptions" ).click(function() {
                      			console.log('Clearing Options');
                      			$("#modal-smartdocs").modal({show: false});
                    		});
                        });
                    </script><link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.3.0/dist/bootstrap-toc.min.css">
                    <script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.3.0/dist/bootstrap-toc.min.js"></script>
                    <script type="text/javascript">
                        $(document).ready(function() {
                    
                        });
                    
                    
                    </script>
                </div>                
                <div class="col-sm-9 ">
                    <div class="row">
                        <div class="col-sm-12">
                            <section id="cta" class="wow fadeIn">
                                <div class="">
                                    <h1 id="data-sharing" class="anchor"><a class="heading-anchor" href="#data-sharing"><span></span></a>Data Sharing</h1>
                                    <p>
                                            Secure Storage Manager
                                            1.1
                                    </p>
                                </div>
                            </section>                    
                        </div>
                    </div>
                    <div id="mainContent" class="row">
                        <div class="col-sm-12">
                            <div class="blog-post blog-large wow fadeInLeft" data-wow-duration="300ms" data-wow-delay="0ms">
                            <!-- Start of guide -->
                                <div class="service-box wow fadeInRight">
                                    <div class="">

                                        <p></p><h2 id="overview" class="anchor"><a class="heading-anchor" href="#overview"><span></span></a>Overview</h2>

<p><strong>Secure Storage Manager (SSM)</strong> securely stores data for access by authenticated apps based on the following scenarios:</p>

<ul>
<li><strong>Share data with target apps -</strong> an originating application sends data to SSM, which stores the data securely to be retrieved by an authenticated target application (e.g. app configuration, security keys, etc.).</li>

<li><strong>Persist data -</strong> Persisted data remains on the device after an enterprise reset for an authenticated target app to retrieve the data securely through SSM.</li>
</ul>

<!--
- **Share data among multi-user instances -** instances of an application running in different user profiles are required to share the same data among each app instance (e.g. application configurations).
  -->

<p>This guide explains how to use SSM to share and retrieve data for consumption by a target app. In summary, the steps to share data using SSM are:</p>

<ol>
<li>(Optional) <a href="#1preencryptdataoptional">Pre-Encrypt data</a> using Data Encryption Tool and send it to SSM to store.</li>

<li><a href="#2configuretargetapp">Configure the target app</a> to access the data in SSM.</li>

<li><a href="#3getappsignature">Get the App Signature</a> to authenticate the target app.</li>

<li><a href="#4usecontentproviderapis">Use Content Provider APIs</a> in the target app to query, insert, update or delete data in SSM.</li>
</ol>

<hr>

<h2 id="howitworks" class="anchor"><a class="heading-anchor" href="#howitworks"><span></span></a>How It Works</h2>

<p>The originating app (app supplying the data) sends data to SSM either in plain text or pre-encrypted format. The data is then internally encrypted by SSM before storing it into its database. If pre-encrypted data is received, SSM decrypts the data before performing internal encryption then storing the encrypted data into its database. The target app accesses data from SSM only after SSM ensures the authenticity of the app by validating its package name and signature (optional). When the target app retrieves the data, SSM delivers the data in the output format specified by the target app (encrypted or plain text).</p>

<p><img alt="image" src="SSM_DET.png"></p>

<p><em>Securely store and retrieve data using SSM with optional pre-encryption</em></p>

<p>SSM implements Android <a href="#4usecontentproviderapis">Content Provider</a> to securely share data and manage data access between apps with methods to create, retrieve, update and delete (CRUD) data. Data items are structured as name/value pairs. Each pair is uniquely identified by the originating app name and data-item name, which are available to the target app. Ownership of the data, including the ability to update or delete, starts with the originating app and transitions to the target app once the data is delivered. </p>

<hr>

<h2 id="1preencryptdataoptional" class="anchor"><a class="heading-anchor" href="#1preencryptdataoptional"><span></span></a>1. Pre-Encrypt Data (Optional)</h2>

<p>For added data security, the originating app can <em>optionally</em> pre-encrypt data with <a href="/det">Data Encryption Tool</a> before storing data in SSM. The secret key used for the encryption must also be encrypted.</p>

<p>Pre-encrypt data and encrypt the secret key:</p>

<ol>
<li><p>Create an AES secret key for the encryption:</p>

<pre class="prettyprint"><code>private SecretKey getRandomKey(String algorithmType)
{

<pre><code>SecureRandom rand = new SecureRandom();
KeyGenerator generator;
try {
    generator = KeyGenerator.getInstance(algorithmType);
    generator.init(128, rand);
    mSecretKey = generator.generateKey();
    Log.d(TAG, "mSecretKey = "+ mSecretKey);  // "mSecretKey" returns the secret key.
    return mSecretKey;
} catch (NoSuchAlgorithmException e) {
    e.printStackTrace();
}
return null;
</code></pre>

}
</code></pre></li>

<li><p>Encrypt the data with the secret key (from step 1) using <a href="/det">Data Encryption Tool</a>.</p></li>

<li><p>Encrypt the secret key (from step 1) with the SSM public key using <a href="/det">Data Encryption Tool</a>. SSM public key (Base64 String):</p>

<pre class="prettyprint"><code>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwE1qxpfNZVGq3wfPp3AqSeSpCPi3NUC1cCBuh5nkPvC3TfYHiozsy3gBYyUoYWIoAYlgypehqLIQfdHTrLpsVbS1BW6mnv76WvYwmaGrGfHzi50ETA8bFDwkrboG3jcHnvDJPH904BdU5eMrsq1o+BDmTmF/OAm1rJPohb8mukWh+o6OW6iNhO28IDRb26pKuTu6sckHn8I1I51bl44qaxq55A4wVR4mHEZL0EK/q2hY0Iqcak2dA8w8N0nJrWzbIbp5FeT/WyGO2pure7UxKEZfE5pkewPfcHSGp+0sbdCMaw6KrDpC5jusry4PjFw92sS/Huywv6/pv7WVPmwIDAQAB
</code></pre></li>
</ol>

The encrypted data and encrypted secret key are used when inserting or updating data to SSM when using the [Content Provider APIs](4usecontentproviderapis).
<!-- 
4.  Insert the encrypted secret key and encrypted data into the SSM database. Specify the data input (plain text or encrypted) and output (plain text or encrypted) format for the data:

        values.put("data_input_form”, "2"); // plaintext=1, encrypted=2
        values.put("data_output_form", "1"); // plaintext=1, encrypted=2
        values.put("data_input_encrypted_key","Encrypted Secret Key");
        values.put("data_value", inputData);
        Uri createdRow = getContentResolver().insert(cpUri, values);
-->

<h2 id="2configuretargetapp" class="anchor"><a class="heading-anchor" href="#2configuretargetapp"><span></span></a>2. Configure Target App</h2>

<p>The target app must be configured with the proper permissions and visibility to access the data in SSM. Insert the appropriate line(s) in the client app’s manifest file (based on Java/Kotlin):</p>

<ul>
<li><p><strong>Add permission to insert / update / delete data:</strong></p>

<pre class="prettyprint"><code>&lt;uses-permission android:name="com.zebra.securestoragemanager.securecontentprovider.PERMISSION.WRITE"/&gt;
</code></pre></li>

<li><p><strong>Add permission to query data:</strong></p>

<pre class="prettyprint"><code>&lt;uses-permission android:name="com.zebra.securestoragemanager.securecontentprovider.PERMISSION.READ"/&gt;
</code></pre></li>

<li><p><strong>Add query provider for apps targeting API Level 30 and above:</strong></p>

<pre class="prettyprint"><code>&lt;queries&gt;
    &lt;provider android:authorities="com.zebra.securestoragemanager.securecontentprovider"/&gt;
&lt;/queries&gt;
</code></pre></li>

<li><p><strong>Declare the authroity URI</strong> of the SSM Content Provider:</p>

<pre class="prettyprint"><code>private String AUTHORITY = "content://com.zebra.securestoragemanager.securecontentprovider/data";
</code></pre></li>
</ul>

<h2 id="3getappsignature" class="anchor"><a class="heading-anchor" href="#3getappsignature"><span></span></a>3. Get App Signature</h2>

<p>For data sharing, the target app signature is required to be passed to the SSM Content Provider to authenticate the target app.</p>

<p>To generate the app signature:</p>

<ol>
<li><p>Go to <a href="/sigtools/">Zebra App Signature Tool</a>. Follow instructions to download and use the tool.</p></li>

<li><p>Use the command below (adapt as needed) to save the target app signature (as Base64 format string) in "PackageName.txt":</p>

<pre class="prettyprint"><code>Java -jar SigTools.jar GetCert -INFORM APK -OUTFORM BASE64 -IN [Client.apk] -OUTFILE [PackageName.txt]
</code></pre>

<p>[Client.apk] represents the app to retrieve the app signature.</p></li>

<li><p>Rename "PackageName" in the .TXT file name to the target app package name, e.g. "com.zebra.exampleapp.txt".</p></li>

<li><p>Copy the renamed "PackageName.txt" file into the /assets directory on the device for SSM to access the target app signature.</p></li>
</ol>

<h2 id="4usecontentproviderapis" class="anchor"><a class="heading-anchor" href="#4usecontentproviderapis"><span></span></a>4. Use Content Provider APIs</h2>

<p>Use Android Content Provider APIs to insert (store), update, query or delete data in SSM.</p>

<table class="facelift" style="width:100%" border="1" padding="5px">
  <tbody><tr bgcolor="#dce8ef">
    <th>Action</th>
    <th>Method</th>
  </tr>

  <tr>
       <td>Add new data<br>See <a href="https://developer.android.com/reference/android/content/ContentProvider#insert(android.net.Uri,%20android.content.ContentValues)">Android reference</a></td>
    <td>Uri <b>insert</b> (Uri uri, ContentValues values)</td>
  </tr>

  <tr>
       <td>Modify/Update existing data<br>See <a href="https://developer.android.com/reference/android/content/ContentProvider#update(android.net.Uri,%20android.content.ContentValues,%20java.lang.String,%20java.lang.String[])">Android reference</a></td>
    <td>int <b>update</b> (Uri uri, ContentValues values, String selection, String[] selectionArgs)</td>
  </tr>

  <tr>
       <td>Return data based on selection criteria <br>See <a href="https://developer.android.com/reference/android/content/ContentProvider#query(android.net.Uri,%20java.lang.String[],%20java.lang.String,%20java.lang.String[],%20java.lang.String)">Android reference</a></td>
    <td>Cursor <b>query</b> (Uri uri, String[] projection, String selection, String[] selectionArgs, String sortOrder)</td>
  </tr>

  <tr>
       <td>Delete data <br>See <a href="https://developer.android.com/reference/android/content/ContentProvider#delete(android.net.Uri,%20android.os.Bundle)">Android reference</a></td>
    <td>int <b>delete</b> (Uri uri, String selection, String[] selectionArgs)</td>
  </tr>

</tbody></table>

<p><br>
Content Provider parameters:</p>

<table class="facelift" align="center" style="width:100%" border="1" padding="5px">
  <tbody><tr bgcolor="#dce8ef">
    <th style="width:15%">Key</th>
    <th style="width:15%">Value</th>
    <th style="width:55%">Description</th>
    <th style="width:15%">Mandatory/Optional</th>
  </tr>

  <tr>
    <td><b>target_app_package</b></td>
    <td>[string]</td>
    <td>The target app package name and signature (in Base64 format) are stored in json format. This applies to single or multiple target apps. To generate the target app signature, see <a href="#3getappsignature">Get App Signature</a>.</td>
    <td>Mandatory</td>
  </tr>

  <tr>
    <td><b>data_name</b></td>
    <td>[string]</td>
    <td>Unique name to identify data.<br><b>Note:</b> Data names cannot be duplicated in the same application when inserting data. If an app tries to insert a duplicate data name, it throws a Duplicate Data Name exception.</td>
    <td>Mandatory</td>
  </tr>

   <tr>
    <td><b>data_value</b></td>
    <td>[string or json]</td>
    <td>Data stored for app access.</td>
    <td>Mandatory</td>
  </tr>

  <tr>
    <td><b>data_persist_required</b></td>
    <td>true<br>false</td>
    <td>Set whether data can be retrieved after enterprise reset. Large data sets are not supported due to Android parcel size limitations - an exception is encountered if the query result data size is too large.</td>
    <td>Mandatory</td>
  </tr>

  <tr>
    <td><b>data_input_form</b></td>
    <td>1 = plain text<br>2 = encrypted </td>
    <td>Set whether data received from SSM is encrypted from Data Encryption Tool.</td>
    <td>Optional</td>
  </tr>

  <tr>
    <td><b>data_output_form</b></td>
    <td>1 = plain text<br>2 = encrypted</td>
    <td>Set whether data passed to the target app is encrypted.<br></td>
    <td>Optional</td>
  </tr>

</tbody></table>

<p><br></p>

<p><strong>Notes:</strong></p>

<ul>
<li>When <strong>persistent data is queried after a device reboot,</strong> a delay may occur in receiving the query results until the system is completely initialized.</li>

<li><strong>Querying persistent data could be slower than querying non-persistent data</strong>, since SSM stores persistent data in a device-persistent location.</li>

<li><strong>Apps can store data only up to 10 KB in a single record.</strong> If any single data record is larger than 10 KB, it must be split and stored as multiple records with unique data names.</li>
</ul>

<h3 id="insertdata" class="anchor"><a class="heading-anchor" href="#insertdata"><span></span></a>Insert Data</h3>

<p>Use insert() to add and store data securely in SSM. The procedure varies depending on whether the data is being inserted for single or multiple target apps. The sample code provided demonstrates how to insert data in plain text. Rather than plain text, data can be inserted in pre-encrypted form for added security, in which case the pre-encrypted data and encrypted secret key is passed to the method; see <a href="#1preencryptdataoptional">Step 1: Pre-encrypt data</a>. </p>

<h4 id="singleapp" class="anchor"><a class="heading-anchor" href="#singleapp"><span></span></a>Single App</h4>

<p>The sample code below inserts data for access by a single target app. If successful, the return value is the URI of the newly inserted row which contains the data. </p>

<pre class="prettyprint"><code>    private String AUTHORITY = "content://com.zebra.securestoragemanager.securecontentprovider/data";

    public void insertData() {
        Uri cpUri = Uri.parse(AUTHORITY);
        ContentValues values = new ContentValues();

        // Replace app signature value "ABSFFSDF… WREWED" with the package name signature (from step 3).
        values.put("target_app_package", "{\"pkgs_sigs\": [{\"pkg\":\"" + context.getPackageName() + "\",\"sig\":\"" + "ABSFFSDF… WREWED" + "\"}]}"); 

        values.put("data_name", "unique name to identify data");  // Replace with unique name identifier
        values.put("data_value", "any string data/json data");  // Replace with data to insert, in plain text or pre-encrypted (from step 1)
        values.put("data_input_form", "1");   // Set to 1 (plain text) or 2 (encrypted) based on whether data is pre-encrypted (from step 1)
        values.put("data_output_form", "1");  // Set to 1 (plain text) or 2 (encrypted)
        values.put("data_input_encrypted_key","Encrypted Secret Key"); // Replace with encrypted secret key if data is pre-encrypted (from step 1). Remove this line if data is not pre-encrypted.
        values.put("data_persist_required", "true");  // Set to true or false

        Uri createdRow = getContentResolver().insert(cpUri, values);

        Log.d(TAG, "Created row: " + createdRow.toString());
    }
</code></pre>

<h4 id="multipleapps" class="anchor"><a class="heading-anchor" href="#multipleapps"><span></span></a>Multiple Apps</h4>

<p>The sample code below inserts data for access by multiple target apps. The package name and signature of all target apps are stored in json format within the ContentValues object, which is then passed to the update() method. If successful, the return value is the URI of the newly inserted row which contains the data. </p>

<pre class="prettyprint"><code>    private String AUTHORITY = "content://com.zebra.securestoragemanager.securecontentprovider/data";

    public void insertDataMultipleApps() {

        Uri cpUri = Uri.parse(AUTHORITY);
        ContentValues values = new ContentValues();

        // For multiple target apps, each "com.ztestapp.clientapp" should be replaced with the app package name.
        // Replace each sig value (e.g. "24727AB4E6C4A0BE……27B3C") with the package name signature (from step 3).
        values.put("target_app_package", "{\"pkgs_sigs\":[
        {\"pkg\":\"" + com.ztestapp.clientapp1 + "\",\"sig\":\"24727AB4E6C4A0BE……27B3C\"},
        {\"pkg\":\"" + com.ztestapp.clientapp2 + "\",\"sig\":\"24727AB4E……872B27B3C\"},
        {\"pkg\":\"" + com.ztestapp.clientapp3 + "\",\"sig\":\"25677AB4E6C……72B27B3C\"}
        ]}")

        values.put("data_name", "unique name to identify data");  // Replace with unique name identifier
        values.put("data_value", "any string data/json data");   // Replace with data to insert, in plain text or pre-encrypted (from step 1)
        values.put("data_input_form", "1"); // Set to 1 (plain text) or 2 (encrypted) based on whether data is pre-encrypted (from step 1)
        values.put("data_output_form", "1"); // Set to 1 (plain text) or 2 (encrypted)
        values.put("data_input_encrypted_key","Encrypted Secret Key"); // Replace value with encrypted secret key if data is pre-encrypted (from step 1). Remove this line if data is not pre-encrypted.
        values.put("data_persist_required", "true"); // Set to true or false

        Uri createdRow = getContentResolver().insert(cpUri, values);

        Log.d(TAG, "Created row: " + createdRow.toString());
    }
</code></pre>

<h3 id="updatedata" class="anchor"><a class="heading-anchor" href="#updatedata"><span></span></a>Update Data</h3>

<p>Use update() to securely update existing data stored in SSM. The procedure varies depending on whether the data is updated for single or multiple target apps. The sample code demonstrates how to update data received in plain text. Rather than plain text, data can be inserted in pre-encrypted form for added security, in which case the pre-encrypted data and encrypted secret key is passed to the method; see <a href="#1preencryptdataoptional">Step 1: Pre-encrypt data</a>. If successful, the value returned is "1". </p>

<h4 id="singleapp-1" class="anchor"><a class="heading-anchor" href="#singleapp-1"><span></span></a>Single App</h4>

<p>The sample code below inserts data for access by a single target app.</p>

<pre class="prettyprint"><code>    private String AUTHORITY = "content://com.zebra.securestoragemanager.securecontentprovider/data";

    public void updateData() {

        Uri cpUri = Uri.parse(AUTHORITY);
        ContentValues values = new ContentValues();

        // Replace app signature value "ABSFFSDF… WREWED" with the package name signature (from step 3).
        values.put("target_app_package", "{\"pkgs_sigs\": [{\"pkg\":\"" + context.getPackageName() + "\",\"sig\":\"" + "ABSFFSDF… WREWED" + "\"}]}"); 

        values.put("data_name", "unique name to identify data");  // Replace with unique name identifier
        values.put("data_value", "any string data/json data");  // Replace with data to update, in plain text or pre-encrypted (from step 1)
        values.put("data_input_form", "1");   // Set to 1 (plain text) or 2 (encrypted) based on whether data is pre-encrypted (from step 1)
        values.put("data_output_form", "1");  // Set to 1 (plain text) or 2 (encrypted) based on whether data is pre-encrypted (from step 1)
        values.put("data_input_encrypted_key","Encrypted Secret Key"); // Replace value with encrypted secret key if data is pre-encrypted (from step 1). Remove this line if data is not pre-encrypted.
        values.put("data_persist_required", "true"); // Set to true or false

        int rowNumbers = getContentResolver().update(cpUri, values, null, null);
        Log.d(TAG, "Records updated: " + rowNumbers);
        if (rowNumbers &gt; 0) {
            Toast.makeText(mContext, "User info updated", Toast.LENGTH_SHORT).show();
            resultView.setText("Query Result");
        } else {
            Toast.makeText(mContext, "No records to update", Toast.LENGTH_SHORT).show();
        }
    }
</code></pre>

<h4 id="multipleapps-1" class="anchor"><a class="heading-anchor" href="#multipleapps-1"><span></span></a>Multiple Apps</h4>

<p>The sample code below updates data being accessed by multiple target apps. The package name and signature of each target app are stored in json format within the ContentValues object, which is then passed to the update() method. </p>

<pre class="prettyprint"><code>    private String AUTHORITY = "content://com.zebra.securestoragemanager.securecontentprovider/data";

    public void updateDataMultipleApps() {

        Uri cpUri = Uri.parse(AUTHORITY);
        ContentValues values = new ContentValues();

        // For multiple target apps, each "com.ztestapp.clientapp" should be replaced with the app package name.
        // Replace each sig value (e.g. "24727AB4E6C4A0BE……27B3C") with the package name signature.
        values.put("target_app_package", "{\"pkgs_sigs\":[
        {\"pkg\":\"" + com.ztestapp.clientapp1 + "\",\"sig\":\"24727AB4E6C4A0BE……27B3C\"},
        {\"pkg\":\"" + com.ztestapp.clientapp2 + "\",\"sig\":\"24727AB4E……872B27B3C\"},
        {\"pkg\":\"" + com.ztestapp.clientapp3 + "\",\"sig\":\"25677AB4E6C……72B27B3C\"}
        ]}")

        // Dummy sig is placed here. use SigTool to get this base64 String.

        values.put("data_name", "unique name to identify data"); // Replace with unique name identifier
        values.put("data_value", "any string data/json data");  // Replace with data to update
        values.put("data_input_form", "1"); // Set to 1 (plain text) or 2 (encrypted) based on whether data is encrypted with Data Encryption Tool
        values.put("data_output_form", "1"); // Set to 1 (plain text) or 2 (encrypted)
        values.put("data_input_encrypted_key","Encrypted Secret Key"); // Replace value with encrypted secret key if data is pre-encrypted. Remove this line if data is not pre-encrypted.
        values.put("data_persist_required", "true"); // Set to true or false

        int rowNumbers = getContentResolver().update(cpUri, values, null, null);
        Log.d(TAG, "Records updated: " + rowNumbers);
        if (rowNumbers &gt; 0) {
            Toast.makeText(mContext, "User info updated", Toast.LENGTH_SHORT).show();
            resultView.setText("Query Result");
        } else {
            Toast.makeText(mContext, "No records to update", Toast.LENGTH_SHORT).show();
        }
    }
</code></pre>

<h3 id="querydata" class="anchor"><a class="heading-anchor" href="#querydata"><span></span></a>Query Data</h3>

<p>To query data, data information is retrieved based on the target app package name. Call query() to return the cursor object which contains the data parameters (e.g. data_name, data_value, etc.) of the target app package. Traverse the cursor object to individually retrieve the data parameters. </p>

<p>Sample code to query data:</p>

<pre class="prettyprint"><code>    private String AUTHORITY = "content://com.zebra.securestoragemanager.securecontentprovider/data";

    public void queryData(){

        Uri cpUriQuery = Uri.parse(AUTHORITY + "/[" + context.getPackageName() + "]");

        String selection = "target_app_package" + " = '" + context.getPackageName() + "'" + " AND " + "data_persist_required" + " = '" + true + "'";

        Cursor cursor = null;

        try {
            cursor = getContentResolver().query(cpUriQuery, null, selection, null, null);
        } 
        catch (Exception e) {
            Log.d(TAG, "Error: " + e.getMessage());
        }
        // Then traverse the cursor object to retrieve the data fields.
    }
</code></pre>

<h3 id="deletedata" class="anchor"><a class="heading-anchor" href="#deletedata"><span></span></a>Delete Data</h3>

<p>delete() API removes the target app package name and all related data information from SSM. If successful, it returns "1". To delete the app package and its data fields:</p>

<pre class="prettyprint"><code>    private String AUTHORITY = "content://com.zebra.securestoragemanager.securecontentprovider/data";

    public void deleteData(){

        Uri cpUriDelete = Uri.parse(AUTHORITY + "/[" + context.getPackageName() + "]");

        String selection = "target_app_package" + " = '" + context.getPackageName() + "'" + " AND " + "data_persist_required" + " = '" + true + "'";

        int rowsDeleted = getContentResolver().delete(cpUriDelete, whereClause, null);

        if (rowsDeleted &gt; 0) {
            Toast.makeText(mContext, "User Info Deleted", Toast.LENGTH_SHORT).show();
        } 
        else {
            Toast.makeText(mContext, "No User Info to be deleted", Toast.LENGTH_SHORT).show();
        }
    }
</code></pre>

<hr>

<h2 id="sampleapp" class="anchor"><a class="heading-anchor" href="#sampleapp"><span></span></a>Sample App</h2>

<p>See <a href="../samples/share-data/">Data Sharing</a> sample app.</p>

<hr>

<h2 id="seealso" class="anchor"><a class="heading-anchor" href="#seealso"><span></span></a>See Also</h2>

<ul>
<li><a href="../about/">About SSM</a></li>

<li><a href="../share-files">File Sharing</a></li>
</ul><p></p>
                                        


                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div><!--/.col-sm-6-->
            </div>
            </section>
        </div>
    </section>    

<div class="modal fade" id="basicModal" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true" data-backdrop="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
					</div>
					<div class="modal-body">
						<div id="modalImg">
						
						</div>
					</div>
			</div>
		  </div>
		</div> </div>
         <footer id="footer">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-sm-10">
                        ZEBRA and the stylized Zebra head are trademarks of Zebra Technologies Corp., registered in many jurisdictions worldwide. All other trademarks are the property of their respective owners. ©2022 Zebra Technologies Corp. and/or its affiliates.<br> <a href="https://www.zebra.com/us/en/about-zebra/company-information/legal.html">Legal</a> | <a href="https://www.zebra.com/us/en/about-zebra/company-information/compliance/information-privacy/terms-of-use.html">Terms of Use</a> | <a href="https://www.zebra.com/us/en/about-zebra/company-information/legal/privacy-statement.html">Privacy Policy</a> 
                    </div>
                     <!--
                     <div class="col-sm-2">
                        <ul class="social-icons">
                            <li><a href="http://www.facebook.com/pages/Zebra-Technologies/107703715989073"><i class="fa fa-facebook"></i></a></li>
                            <li><a href="https://twitter.com/ZebraDevs"><i class="fa fa-twitter"></i></a></li>
                            <li><a href="http://www.youtube.com/zebratechnologies/"><i class="fa fa-youtube"></i></a></li>
                            <li><a href="https://www.linkedin.com/groups?home=&gid=3220074&trk=anet_ug_hm&goback=%2Egmr_3220074"><i class="fa fa-linkedin"></i></a></li>
                            <li><a href="https://github.com/developer-zebra"><i class="fa fa-github"></i></a></li>
                        </ul>
                    </div> -->
                 </div>
            </div>
        </footer>
    
    <!--/#footer 
        10/25/18 removed <footer id="footer" class="navbar-fixed-bottom">
    -->
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/owl.carousel.min.js"></script>
    <script src="/js/mousescroll.js"></script>
    <script src="/js/smoothscroll.js"></script>
    <script src="/js/jquery.prettyPhoto.js"></script>
    <script src="/js/jquery.isotope.min.js"></script>
    <script src="/js/jquery.inview.min.js"></script>
    <script src="/js/wow.min.js"></script>
    <script src="/js/bootstrap-treenav.min.js"></script>
    <script src="/js/prettify.js"></script>
    <script src="/js/zepto.js"></script>
    <script src="/js/jquery.waterfall.js"></script>   
    <script src="/js/main.js"></script>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','zRzEsAUhWTTkrdEN2YfA','2.0.0');
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-72584442-1', 'auto');
  ga('send', 'pageview');

</script> 

<script>
    ChatraID = 'QDvZ76min4DhLW5vJ';
    (function(d, w, c) {
        var n = d.getElementsByTagName('script')[0],
            s = d.createElement('script');
        w[c] = w[c] || function() {
            (w[c].q = w[c].q || []).push(arguments);
        };
        s.async = true;
        s.src = (d.location.protocol === 'https:' ? 'https:': 'http:')
            + '//call.chatra.io/chatra.js';
        n.parentNode.insertBefore(s, n);
    })(document, window, 'Chatra');
</script>         


</body></html>