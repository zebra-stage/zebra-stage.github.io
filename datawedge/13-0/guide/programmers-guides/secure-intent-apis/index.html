
<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="-1">
    <meta http-equiv="CACHE-CONTROL" content="NO-CACHE">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Online Documentation for Zebra Technologies developer tools and utiltiescomp including EMDK for Android, EMDK for Xamarin, StageNow, Enterprise Browser.">
    <meta name="author" content="Zebra Technologies">
    <meta name="google-site-verification" content="i4B78BrWnNy8ShJwe5feRW3jO3HE6gfYlYqYbxfl8yY">
    <meta name="msvalidate.01" content="6B651B00161BCE79B8950AC09D5C4C75">
    <meta title="Control Access to DataWedge Intent APIs">
    <title>Control Access to DataWedge Intent APIs - Zebra Technologies TechDocs</title>
    <!-- core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    <link href="/css/animate.min.css" rel="stylesheet">
    <link href="/css/owl.carousel.css" rel="stylesheet">
    <link href="/css/owl.transitions.css" rel="stylesheet">
    <link href="/css/prettyPhoto.css" rel="stylesheet">
    <link href="/css/main.css?version=3.2" rel="stylesheet">
    <link href="/css/responsive.css" rel="stylesheet">
    <link href="/css/prettify.css" rel="stylesheet">
    <link href="/css/bootstrap-treenav.min.css" rel="stylesheet">
    <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
    <script src="js/respond.min.js"></script>
    <![endif]--> 

    <!-- 3/1/19 - comment out per Rob  
    <script src="//load.sumome.com/" data-sumo-site-id="699cb66cf4dc59352efb45705526d15cbe314e1cd43f7761b94d96f3cf7338e8" async="async"></script>
    -->
    <link rel="shortcut icon" href="/favicon.ico">
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-01QJCMQM9N"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-01QJCMQM9N');
</script><script src="/js/jquery.js"></script></head><!--/head-->

<!-- Google tag -->





<body id="home" class="homepage" data-spy="scroll" data-offset="100" data-target="#toc">

    <header id="header">
        <nav id="main-menu" class="navbar navbar-default navbar-fixed-top" role="banner">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/"><img src="/images/logo.png" alt="logo" style="max-height:66px;float: inherit;
    padding-right: 3px;"></a> 
                    
                   
                </div>
                <div class="collapse navbar-collapse navbar-left">
                    <ul class="nav navbar-nav">
                        <li class="navbar-text pull-left"><strong><a href="/">TechDocs Home</a></strong></li>
                        <p class="navbar-text">
                                            DataWedge
                                            13.0
                        </p>

                    </ul>
                </div>
                <div class="collapse navbar-collapse navbar-right">
                    <ul class="nav navbar-nav">
                        


                        <li>
                            <a href="/datawedge/13-0/guide/about">
                                    About
                            </a>
                        </li>
                        <li>
                            <a href="/datawedge/13-0/guide/gettingstarted">
                                    Get Started
                            </a>
                        </li>
                        <li>
                            <a href="/datawedge/13-0/guide/profiles">
                                    Profiles
                            </a>
                        </li>
                        <li>
                            <a href="/datawedge/13-0/guide/programmers-guides">
                                    Guides
                            </a>
                        </li>
                        <li>
                            <a href="/datawedge/13-0/guide/matrix">
                                    Feature Matrix
                            </a>
                        </li>
                        <li>
                            <a href="/datawedge/13-0/guide/api">
                                    APIs
                            </a>
                        </li>
                        <li>
                            <a href="/datawedge/13-0/guide/samples">
                                    Samples
                            </a>
                        </li>
                        <li>
                            <a href="/datawedge/13-0/guide/faq">
                                    FAQ
                            </a>
                        </li>
                        <li>
                            <a href="https://supportcommunity.zebra.com/s/global-search/datawedge?language=en_US">
                                    <i class="fa fa-graduation-cap"></i>
                            </a>
                        </li>
                        <li>
                            <a href="/datawedge/13-0/search">
                                    <i class="fa fa-search"></i>
                            </a>
                        </li>
                        <li class="dropdown languagedropdown">
                          <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown"> <img src="/images/flags/img-flag-usa.png" style="display:inline!important;" alt=""> US - English
                          <span class="caret"></span></button>
                          <ul class="dropdown-menu">
                                <li><a onclick="changeLanguage('datawedge','datawedge/dw-cn')"><img src="/images/flags/img-flag-china.png" style="display:inline!important;" alt="CN - 普通话"> CN - 普通话</a></li>
                                <li><a onclick="changeLanguage('datawedge','datawedge/dw-jp')"><img src="/images/flags/img-flag-japan.png" style="display:inline!important;" alt="JP - 日本語"> JP - 日本語</a></li>
                          </ul>
                        </li>                    
                        <!-- <li ><a href="/products">SDKs</a></li>
                        <li ><a href="/samples">Samples</a></li>
                        <li ><a href="/guides">Guides</a></li>
                        <li ><a href="/tutorials">Tutorials</a></li>
                        <li ><a href="/apis">APIs</a></li> -->
                        <!-- <li><a href="#"><input type="text" class="st-default-search-input"></a></li> -->
                    </ul>
                </div>
            </div><!--/.container-->
        </nav><!--/nav-->
    </header><!--/header-->
<div class="container-fluid">
    <section id="blog">
        <div class="">
            <section class="content-with-sidebar">
            <div class="row">
                <div class="col-sm-3 hidden-sm hidden-xs" id="sidebar">
                    
                    
                    <nav id="toc" data-toggle="toc" data-spy="affix" style="height: 75%; max-width: 225px; overflow-y: auto; ">
                        
                        <ul class="nav">
                            <li><strong>Control Access to DataWedge Intent APIs</strong></li>
                        </ul>
                    </nav>
                    <div class="modal fade" id="modal-smartdocs" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true" data-backdrop="true">
                    	<div class="modal-dialog">
                    		<div class="modal-content">
                    			<div class="modal-header">
                    				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
                    			</div>
                    			<div class="modal-body">
                    				<form>
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">MX Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="4.0">4.0</option>
                    					  <option value="4.1">4.1</option>
                    					  <option value="4.2">4.2</option>
                    					  <option value="4.3">4.3</option>
                    					  <option value="5.0">5.0</option>
                    					</select>
                    				  </div>						
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">OSX Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="1.0">1.0</option>
                    					  <option value="1.2">1.2</option>
                    					  <option value="1.3.4-56">1.3.4-56</option>
                    					  <option value="3.4">3.4</option>
                    					  <option value="3.5">3.5</option>
                    					  <option value="3.6">3.6</option>
                    					  <option value="4.1">4.1</option>
                    					  <option value="4.2">4.2</option>
                    					  <option value="4.3">4.3</option>
                    					  <option value="4.4">4.4</option>
                    					</select>
                    				  </div>						
                    				  <div class="form-group">
                    				    <label for="exampleInputEmail1">Android Version On Device:</label>
                    				    <select class="form-control">
                    					  <option value="23">6.0 Marshmallow</option>
                    					  <option value="22">5.1 Lollipop</option>
                    					  <option value="21">5.0 Lollipop</option>
                    					  <option value="19">4.4 Kitkat</option>
                    					  <option value="18">4.3 Jellybean</option>
                    					  <option value="17">4.2.x Jellybean</option>
                    					  <option value="16">4.1.x Jellybean</option>
                    					  <option value="15">4.0.3-4.0.4 Ice Cream Sandwich</option>
                    					  <option value="14">4.0-4.0.2 Ice Cream Sandwich</option>
                    					  <option value="10">2.3.3-2.3.4 Gingerbread</option>
                    					</select>
                    				  </div>
                    				  <div class="form-group">
                    				  	<button class="primary" id="btn_SaveSmartDocOptions">Save Changes</button><button class="primary" id="btn_ClearSmartDocOptions">Clear Changes</button>
                    				  </div>
                    				</form>
                    			</div>
                    	</div>
                      </div>
                    </div>
                    
                    <script type="text/javascript">
                        $(document).ready(function() {
                        	$( "#btn_SaveSmartDocOptions" ).click(function() {
                      			console.log('Saving Options');
                      			$("#modal-smartdocs").modal({show: false});
                    		});
                        	$( "#btn_SaveSmartDocOptions" ).click(function() {
                      			console.log('Clearing Options');
                      			$("#modal-smartdocs").modal({show: false});
                    		});
                        });
                    </script><link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.3.0/dist/bootstrap-toc.min.css">
                    <script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.3.0/dist/bootstrap-toc.min.js"></script>
                    <script type="text/javascript">
                        $(document).ready(function() {
                    
                        });
                    
                    
                    </script>
                </div>                
                <div class="col-sm-9 ">
                    <div class="row">
                        <div class="col-sm-12">
                            <section id="cta" class="wow fadeIn">
                                <div class="">
                                    <h1 id="control-access-to-datawedge-intent-apis" class="anchor"><a class="heading-anchor" href="#control-access-to-datawedge-intent-apis"><span></span></a>Control Access to DataWedge Intent APIs</h1>
                                    <p>
                                            DataWedge
                                            13.0
                                    </p>
                                </div>
                            </section>                    
                        </div>
                    </div>
                    <div id="mainContent" class="row">
                        <div class="col-sm-12">
                            <div class="blog-post blog-large wow fadeInLeft" data-wow-duration="300ms" data-wow-delay="0ms">
                            <!-- Start of guide -->
                                <div class="service-box wow fadeInRight">
                                    <div class="">

                                        <p></p><h2 id="overview" class="anchor"><a class="heading-anchor" href="#overview"><span></span></a>Overview</h2>

<p>DataWedge provides an option for admins to control access to DataWedge intent APIs, allowing only approved apps to configure DataWedge. DataWedge intent APIs are categorized, allowing the administrator to grant DataWedge API access to specific apps based on category. By default, DataWedge accepts any intent API to avoid impact to existing applications.</p>

<p>Previously, any application on the device could configure DataWedge parameters and receive information such as configurations and status notifications via DataWedge APIs. This led to a potential security risk where a malicious application can configure DataWedge profiles used by other applications and leverage it for its own advantage, for example a malicious app could modify the destination URI of IP Output plugin to divert data delivery to a different address.</p>

<blockquote>
  <p>MX version 10.1.1 or above is required on the device.</p>
</blockquote>

<p>Video demonstration about securing access to DataWedge intent APIs:</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/y7smCqmYB7E" frameborder="0" allow="accelerometer; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<h2 id="controlaccess" class="anchor"><a class="heading-anchor" href="#controlaccess"><span></span></a>Control Access</h2>

<p>Process to control access to DataWedge intent APIs:</p>

<ol>
<li>Whitelist approved app using <a href="/mx/accessmgr">AccessMgr CSP</a> from MX.</li>

<li>Specify the intent API category to restrict intent API access via <a href="/mx/datawedgemgr">DataWedgeMgr CSP</a> from MX.</li>

<li>Acquire the app token from AccessMgr using EMDK.</li>

<li>Access the API by including the token in the DataWedge intent.</li>
</ol>

<p>Details are provided in the sections that follow.</p>

<h3 id="1whitelistapprovedapp" class="anchor"><a class="heading-anchor" href="#1whitelistapprovedapp"><span></span></a>1. Whitelist Approved App</h3>

<h4 id="fordatawedge113andlater" class="anchor"><a class="heading-anchor" href="#fordatawedge113andlater"><span></span></a>For DataWedge 11.3 and later:</h4>

<p>The first step to control access to DataWedge Intent APIs is for the admin to whitelist the app using <a href="/mx/accessmgr">AccessMgr CSP</a> from <a href="/flux/about">Zebra Device Manager (ZDM)</a>. Whitelisting allows only the apps specified on a list to run, restricting use of apps not on the approved whitelist. Use <a href="/stagenow">StageNow</a> to deploy the configuration to whitelist the app. Set the following parameters:</p>

<ul>
<li><strong>Operation Mode:</strong> "Single User without Whitelist"</li>

<li><strong>Service Access Action</strong>: "Allow Caller to Call Service"</li>

<li><strong>Service Identifier</strong>: &lt;delegation scope of the API category&gt;</li>

<li><strong>Specify Caller Package Name</strong>: &lt;enter app package name, e.g.: com.company.appname&gt;</li>

<li><strong>Caller Signature</strong>: &lt;select signature file that contains the app certificate&gt;</li>
</ul>

<p>Delegation scopes for each intent API category:</p>

<table class="facelift" style="width:70%" border="1" padding="5px">
  <tbody><tr bgcolor="#dce8ef">
    <th>Intent API Category</th>
    <th>Delegation Scope</th>
  </tr>

  <tr>
    <td>Query APIs</td>
    <td>delegation_scope_datawedge_query_api</td>
  </tr>

  <tr>
    <td>Runtime APIs</td>
    <td>delegation_scope_datawedge_control_api</td>
  </tr>

  <tr>
    <td>Notification APIs</td>
    <td>delegation_scope_datawedge_notification_api</td>
  </tr>
  <tr>
    <td>Configuration APIs</td>
    <td>delegation_scope_datawedge_config_api</td>
  </tr>
</tbody></table>

<h4 id="fordatawedge112andearlier" class="anchor"><a class="heading-anchor" href="#fordatawedge112andearlier"><span></span></a>For DataWedge 11.2 and earlier:</h4>

<p>The first step to control access to DataWedge Intent APIs is for the admin to whitelist the app using <a href="/mx/accessmgr">AccessMgr CSP</a> from MX. Whitelisting allows only the apps specified on a list to run, restricting use of apps not on the approved whitelist. Use <a href="/stagenow">StageNow</a> or EMDK Profile Manager (<a href="/emdk-for-android/latest/guide/profile-manager-guides/">Android</a> or <a href="/emdk-for-xamarin/latest/guide/profile-manager-guides/">Xamarin</a>) to deploy the configuration to whitelist the app. Set the following parameters:</p>

<ul>
<li><strong>Operation Mode:</strong> "Single User without Whitelist"</li>

<li><strong>Service Access Action</strong>: "Allow Caller to Call Service"</li>

<li><strong>Service Identifier</strong>: com.symbol.datawedge.api</li>

<li><strong>Specify Caller Package Name</strong>: &lt;enter app package name, e.g.: com.company.appname&gt;</li>

<li><strong>Caller Signature</strong>: &lt;select signature file that contains the app certificate&gt;</li>
</ul>

<h3 id="2restrictdatawedgeintentapis" class="anchor"><a class="heading-anchor" href="#2restrictdatawedgeintentapis"><span></span></a>2. Restrict DataWedge Intent APIs</h3>

<p>By default, all DataWedge APIs are in uncontrolled mode - any application can access all DataWedge APIs. An admin can place a DataWedge API category into controlled/uncontrolled mode using DataWedgeMgr CSP via StageNow to restrict access to a particular API category. Refer to <strong>Control Access to Intent APIs</strong> in <a href="/mx/datawedgemgr">DataWedgeMgr CSP</a>.<br>
<strong>Note:</strong> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>•</b>&nbsp; For DataWedge 8.1, DataWedge 8.1.61 or higher is required. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>•</b>&nbsp; For DataWedge 8.2, DataWedge 8.2.62 or higher is required.</p>

<table class="facelift" style="width:70%" border="1" padding="5px">
  <tbody><tr bgcolor="#dce8ef">
    <th>Intent API Category</th>
    <th>Control Modes</th>
  </tr>

  <tr>
    <td>Configuration APIs</td>
    <td>Uncontrolled<br>Controlled</td>
  </tr>

  <tr>
    <td>Notification APIs</td>
    <td>Uncontrolled<br>Controlled</td>
  </tr>

  <tr>
    <td>Query APIs</td>
    <td>Uncontrolled<br>Controlled</td>
  </tr>
  <tr>
    <td>Runtime APIs</td>
    <td>Uncontrolled<br>Controlled</td>
  </tr>
</tbody></table>

<p><strong>Uncontrolled –</strong> All apps have access to APIs; this the default setting.<br>
<strong>Controlled –</strong> This restricts API access. Only the admin can whitelist apps to access the APIs using AccessMgr CSP.</p>

<p><a href="../../api">DataWedge APIs</a> are categorized into 4 types:</p>

<ul>
<li><strong>Configuration APIs -</strong> APIs related to actions taken on configurations</li>

<li><strong>Notification APIs -</strong> APIs related to retrieving status for scanner, profile, or configuration</li>

<li><strong>Query API -</strong> APIs that retrieve information or enumerate scanners</li>

<li><strong>Runtime APIs -</strong> APIs that can change functionality at runtime</li>
</ul>

<p>Administrators can designate which categories are protected using <a href="/mx/datawedgemgr">DataWedgeMgr CSP</a>. By default, all the API categories are in unprotected mode.</p>

<table class="facelift" style="width:70%" border="1" padding="5px">
  <tbody><tr bgcolor="#dce8ef">
    <th>Intent API category</th>
    <th>Intent APIs</th>
  </tr>

  <tr>
    <td>Configuration APIs</td>
    <td>Get Config<br>Get Disabled App List<br>Clone Profile<br>Create Profile<br>Delete Profile<br>Rename Profile<br>Set Config<br>Set Ignore Disabled Profiles<br>Set Disabled App list<br>Restore Config<br>Import Config
    </td>
  </tr>

  <tr>
    <td>Notification APIs</td>
    <td>Profile Switching (from Register/Unregister for Notification)<br>Scanner Status (from Register/Unregister for Notification)<br>Configuration Change (from Register/Unregister for Notification)</td>
  </tr>

  <tr>
    <td>Query API</td>
    <td>Enumerate Scanners<br>Get Active Profile<br>Get DataWedge Status<br>Get Version Info<br>Get Scanner Status<br>Get Profiles List<br>Get Ignore Disabled Profiles</td>
  </tr>

  <tr>
    <td>Runtime APIs</td>
    <td>Enable/Disable DataWedge<br>Enable/Disable Scanner Input Plug-in<br>Switch Scanner Params<br>Switch SimulScan Params<br>Soft Scan Trigger<br>Soft RFID Trigger<br>Switch to Profile<br>Set Default Profile<br>Reset Default Profile<br>Switch Scanner<br>Set Reporting Options</td>
  </tr>
</tbody></table>

<p>See <a href="../../api">DataWedge APIs</a>.</p>

<h3 id="3acquireatoken" class="anchor"><a class="heading-anchor" href="#3acquireatoken"><span></span></a>3. Acquire a Token</h3>

<h4 id="fordatawedge113andlater-1" class="anchor"><a class="heading-anchor" href="#fordatawedge113andlater-1"><span></span></a>For DataWedge 11.3 and later:</h4>

<p>Only whitelisted applications are allowed to call DataWedge service identifier/delegation scopes to generate tokens. The applications must use ZDM Content Provider to generate a token by passing the required delegation.</p>

<p>To generate a token:</p>

<ol>
<li><p>Add the following to the Android manifest:</p>

<ul>
<li><p>ZDM read permission:</p>

<pre class="prettyprint"><code>&lt;uses-permission android:name="com.zebra.devicemanager.provider.READ_PERMISSION"/&gt;
</code></pre></li>

<li><p>Queries permission:</p>

<pre class="prettyprint"><code>&lt;queries&gt;
    &lt;package android:name="com.zebra.devicemanager"/&gt;
&lt;/queries&gt;
</code></pre></li></ul></li>

<li><p>Access the ZDM content provider. Sample code:</p>

<pre class="prettyprint"><code>static final Uri AUTHORITY_URI = Uri.parse("content://com.zebra.devicemanager.zdmcontentprovider");
Uri ACQUIRE_TOKEN_URI = Uri.withAppendedPath(AUTHORITY_URI, "AcquireToken");

public static final String COLUMN_QUERY_RESULT = "query_result";

public String acquireToken(String delegation_scope) {
    String token = "";
    try {
        Cursor cursor = mContext.getContentResolver().query(ACQUIRE_TOKEN_URI, (String[])null,
                "delegation_scope=?", new String[]{delegation_scope}, (String)null);
        if (cursor != null &amp;&amp; cursor.getCount() &gt; 0) {
            cursor.moveToFirst();
            token = cursor.getString(cursor.getColumnIndex(COLUMN_QUERY_RESULT));
            cursor.close();
        }
    } catch (Exception var3) {
        if (var3 instanceof SecurityException) {
            Log.e("BroadcastProtection", "Invalid Token/Caller");
        } else {
            Log.e("BroadcastProtection", "Unknown Caller to acquire token");
        }
    }

<pre><code>return token;
</code></pre>

}
</code></pre></li>
</ol>

<h4 id="fordatawedge112andearlier-1" class="anchor"><a class="heading-anchor" href="#fordatawedge112andearlier-1"><span></span></a>For DataWedge 11.2 and earlier:</h4>

<p>Only whitelisted applications are allowed to call DataWedge service identifier to generate tokens.
The applications must use EMDK ProfileManager APIs to acquire a token from AccessMgr CSP.</p>

<p>To generate a token, use EMDK Profile Manager to create a profile:</p>

<ol>
<li>Open EMDK Profile Manager (<a href="/emdk-for-android/latest/guide/profile-manager-guides/">Android</a> or <a href="/emdk-for-xamarin/latest/guide/profile-manager-guides/">Xamarin</a>).</li>

<li>Create a new profile using MX 10.1 or above and provide a name, such as RequestToken.</li>

<li>In the “Available Features” list, select and add “Access Manager” as a feature.</li>

<li>Access Manager is listed under “Selected Features”.</li>

<li>In the Access Manager parameters section, set/enter the following:


<ul>
<li><strong>Service Access Action</strong>: “Request Token”</li>

<li><strong>Service Identfier</strong>: com.symbol.datawedge.api</li></ul>
</li>
</ol>

<p>Sample generated EMDKConfig.xml from EMDK Profile Manager:</p>

<pre class="prettyprint"><code>    &lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;!--This is an auto generated document. Changes to this document may cause incorrect behavior.--&gt;&lt;wap-provisioningdoc&gt;
    &lt;characteristic type="ProfileInfo"&gt;
        &lt;parm name="created_wizard_version" value="7.3.2"/&gt;
    &lt;/characteristic&gt;
    &lt;characteristic type="Profile"&gt;
        &lt;parm name="ProfileName" value="RequestToken"/&gt;
        &lt;parm name="ModifiedDate" value="2020-03-23 20:01:24"/&gt;
        &lt;parm name="TargetSystemVersion" value="9.1"/&gt;
        &lt;characteristic type="AccessMgr" version="8.3"&gt;
        &lt;parm name="emdk_name" value=""/&gt;
        &lt;parm name="ServiceAccessAction" value="7"/&gt;
        &lt;parm name="ServiceIdentifier" value="com.symbol.datawedge.api"/&gt;
        &lt;/characteristic&gt;
    &lt;/characteristic&gt;
    &lt;/wap-provisioningdoc&gt;
</code></pre>

<p>Use <a href="/emdk-for-android/latest/api/reference/com/symbol/emdk/ProfileManager">ProcessProfile API</a> from EMDK to generate the token to be passed to the desired DataWedge API intent for secure access. Sample code to generate the token:</p>

<pre class="prettyprint"><code>    import android.content.Context;
    import android.os.AsyncTask;
    import android.text.TextUtils;
    import android.util.Xml;

    import com.symbol.emdk.EMDKManager;
    import com.symbol.emdk.EMDKResults;
    import com.symbol.emdk.ProfileManager;

    import org.xmlpull.v1.XmlPullParser;
    import org.xmlpull.v1.XmlPullParserException;

    import java.io.StringReader;

    public class TokenOperations implements EMDKManager.EMDKListener {

        static Object syncObj = new Object();
        Context mContext;
        // Provides the error type for characteristic-error
        private String errorType = "";
        // Provides the parm name for parm-error
        private String parmName = "";
        // Provides error description
        private String errorDescription = "";
        // Provides error string with type/name + description
        private String errorString = "";
        private String mToken = "";
        //Assign the profile name used in EMDKConfig.xml
        private String profileName = "";
        //Declare a variable to store ProfileManager object
        private ProfileManager profileManager = null;
        //Declare a variable to store EMDKManager object
        private EMDKManager emdkManager = null;


        public TokenOperations(Context context)
        {
            this.mContext = context;
        }

        public String getErrorDescription()
        {
            return errorDescription;
        }

        public String generateToken()
        {
            EMDKResults results = EMDKManager.getEMDKManager(mContext, this);

            //Check the return status of EMDKManager object creation.
            if(results.statusCode == EMDKResults.STATUS_CODE.SUCCESS) {
                //EMDKManager object creation success
            }else {
                //EMDKManager object creation failed
            }


            try {
                synchronized (syncObj) {
                    syncObj.wait();
                }
            } catch (InterruptedException e) {
                e.printStackTrace();
            }

            if (emdkManager != null) {
                emdkManager.release();
                emdkManager = null;
            }

            return mToken;

        }

        @Override
        public void onOpened(EMDKManager emdkManager) {

            this.emdkManager = emdkManager;
            //Get the ProfileManager object to process the profiles
            profileManager = (ProfileManager) emdkManager.getInstance(EMDKManager.FEATURE_TYPE.PROFILE);
            profileName = "RequestToken";
            new ProcessProfileTask().execute("");
        }

        @Override
        public void onClosed() {

            //This callback will be issued when the EMDK closes unexpectedly.
            if (emdkManager != null) {
                emdkManager.release();
                emdkManager = null;
            }
        }

        private void parseXML(XmlPullParser myParser) {
            int event;
            try {
                // Retrieve error details if parm-error/characteristic-error in the response XML
                event = myParser.getEventType();
                while (event != XmlPullParser.END_DOCUMENT) {
                    String name = myParser.getName();
                    switch (event) {
                        case XmlPullParser.START_TAG:
                            if (name.equals("parm-error")) {
                                parmName = myParser.getAttributeValue(null, "name");
                                errorDescription = myParser.getAttributeValue(null, "desc");
                                errorString = " (Name: " + parmName + ", Error Description: " + errorDescription + ")";
                                return;
                            }
                            else if (name.equals("parm")) {
                                String parmName = myParser.getAttributeValue(null, "name");
                                if(parmName.equalsIgnoreCase("ServiceAccessToken"))
                                {
                                    //Retrieved Token will be saved to a variable
                                    mToken = myParser.getAttributeValue(null, "value");

                                    return;
                                }

                            }
                            break;
                        case XmlPullParser.END_TAG:

                            break;
                    }
                    event = myParser.next();
                }

            } catch (Exception e) {
                e.printStackTrace();
            }
        }

        private class ProcessProfileTask extends AsyncTask&lt;String, Void, EMDKResults&gt; {

            @Override
            protected EMDKResults doInBackground(String... params) {

                parmName = "";
                errorDescription = "";
                errorType = "";
                mToken = "";

                EMDKResults resultsReset = profileManager.processProfile(profileName, ProfileManager.PROFILE_FLAG.RESET, params);
                EMDKResults results = profileManager.processProfile(profileName, ProfileManager.PROFILE_FLAG.SET, params);

                return results;
            }

            @Override
            protected void onPostExecute(EMDKResults results) {

                super.onPostExecute(results);

                String resultString = "";

                //Check the return status of processProfile
                if(results.statusCode == EMDKResults.STATUS_CODE.CHECK_XML) {

                    // Get XML response as a String
                    String statusXMLResponse = results.getStatusString();

                    try {
                        // Create instance of XML Pull Parser to parse the response
                        XmlPullParser parser = Xml.newPullParser();
                        // Provide the string response to the String Reader that reads
                        // for the parser
                        parser.setInput(new StringReader(statusXMLResponse));
                        // Call method to parse the response
                        parseXML(parser);

                        if (TextUtils.isEmpty(parmName) &amp;&amp; TextUtils.isEmpty(errorType) &amp;&amp; TextUtils.isEmpty(errorDescription) ) {

                            resultString = "Profile update success.";
                            if(!TextUtils.isEmpty(mToken))
                            {
                                resultString = "";
                            }
                        }
                        else {

                            resultString = "Profile update failed." + errorString;
                        }

                        synchronized (syncObj) {
                            syncObj.notify();
                        }

                    } catch (XmlPullParserException e) {
                        resultString =  e.getMessage();
                    }
                }
            }
        }
    }
</code></pre>

<h3 id="4accessingtheapis" class="anchor"><a class="heading-anchor" href="#4accessingtheapis"><span></span></a>4. Accessing the APIs</h3>

<p>Once the token is generated, it needs to be included in the intent API call along with the calling application’s package name being sent to DataWedge. When the intent is received by DataWedge, DataWedge verifies if the token is valid for the given application. If the token is valid, DataWedge processes the intent. If the token is not valid, one of the following error codes occur:</p>

<ul>
<li>Main error code: <code>APPLICATION_NOT_AUTHORIZED</code></li>

<li>Sub error codes:


<ul>
<li><code>TOKEN_EXPIRED</code>: The token is expired; applications are required to acquire a new token.</li>

<li><code>MX_NOT_INITIALIZED</code>: MX is not initialized. This can usually occur right after a reboot.</li>

<li><code>FAILED_TO_VERIFY_APPLICATION</code>: Unable to verify the calling application (i.e token is invalid or application is not whitelisted).</li></ul>
</li>
</ul>

<p>Source code samples are provided for multiple APIs:</p>

<h4 id="example1getconfig" class="anchor"><a class="heading-anchor" href="#example1getconfig"><span></span></a>Example 1: Get Config</h4>

<pre class="prettyprint"><code>    Intent i = new Intent();
    i.setAction("com.symbol.datawedge.api.ACTION");
    i.setPackage("com.symbol.datawedge");
    i.putExtra("APPLICATION_PACKAGE", getPackageName());
    i.putExtra("TOKEN", "291f7f7c-1479-4813-9639-2d4ab31e37b9");
    i.putExtra("com.symbol.datawedge.api.GET_CONFIG", "Profile0 (default)");
    this.sendBroadcast(i);
</code></pre>

<h4 id="example2enabledisabledatawedge" class="anchor"><a class="heading-anchor" href="#example2enabledisabledatawedge"><span></span></a>Example 2: Enable/Disable DataWedge</h4>

<pre class="prettyprint"><code>    Intent i = new Intent();
    i.setAction("com.symbol.datawedge.api.ACTION");
    i.setPackage("com.symbol.datawedge");
    i.putExtra("APPLICATION_PACKAGE", getPackageName());
    i.putExtra("TOKEN", "&lt;token here&gt;"););
    i.putExtra("SEND_RESULT","LAST_RESULT");
    i.putExtra("com.symbol.datawedge.api.ENABLE_DATAWEDGE", true);
    sendBroadcast(i);
</code></pre>

<h4 id="example3setconfig" class="anchor"><a class="heading-anchor" href="#example3setconfig"><span></span></a>Example 3: Set Config</h4>

<pre class="prettyprint"><code>    Bundle bMain = new Bundle();
    bMain.putString("PROFILE_NAME", "Profile009");
    bMain.putString("PROFILE_ENABLED", "true");
    bMain.putString("CONFIG_MODE", "CREATE_IF_NOT_EXIST");

    Bundle bConfig = new Bundle();
    bConfig.putString("PLUGIN_NAME","BARCODE");
    bConfig.putString("RESET_CONFIG","true");


    Bundle paramList = new Bundle();
    paramList.putString("scanner_selection","auto");
    paramList.putString("decoder_code11", "true");

    bConfig.putBundle("PARAM_LIST", paramList);

    bMain.putBundle("PLUGIN_CONFIG", bConfig);

    Intent i = new Intent();
    i.setAction("com.symbol.datawedge.api.ACTION");
    i.setPackage("com.symbol.datawedge");
    i.putExtra("APPLICATION_PACKAGE", getPackageName());
    i.putExtra("TOKEN", "&lt;token here&gt;"););
    i.putExtra("com.symbol.datawedge.api.SET_CONFIG", bMain);
    i.putExtra("SEND_RESULT","LAST_RESULT");
    i.putExtra("COMMAND_IDENTIFIER", "SET_CONFIG");
    this.sendBroadcast(i);
</code></pre>

<h2 id="usagenotes" class="anchor"><a class="heading-anchor" href="#usagenotes"><span></span></a>Usage Notes</h2>

<ul>
<li>When DataWedge APIs are set as "Controlled" and when the device restarts, sending an intent API to the "Controlled" group from a whitelisted application may return an error. Since MX framework did not complete initialization, allow some time to elapse after reboot before sending the intent to avoid this error.</li>

<li>The token expires in the following situations:


<ul>
<li>Device date or time is set prior to the timestamp on the token.</li>

<li>24 Hours passed in the device clock after generating the token.</li>

<li>Automatic time updates caused the device time to go backward or move forward more than 24 hours.</li></ul>
</li>

<li>If intent APIs are placed in protected mode, existing Zebra apps that use DataWedge may not work as expected. E.g. If Runtime APIs are placed in protected mode, the scan button of the Enterprise Keyboard does not work on Enterprise Keyboard versions 4.0 or lower.</li>

<li>For DataWedge 11.3 and later:


<ul>
<li>When devices are using both MX and ZDM, ZDM becomes the preferred option.</li>

<li>If ZDM is present in the device, tokens acquired using MX via EMDK Profile Manager cannot be used.</li></ul>
</li>
</ul>

<hr>

<p>Related Guides:</p>

<ul>
<li><a href="../../api">DataWedge APIs</a></li>

<li><a href="/emdk-for-android/8-0/guide/profile-manager-guides">EMDK ProfileManager</a></li>

<li><a href="/mx/accessmgr">AccessMgr CSP</a></li>

<li><a href="/mx/datawedgemgr">DataWedgeMgr CSP</a></li>

<li><a href="../../gettingstarted">DataWedge Get Started guide</a></li>
</ul><p></p>
                                        


                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div><!--/.col-sm-6-->
            </div>
            </section>
        </div>
    </section>    

<div class="modal fade" id="basicModal" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true" data-backdrop="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
					</div>
					<div class="modal-body">
						<div id="modalImg">
						
						</div>
					</div>
			</div>
		  </div>
		</div> </div>
         <footer id="footer">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-sm-10">
                        ZEBRA and the stylized Zebra head are trademarks of Zebra Technologies Corp., registered in many jurisdictions worldwide. All other trademarks are the property of their respective owners. ©2023 Zebra Technologies Corp. and/or its affiliates.<br><a href="https://www.zebra.com/us/en/about-zebra/company-information/legal.html">Legal</a> | <a href="https://www.zebra.com/us/en/about-zebra/company-information/legal/terms-of-use.html">Terms of Use</a> | <a href="https://www.zebra.com/us/en/about-zebra/company-information/legal/privacy-statement.html">Privacy Policy</a> 
                    </div>
                    <div class="col-sm-2">
                        <!--
                        <ul class="social-icons">
                            <li><a href="http://www.facebook.com/pages/Zebra-Technologies/107703715989073"><i class="fa fa-facebook"></i></a></li>
                            <li><a href="https://twitter.com/ZebraDevs"><i class="fa fa-twitter"></i></a></li>
                            <li><a href="http://www.youtube.com/zebratechnologies/"><i class="fa fa-youtube"></i></a></li>
                            <li><a href="https://www.linkedin.com/groups?home=&gid=3220074&trk=anet_ug_hm&goback=%2Egmr_3220074"><i class="fa fa-linkedin"></i></a></li>
                            <li><a href="https://github.com/developer-zebra"><i class="fa fa-github"></i></a></li>
                        </ul>
                        -->
                    </div>
                </div>
            </div>
        </footer><!--/#footer-->
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/owl.carousel.min.js"></script>
    <script src="/js/mousescroll.js"></script>
    <script src="/js/smoothscroll.js"></script>
    <script src="/js/jquery.prettyPhoto.js"></script>
    <script src="/js/jquery.isotope.min.js"></script>
    <script src="/js/jquery.inview.min.js"></script>
    <script src="/js/wow.min.js"></script>
    <script src="/js/bootstrap-treenav.min.js"></script>
    <script src="/js/prettify.js"></script>
    <script src="/js/zepto.js"></script>
    <script src="/js/jquery.waterfall.js"></script>   
    <script src="/js/main.js"></script>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','zRzEsAUhWTTkrdEN2YfA','2.0.0');
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-72584442-1', 'auto');
  ga('send', 'pageview');

</script> 

<!-- 3/1/19 - comment out per Rob
<script>
    ChatraID = 'QDvZ76min4DhLW5vJ';
    (function(d, w, c) {
        var n = d.getElementsByTagName('script')[0],
            s = d.createElement('script');
        w[c] = w[c] || function() {
            (w[c].q = w[c].q || []).push(arguments);
        };
        s.async = true;
        s.src = (d.location.protocol === 'https:' ? 'https:': 'http:')
            + '//call.chatra.io/chatra.js';
        n.parentNode.insertBefore(s, n);
    })(document, window, 'Chatra');
</script>   
-->      



</body></html>